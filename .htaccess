# Evita conflictos con content negotiation
Options -MultiViews
Options +FollowSymLinks

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # 1) Proxy HTTPS (Railway): marca la request como HTTPS internamente
  # para que PHP/Apache consideren secure cookies/URLs.
  RewriteCond %{HTTP:X-Forwarded-Proto} =https
  RewriteRule .* - [E=HTTPS:on]

  # 2) Quita trailing slash solo si NO es directorio real
  #    y no tiene extensi√≥n (para no tocar /css/app.css/)
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} .+/$
  RewriteCond %{REQUEST_URI} !\.[^./]+/$
  RewriteRule ^(.+?)/$ /$1 [R=301,L,QSA]

  # 3) Si existe un .html con ese nombre, servirlo
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}.html -f
  RewriteRule ^(.+)$ $1.html [L,QSA]

  # 4) Si existe un .php con ese nombre, servirlo
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}.php -f
  RewriteRule ^(.+)$ $1.php [L,QSA]
</IfModule>

# Opcional: define index por si tu panel es index.php
DirectoryIndex index.php index.html
