<?php
define('FPDF_FONTPATH','fpdf/font/');
define('EURO',chr(128));
require 'pdf_js.php';

############## VARIABLE PARA TAMAÑO DE LOGO ##############
$GLOBALS['logo1_vertical_X'] = 6;
$GLOBALS['logo1_vertical_Y'] = 4;
$GLOBALS['logo1_vertical'] = 40;

$GLOBALS['logo2_vertical_X'] = 2;
$GLOBALS['logo2_vertical_Y'] = 4;
$GLOBALS['logo2_vertical'] = 22;

$GLOBALS['logo1_horizontal_X'] = 40;
$GLOBALS['logo1_horizontal_Y'] = 2;
$GLOBALS['logo1_horizontal'] = 60;

$GLOBALS['logo2_horizontal_X'] = 10;
$GLOBALS['logo2_horizontal_Y'] = 2;
$GLOBALS['logo2_horizontal'] = 26;

$GLOBALS['logo1_letter_X'] = 18;
$GLOBALS['logo1_letter_Y'] = 2;
$GLOBALS['logo1_letter'] = 56;

$GLOBALS['logo2_letter_X'] = 20;
$GLOBALS['logo2_letter_Y'] = 2;
$GLOBALS['logo2_letter'] = 24;
############## VARIABLE PARA TAMAÑO DE LOGO ##############
 
//class PDF extends FPDF{ 
class PDF extends PDF_JavaScript
{
var $widths;
var $aligns;
var $flowingBlockAttr;
//$Tamhoriz = 88;


########################## FUNCION PARA MOSTRAR EL FOOTER ########################
//Pie de página
function Footer()
{
  if(!in_array(decrypt($_GET['tipo']), ['TICKETCIERRE', 'TICKETMOVIMIENTO', 'TICKETCOTIZACION', 'GENERAL', 'COMANDA', 'BAR', 'REPOSTERIA', 'PRECUENTA', 'TICKETDELIVERY', 'TICKET', 'BOLETA', 'FACTURA', 'TICKETCREDITO', 'NOTACREDITO'])){
  //Posición: a 2 cm del final
  $this->Ln();
  $this->SetY(-12);
  $this->SetFont('Courier','B',10);
  //Número de página
  $this->Cell(190,5,'SOFT RESTAURANT (Administración, Compras y ventas)','T',0,'L');
  $this->AliasNbPages();
  $this->Cell(0,5,'Pagina '.$this->PageNo(),'T',1,'R');

    if($this->page>0){
        // Page footer
        $this->_endpage();
    }
  }
} 
######################## FUNCION PARA MOSTRAR EL FOOTER ########################

######################## FUNCION PARA CARGAR AUTOPRINTF ########################
function AutoPrint($printer='')
{
    // Open the print dialog
    if($printer)
    {
        $printer = str_replace('\\', '\\\\', $printer);
        $script = "var pp = getPrintParams();";
        $script .= "pp.interactive = pp.constants.interactionLevel.full;";
        $script .= "pp.printerName = '$printer'";
        $script .= "print(pp);";
    }
    else
        $script = 'print(true);';
    $this->IncludeJS($script);
}
######################## FUNCION PARA CARGAR AUTOPRINT ########################




############################### REPORTES DE ADMINISTRACION ##############################

########################## FUNCION LISTAR CIUDADES ##############################
function TablaListarCiudades()
{
    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE CIUDADES',0,0,'C');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(80,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(100,8,'NOMBRE DE CIUDAD',1,1,'C', True);
    
    $tra = new Login();
    $reg = $tra->ListarCiudades();

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,80,100));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codciudad"]),portales(utf8_decode($reg[$i]["ciudad"]))));
       }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CIUDADES ##############################

########################## FUNCION LISTAR COMUNAS ##############################
function TablaListarComunas()
{
    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE COMUNAS',0,0,'C');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(80,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(100,8,'NOMBRE DE COMUNA',1,1,'C', True);
    
    $tra = new Login();
    $reg = $tra->ListarComunas();

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,80,100));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codcomuna"]),portales(utf8_decode($reg[$i]["comuna"]))));
      }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMUNAS ##############################

########################## FUNCION LISTAR TIPOS DE DOCUMENTOS ##########################
function TablaListarDocumentos()
{
    $tra = new Login();
    $reg = $tra->ListarDocumentos();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE DOCUMENTOS TRIBUTARIOS',0,0,'C');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(50,8,'NOMBRE DE DOCUMENTO',1,0,'C', True);
    $this->Cell(125,8,'DESCRIPCIÓN DE DOCUMENTO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,50,125));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["documento"]),utf8_decode($reg[$i]["descripcion"])));
        }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR TIPOS DE DOCUMENTOS ##########################

########################## FUNCION LISTAR TIPOS DE MONEDA ##############################
function TablaListarTiposMonedas()
{
    $tra = new Login();
    $reg = $tra->ListarTipoMoneda();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE TIPOS DE MONEDA',0,0,'C');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(85,8,'NOMBRE DE MONEDA',1,0,'C', True);
    $this->Cell(45,8,'SIGLAS',1,0,'C', True);
    $this->Cell(45,8,'SIMBOLO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,85,45,45));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["moneda"]),utf8_decode($reg[$i]["siglas"]),$tipo = ($reg[$i]["moneda"] == "EURO" ? chr(128) : $reg[$i]["simbolo"])));
        }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR TIPOS DE MONEDA ##############################

########################## FUNCION LISTAR TIPOS DE CAMBIO ##############################
function TablaListarTiposCambio()
{
    $tra = new Login();
    $reg = $tra->ListarTipoCambio();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE TIPOS DE CAMBIO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){
        $this->Ln();
        $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
        $this->Ln();
        $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
        $this->Ln();
        $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 
    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE CAMBIO',1,0,'C', True);
    $this->Cell(35,8,'MONTO DE CAMBIO',1,0,'C', True);
    $this->Cell(35,8,'TIPO DE MONEDA',1,0,'C', True);
    $this->Cell(35,8,'FECHA DE INGRESO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,70,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["descripcioncambio"]),utf8_decode($reg[$i]["montocambio"]),utf8_decode($reg[$i]['moneda']."/".$reg[$i]['siglas']),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechacambio'])))));
       }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR TIPOS DE CAMBIO ##############################

########################## FUNCION LISTAR IMPUESTOS ##############################
function TablaListarImpuestos()
{
    $tra = new Login();
    $reg = $tra->ListarImpuestos();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE IMPUESTOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(50,8,'NOMBRE DE IMPUESTO',1,0,'C', True);
    $this->Cell(35,8,'VALOR(%)',1,0,'C', True);
    $this->Cell(35,8,'ESTADO',1,0,'C', True);
    $this->Cell(35,8,'FECHA DE INGRESO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,50,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codimpuesto"]),utf8_decode($reg[$i]["nomimpuesto"]),utf8_decode(number_format($reg[$i]["valorimpuesto"], 0, '.', '.')),utf8_decode($status = ($reg[$i]['statusimpuesto'] == 1 ? "ACTIVO" : "INACTIVO")),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaimpuesto'])))));
        }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR IMPUESTOS ##############################

########################## FUNCION LISTAR SUCURSALES ##############################
function TablaListarSucursales()
{
    ################################# MEMBRETE LEGAL #################################
    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE SUCURSALES',0,0,'C');
    
    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE REGISTRO',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE SUCURSAL',1,0,'C', True);
    $this->Cell(25,8,'CIUDAD',1,0,'C', True);
    $this->Cell(30,8,'COMUNA',1,0,'C', True);
    $this->Cell(55,8,'DIRECCIÓN',1,0,'C', True);
    $this->Cell(35,8,'CORREO ELECT',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TELÉFONO',1,0,'C', True);
    $this->Cell(45,8,'ENCARGADO',1,1,'C', True);
    
    $tra = new Login();
    $reg = $tra->ListarSucursales();

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,35,60,25,30,55,35,35,45));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["cuitsucursal"]),portales(utf8_decode($reg[$i]["nomsucursal"])),portales(utf8_decode($reg[$i]['id_ciudad'] == '0' ? "********" : $reg[$i]['ciudad'])),portales(utf8_decode($reg[$i]['id_comuna'] == '0' ? "********" : $reg[$i]['comuna'])),portales(utf8_decode($reg[$i]["direcsucursal"])),portales(utf8_decode($reg[$i]["correosucursal"])),utf8_decode($reg[$i]["tlfsucursal"]),portales(utf8_decode($reg[$i]["nomencargado"]))));
  }
   }


    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR SUCURSALES ##############################

########################## FUNCION LISTAR CATEGORIAS ##############################
function TablaListarCategorias()
{ 
    $tra = new Login();
    $reg = $tra->ListarCategorias();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE CATEGORIAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(155,8,'NOMBRE DE CATEGORIA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,155));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codcategoria"]),utf8_decode($reg[$i]["nomcategoria"])));
       }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CATEGORIAS ##############################

########################## FUNCION LISTAR MEDIDAS ##############################
function TablaListarMedidas()
{
    $tra = new Login();
    $reg = $tra->ListarMedidas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE MEDIDAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(155,8,'NOMBRE DE MEDIDA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,155));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codmedida"]),utf8_decode($reg[$i]["nommedida"])));
       }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR MEDIDAS ##############################

########################## FUNCION LISTAR SALSAS ##############################
function TablaListarSalsas()
{
    $tra = new Login();
    $reg = $tra->ListarSalsas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE SALSAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(155,8,'NOMBRE DE SALSA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,155));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codsalsa"]),utf8_decode($reg[$i]["nomsalsa"])));
       }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR SALSAS ##############################

########################## FUNCION LISTAR SALAS ##############################
function TablaListarSalas()
{
    $tra = new Login();
    $reg = $tra->ListarSalas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE SALAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(155,8,'NOMBRE DE SALA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,155));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codsala"]),utf8_decode($reg[$i]["nomsala"])));
        }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR SALAS ##############################

########################## FUNCION LISTAR MESAS ##############################
function TablaListarMesas()
{
    $tra = new Login();
    $reg = $tra->ListarMesas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE MESAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE SALA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE MESA',1,0,'C', True);
    $this->Cell(40,8,'Nº DE PERSONAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,20,60,60,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codmesa"]),utf8_decode($reg[$i]["nomsala"]),utf8_decode($reg[$i]["nommesa"]),utf8_decode($reg[$i]["puestos"])));
      }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR MESAS ##############################
     
########################## FUNCION LISTAR USUARIOS ##############################
function TablaListarUsuarios()
{
    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE USUARIOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(40,8,'SUCURSAL',1,0,'C', True);
    $this->Cell(30,8,'Nº DOCUMENTO',1,0,'C', True);
    $this->Cell(60,8,'NOMBRES Y APELLIDOS',1,0,'C', True);
    $this->Cell(25,8,'SEXO',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TELÉFONO',1,0,'C', True);
    $this->Cell(50,8,'EMAIL',1,0,'C', True);
    $this->Cell(40,8,'USUARIO',1,0,'C', True);
    $this->Cell(40,8,'NIVEL',1,1,'C', True);

    $tra = new Login();
    $reg = $tra->ListarUsuarios();

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,40,30,60,25,35,50,40,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        portales(utf8_decode($sucursal = ($reg[$i]["codsucursal"] == "" ? "**********" : $reg[$i]["cuitsucursal"].": ".$reg[$i]["nomsucursal"]))),
        utf8_decode($reg[$i]["dni"]),
        utf8_decode($reg[$i]["nombres"]),
        utf8_decode($reg[$i]["sexo"]),
        utf8_decode($reg[$i]["telefono"]),
        utf8_decode($reg[$i]["email"]),
        utf8_decode($reg[$i]["usuario"]),
        utf8_decode($reg[$i]["nivel"])));
        }
    }

    } else {

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DOCUMENTO',1,0,'C', True);
    $this->Cell(80,8,'NOMBRES Y APELLIDOS',1,0,'C', True);
    $this->Cell(25,8,'SEXO',1,0,'C', True);
    $this->Cell(45,8,'Nº DE TELÉFONO',1,0,'C', True);
    $this->Cell(60,8,'EMAIL',1,0,'C', True);
    $this->Cell(40,8,'USUARIO',1,0,'C', True);
    $this->Cell(40,8,'NIVEL',1,1,'C', True);

    $tra = new Login();
    $reg = $tra->ListarUsuarios();

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,30,80,25,45,60,40,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["dni"]),utf8_decode($reg[$i]["nombres"]),utf8_decode($reg[$i]["sexo"]),utf8_decode($reg[$i]["telefono"]),utf8_decode($reg[$i]["email"]),utf8_decode($reg[$i]["usuario"]),utf8_decode($reg[$i]["nivel"])));
            }
        }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR USUARIOS ##############################

########################## FUNCION LISTAR LOGS DE USUARIOS ##############################
function TablaListarLogs()
{
    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE LOGS DE ACCESO DE USUARIOS',0,0,'C');
    
    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(10,8,'N°',1,0,'C', True);
    $this->Cell(35,8,'IP EQUIPO',1,0,'C', True);
    $this->Cell(45,8,'TIEMPO ENTRADA',1,0,'C', True);
    $this->Cell(145,8,'NAVEGADOR DE ACCESO',1,0,'C', True);
    $this->Cell(60,8,'PÁGINAS DE ACCESO',1,0,'C', True);
    $this->Cell(35,8,'USUARIO',1,1,'C', True);
    

    $tra = new Login();
    $reg = $tra->ListarLogs();

    if($reg==""){
    echo "";      
    } else {
    
    /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,35,45,145,60,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["ip"]),utf8_decode($reg[$i]["tiempo"]),utf8_decode($reg[$i]["detalles"]),utf8_decode($reg[$i]["paginas"]),utf8_decode($reg[$i]["usuario"])));
        }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR LOGS DE USUARIOS ##############################

############################ REPORTES DE ADMINISTRACION #############################



























############################### REPORTES DE PERSONAL ##############################

########################## FUNCION LISTAR CLIENTES ##############################
function TablaListarClientes()
{
    $tra = new Login();
    $reg = $tra->ListarClientes();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE CLIENTES',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){
        $this->Ln();
        $this->Cell(260,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
        $this->Ln();
        $this->Cell(260,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
        $this->Ln();
        $this->Cell(260,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 
    }
    
    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'TIPO',1,0,'C', True);
    $this->Cell(35,8,'Nº DE DOCUMENTO',1,0,'C', True);
    $this->Cell(60,8,'NOMBRES/RAZÓN SOCIAL',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TELEFONO',1,0,'C', True);
    $this->Cell(75,8,'DIRECCIÓN DOMICILIARIA',1,0,'C', True);
    $this->Cell(20,8,'CRÉDITO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,20,35,60,35,75,20));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipocliente"]),utf8_decode($reg[$i]["documento"]." ".$reg[$i]["dnicliente"]),portales(utf8_decode($cliente = ($reg[$i]['tipocliente'] == 'NATURAL' ? $reg[$i]['nomcliente'] : $reg[$i]['razoncliente']))),utf8_decode($reg[$i]['tlfcliente'] == '' ? "*********" : $reg[$i]['tlfcliente']),utf8_decode($reg[$i]["ciudad"]." ".$reg[$i]["comuna"]." ".$reg[$i]["direccliente"]),utf8_decode(number_format($reg[$i]["limitecredito"], 0, '.', '.'))));
        }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CLIENTES ##############################

########################## FUNCION LISTAR PROVEEDORES ##############################
function TablaListarProveedores()
{
    $tra = new Login();
    $reg = $tra->ListarProveedores();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE PROVEEDORES',0,0,'C');
    
    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(260,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(260,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }
    
    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(40,8,'Nº DE DOCUMENTO',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE PROVEEDOR',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TELEFONO',1,0,'C', True);
    $this->Cell(75,8,'DIRECCIÓN DOMICILIARIA',1,0,'C', True);
    $this->Cell(35,8,'VENDEDOR',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {

    /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,40,60,35,75,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["documento"]." ".$reg[$i]["cuitproveedor"]),portales(utf8_decode($reg[$i]["nomproveedor"])),utf8_decode($reg[$i]["tlfproveedor"]),utf8_decode($reg[$i]["ciudad"]." ".$reg[$i]["comuna"]." ".$reg[$i]["direcproveedor"]),utf8_decode($reg[$i]["vendedor"])));
       }
    }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PROVEEDORES ##############################

############################### REPORTES DE PERSONAL ##############################



















############################### REPORTES DE MANTENIMIENTO ##############################

########################## FUNCION LISTAR INGREDIENTES ##############################
function TablaListarIngredientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarIngredientes(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE INGREDIENTES EN ALMACEN',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(35,8,'MEDIDA',1,0,'C', True);
    $this->CellFitSpace(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,55,35,20,20,35,35,25));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalMoneda=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $simbolo2 = ($reg[$i]['simbolo2'] == "" ? "" : $reg[$i]['simbolo2']);
    $moneda = (empty($reg[$i]['montocambio']) ? "0" : number_format($reg[$i]['precioventa'] / $reg[$i]['montocambio'], 0, '.', '.'));

    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa']-$reg[$i]['descingrediente']/100;
    $TotalMoneda += (empty($reg[$i]['montocambio']) ? "0" : number_format($reg[$i]['precioventa'] / $reg[$i]['montocambio'], 0, '.', '.'));

    //$TotalMoneda+= ($cambio == 0 ? "0" : $reg[$i]['precioventa']/$cambio[0]['montocambio']);
    $TotalArticulos+=$reg[$i]['cantingrediente'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codingrediente']),
        portales(utf8_decode($reg[$i]["nomingrediente"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.'))));
    }
   
    $this->Cell(165,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR INGREDIENTES ##############################

####################### FUNCION LISTAR INGREDIENTES EN STOCK MINIMO ##############################
function TablaListarIngredientesMinimo()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarIngredientesMinimo(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE INGREDIENTES EN STOCK MINIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'STOCK MINIMO',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['cantingrediente'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codingrediente']),
        portales(utf8_decode($reg[$i]["nomingrediente"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['stockminimo'], 2, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR INGREDIENTES EN STOCK MINIMO ##############################

####################### FUNCION LISTAR INGREDIENTES EN STOCK MAXIMO ##############################
function TablaListarIngredientesMaximo()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarIngredientesMaximo(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE INGREDIENTES EN STOCK MAXIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'STOCK MAXIMO',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['cantingrediente'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codingrediente']),
        portales(utf8_decode($reg[$i]["nomingrediente"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['stockmaximo'], 2, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR INGREDIENTES EN STOCK MAXIMO ##############################

####################### FUNCION LISTAR INGREDIENTES VENCIDOS ##############################
function TablaListarIngredientesVencidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarIngredientesVencidos(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE INGREDIENTES VENCIDOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'FECHA EXP.',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['cantingrediente'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codingrediente']),
        portales(utf8_decode($reg[$i]["nomingrediente"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode(date("d/m/Y",strtotime($reg[$i]['fechaexpiracion']))),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR INGREDIENTES VENCIDOS ##############################

################### FUNCION LISTAR INGREDIENTES SEGUN MODENA ###################
function TablaListarIngredientesxMoneda()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $cambio = new Login();
    $cambio = $cambio->BuscarTiposCambios();

    $tra = new Login();
    $reg = $tra->ListarIngredientes(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO DE INGREDIENTES EN ALMACEN POR MONEDA ',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }
    
    $this->Ln();
    $this->Cell(260,6,"MONEDA: ".portales(utf8_decode($cambio[0]["moneda"])),0,0,'L'); 
    
    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(65,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->CellFitSpace(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO '.$cambio[0]['siglas'],1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,65,30,20,20,25,35,30));

    $a=1;
    $TotalArticulos=0;
    $TotalPrecioVenta=0;
    $TotalPrecioVentaDescuento=0;
    $TotalMoneda=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $simbolo2 = $cambio[0]['simbolo'];
    
    $Descuento       = $reg[$i]['descingrediente']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal     = $reg[$i]['precioventa']-$PrecioDescuento;

    $TotalArticulos += $reg[$i]['cantingrediente'];
    $TotalPrecioVenta     += $reg[$i]['precioventa'];
    $TotalPrecioVentaDescuento  += $PrecioFinal;
    $TotalMoneda    += ($cambio == 0 ? "0" : $reg[$i]['precioventa']/$cambio[0]['montocambio']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codingrediente"]),portales(utf8_decode($reg[$i]["nomingrediente"])),utf8_decode($reg[$i]["nommedida"]),utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')."%"),utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.')),$tipo = ($cambio[0]['moneda'] == "EURO" ? chr(128) : $cambio[0]['simbolo']).utf8_decode(number_format($reg[$i]['precioventa']/$cambio[0]['montocambio'], 0, '.', '.'))));
    }
   
    $this->Cell(170,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalPrecioVenta, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo2.number_format($TotalMoneda, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
################## FUNCION LISTAR INGREDIENTES SEGUN MODENA ###################

########################## FUNCION LISTAR KARDEX POR INGREDIENTE ########################
function TablaListarKardexIngredientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $kardex = new Login();
    $kardex = $kardex->BuscarKardexIngrediente(); 

    $detalle = new Login();
    $detalle = $detalle->DetalleKardexIngrediente();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,7,'MOVIMIENTO GENERAL POR INGREDIENTE',0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $detalle != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($detalle[0]['documento'])." SUCURSAL: ".utf8_decode($detalle[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($detalle[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($detalle[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'MOVIMIENTO',1,0,'C', True);
    $this->Cell(20,8,'ENTRADAS',1,0,'C', True);
    $this->Cell(20,8,'SALIDAS',1,0,'C', True);
    $this->Cell(25,8,'DEVOLUCIÓN',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->CellFitSpace(18,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,'PRECIO',1,0,'C', True);
    $this->Cell(40,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(30,8,'FECHA KARDEX',1,1,'C', True);

    if($kardex==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,25,20,20,25,25,18,15,30,40,30));

    $TotalEntradas=0;
    $TotalSalidas=0;
    $TotalDevolucion=0;
    $a=1;
    for($i=0;$i<sizeof($kardex);$i++){ 
    $simbolo = ($detalle[0]['simbolo'] == "" ? "" : $detalle[0]['simbolo']);
    $TotalEntradas+=$kardex[$i]['entradas'];
    $TotalSalidas+=$kardex[$i]['salidas'];
    $TotalDevolucion+=$kardex[$i]['devolucion'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($kardex[$i]["movimiento"]),
        utf8_decode(number_format($kardex[$i]["entradas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["salidas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["devolucion"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]['stockactual'], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["ivaingrediente"], 0, '.', '.')),
        utf8_decode(number_format($kardex[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($kardex[$i]['precio'], 0, '.', '.')),
        utf8_decode($kardex[$i]['documento']." ".$num = ($kardex[$i]['documento'] == 'VENTA' || $kardex[$i]['documento'] == 'DEVOLUCION' ? $kardex[$i]['codproceso'] : "")),
        utf8_decode(date("d-m-Y",strtotime($kardex[$i]['fechakardex'])))));
        }
    }
   
    $this->Cell(325,5,'',0,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(120,5,'DETALLES DEL INGREDIENTE',1,0,'C', True);
    $this->Ln();
    
    $this->Cell(35,5,'CÓDIGO',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($detalle[0]['codingrediente']),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DESCRIPCIÓN',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,portales(utf8_decode($detalle[0]['nomingrediente'])),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'ENTRADAS',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalEntradas, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'SALIDAS',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalSalidas, 2, '.', ',')),1,0,'C');
    $this->Ln();

    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DEVOLUCIÓN',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(85,5,utf8_decode(number_format($TotalDevolucion, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'EXISTENCIA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($detalle[0]['cantingrediente'], 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO COMPRA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['preciocompra'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO VENTA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['precioventa'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR KARDEX POR INGREDIENTE ########################

####################### FUNCION LISTAR KARDEX VALORIZADO DE INGREDIENTES ###########################
function TablaListarKardexValorizadoIngredientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarIngredientes(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX VALORIZADO DE INGREDIENTES",0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(60,8,'DESCRIPCIÓN DE INGREDIENTE',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(40,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(40,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,60,30,30,20,15,25,40,40,30));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['cantingrediente'];

    $Descuento = $reg[$i]['descingrediente']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['cantingrediente'];
    $SubtotalimpuestosC    = ($reg[$i]['ivaingrediente'] == 'SI' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['cantingrediente'];
    $SubtotalimpuestosV    = ($reg[$i]['ivaingrediente'] == 'SI' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['cantingrediente'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['cantingrediente'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra;

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codingrediente"]),
        portales(utf8_decode($reg[$i]["nomingrediente"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode($reg[$i]['ivaingrediente'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descingrediente'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
        
    }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX VALORIZADO DE INGREDIENTES ##########################

####################### FUNCION LISTAR KARDEX INGREDIENTES VALORIZADO POR FECHAS ###########################
function TablaListarKardexValorizadoIngredientesxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarKardexIngredientesValorizadoxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX INGREDIENTES(EXTRAS) VALORIZADO POR FECHAS",0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE INGREDIENTE',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(35,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,70,30,20,30,25,20,35,35,30));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['cantingrediente'];
    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['cantidad'];
    $SubtotalimpuestosC    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['cantidad'];
    $SubtotalimpuestosV    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['cantidad'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['cantidad'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra;  

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]['codcategoria'] == '0' ? "*********" : $reg[$i]["nommedida"]),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
       }
    }
   
    $this->Cell(185,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX INGREDIENTES VALORIZADO POR FECHAS ##########################

######################## FUNCION LISTAR INGREDIENTES VENDIDOS #########################
function TablaListarIngredientesVendidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarIngredientesVendidos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE INGREDIENTES VENDIDOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(15,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(90,8,'DESCRIPCIÓN DE INGREDIENTE',1,0,'C', True);
    $this->Cell(30,8,'MEDIDA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,15,90,30,40,25,20,30,30,40));

    $a=1;
    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $TotalGeneral=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal   += $reg[$i]['precioventa'];
    $ExisteTotal   += $reg[$i]['cantingrediente'];
    $VendidosTotal += $reg[$i]['cantidad'];

    $Descuento        = $reg[$i]['descproducto']/100;
    $PrecioDescuento  = $reg[$i]['precioventa']*$Descuento;
    //$CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $CalculoDescuento = number_format($reg[$i]['totaldescuentov'], 2, '.', '');
    $PrecioFinal      = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg              = $reg[$i]['ivaproducto']/100;
    $CalculoImpuesto  = number_format($reg[$i]['subtotalimpuestos'], 2, '.', '');

    $TotalDescuento += $CalculoDescuento; 
    $TotalImpuesto  += $CalculoImpuesto; 
    $TotalGeneral   += $PrecioFinal*$reg[$i]['cantidad'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nommedida"]),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantingrediente'], 2, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(150,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalGeneral, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR INGREDIENTES VENDIDOS ########################












########################## FUNCION LISTAR PRODUCTOS ##############################
function TablaListarProductos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarProductos(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE PRODUCTOS EN ALMACEN',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(58,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(35,8,'CATEGORIA',1,0,'C', True);
    $this->CellFitSpace(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,1,'C', True);


    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,58,35,20,20,25,35,35));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalMoneda=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    $simbolo2 = ($reg[$i]['simbolo2'] == "" ? "" : $reg[$i]['simbolo2']);
    $moneda = (empty($reg[$i]['montocambio']) ? "0" : number_format($reg[$i]['precioventa']/$reg[$i]['montocambio'], 0, '.', '.'));

    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalMoneda += (empty($reg[$i]['montocambio']) ? "0" : number_format($reg[$i]['precioventa']/$reg[$i]['montocambio'], 0, '.', '.'));
    $TotalArticulos+=$reg[$i]['existencia'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codproducto']),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(165,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PRODUCTOS ##############################

####################### FUNCION LISTAR PRODUCTOS EN STOCK MINIMO ##############################
function TablaListarProductosMinimo()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarProductosMinimo(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE PRODUCTOS EN STOCK MINIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'STOCK MINIMO',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['existencia'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codproducto']),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['stockminimo'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PRODUCTOS EN STOCK MINIMO ##############################

####################### FUNCION LISTAR PRODUCTOS EN STOCK MAXIMO ##############################
function TablaListarProductosMaximo()
{
   	$imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarProductosMaximo();
   
    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE PRODUCTOS EN STOCK MAXIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'STOCK MAXIMO',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['existencia'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codproducto']),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['stockmaximo'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PRODUCTOS EN STOCK MAXIMO ##############################

####################### FUNCION LISTAR PRODUCTOS VENCIDOS ##############################
function TablaListarProductosVencidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarProductosVencidos();
   
    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO GENERAL DE PRODUCTOS VENCIDOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->CellFitSpace(15,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(28,8,'FECHA EXP.',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,20,55,30,15,15,28,25,30,30));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+= $reg[$i]['existencia'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codproducto']),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode(date("d/m/Y",strtotime($reg[$i]['fechaexpiracion']))),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PRODUCTOS VENCIDOS ##############################

################### FUNCION LISTAR PRODUCTOS SEGUN MODENA ###################
function TablaListarProductosxMoneda()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $cambio = new Login();
    $cambio = $cambio->BuscarTiposCambios();

    $tra = new Login();
    $reg = $tra->ListarProductos(); 

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,10,'LISTADO DE PRODUCTOS EN ALMACEN POR MONEDA ',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }
    
    $this->Ln();
    $this->Cell(260,6,"MONEDA: ".portales(utf8_decode($cambio[0]["moneda"])),0,0,'L'); 
    
    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(65,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->CellFitSpace(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO '.$cambio[0]['siglas'],1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,65,30,20,20,25,35,30));

    $a=1;
    $TotalArticulos=0;
    $TotalPrecioVenta=0;
    $TotalPrecioVentaDescuento=0;
    $TotalMoneda=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $simbolo2 = $cambio[0]['simbolo'];
    
    $Descuento       = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal     = $reg[$i]['precioventa']-$PrecioDescuento;

    $TotalArticulos += $reg[$i]['existencia'];
    $TotalPrecioVenta     += $reg[$i]['precioventa'];
    $TotalPrecioVentaDescuento  += $PrecioFinal;
    $TotalMoneda    += ($cambio == 0 ? "0" : $reg[$i]['precioventa']/$cambio[0]['montocambio']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codproducto"]),portales(utf8_decode($reg[$i]["producto"])),utf8_decode($reg[$i]["nomcategoria"]),utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.')),$tipo = ($cambio[0]['moneda'] == "EURO" ? chr(128) : $cambio[0]['simbolo']).utf8_decode(number_format($reg[$i]['precioventa']/$cambio[0]['montocambio'], 0, '.', '.'))));
    }
   
    $this->Cell(170,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalPrecioVenta, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo2.number_format($TotalMoneda, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
################## FUNCION LISTAR PRODUCTOS SEGUN MODENA ###################

########################## FUNCION LISTAR KARDEX POR PRODUCTO ########################
function TablaListarKardexProductos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $kardex = new Login();
    $kardex = $kardex->BuscarKardexProducto(); 

    $detalle = new Login();
    $detalle = $detalle->DetalleKardexProducto();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,7,'MOVIMIENTO GENERAL POR PRODUCTO',0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $detalle != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($detalle[0]['documento'])." SUCURSAL: ".utf8_decode($detalle[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($detalle[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($detalle[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(12,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'MOVIMIENTO',1,0,'C', True);
    $this->Cell(20,8,'ENTRADAS',1,0,'C', True);
    $this->Cell(20,8,'SALIDAS',1,0,'C', True);
    $this->Cell(25,8,'DEVOLUCIÓN',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->CellFitSpace(18,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,'PRECIO',1,0,'C', True);
    $this->Cell(40,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(30,8,'FECHA KARDEX',1,1,'C', True);

    if($kardex==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(12,25,20,20,25,25,18,15,30,40,30));

    $TotalEntradas=0;
    $TotalSalidas=0;
    $TotalDevolucion=0;
    $a=1;
    for($i=0;$i<sizeof($kardex);$i++){ 
    $simbolo = ($detalle[0]['simbolo'] == "" ? "" : $detalle[0]['simbolo']);
    $TotalEntradas+=$kardex[$i]['entradas'];
    $TotalSalidas+=$kardex[$i]['salidas'];
    $TotalDevolucion+=$kardex[$i]['devolucion'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($kardex[$i]["movimiento"]),
        utf8_decode(number_format($kardex[$i]["entradas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["salidas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["devolucion"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]['stockactual'], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["ivaproducto"], 0, '.', '.')),
        utf8_decode(number_format($kardex[$i]['descproducto'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($kardex[$i]['precio'], 0, '.', '.')),
        utf8_decode($kardex[$i]['documento']." ".$num = ($kardex[$i]['documento'] == 'VENTA' || $kardex[$i]['documento'] == 'DEVOLUCION' ? $kardex[$i]['codproceso'] : "")),
        utf8_decode(date("d-m-Y",strtotime($kardex[$i]['fechakardex'])))));
        }
    }
   
    $this->Cell(325,5,'',0,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(120,5,'DETALLES DEL PRODUCTO',1,0,'C', True);
    $this->Ln();
    
    $this->Cell(35,5,'CÓDIGO',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($detalle[0]['codproducto']),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DESCRIPCIÓN',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,portales(utf8_decode($detalle[0]['producto'])),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'ENTRADAS',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalEntradas, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'SALIDAS',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalSalidas, 2, '.', ',')),1,0,'C');
    $this->Ln();

    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DEVOLUCIÓN',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(85,5,utf8_decode(number_format($TotalDevolucion, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'EXISTENCIA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($detalle[0]['existencia'], 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO COMPRA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['preciocompra'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO VENTA',1,0,'C', True);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['precioventa'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR KARDEX POR PRODUCTO ########################

####################### FUNCION LISTAR KARDEX VALORIZADO DE PRODUCTOS ###########################
function TablaListarKardexValorizadoProductos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarProductos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX VALORIZADO DE PRODUCTOS",0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(60,8,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(40,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(40,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,60,30,30,20,15,25,40,40,30));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['existencia'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['existencia'];
    $SubtotalimpuestosC    = ($reg[$i]['ivaproducto'] == 'SI' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['existencia'];
    $SubtotalimpuestosV    = ($reg[$i]['ivaproducto'] == 'SI' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['existencia'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['existencia'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode($reg[$i]['ivaproducto'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
       
    }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX VALORIZADO DE PRODUCTOS ##########################

####################### FUNCION LISTAR KARDEX PRODUCTOS VALORIZADO POR FECHAS ###########################
function TablaListarKardexValorizadoProductosxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarKardexProductosValorizadoxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX PRODUCTOS VALORIZADO POR FECHAS",0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(35,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,70,30,20,30,25,20,35,35,30));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['existencia'];
    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['cantidad'];
    $SubtotalimpuestosC    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['cantidad'];
    $SubtotalimpuestosV    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['cantidad'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['cantidad'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra;  

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]['codcategoria'] == '0' ? "*********" : $reg[$i]["nomcategoria"]),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
       }
    }
   
    $this->Cell(185,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX PRODUCTOS VALORIZADO POR FECHAS ##########################

######################## FUNCION LISTAR PRODUCTOS VENDIDOS #########################
function TablaListarProductosVendidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarProductosVendidos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE PRODUCTOS VENDIDOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(15,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(90,8,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,15,90,30,40,25,20,30,30,40));

    $a=1;
    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $TotalGeneral=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal   += $reg[$i]['precioventa'];
    $ExisteTotal   += $reg[$i]['existencia'];
    $VendidosTotal += $reg[$i]['cantidad'];

    $Descuento        = $reg[$i]['descproducto']/100;
    $PrecioDescuento  = $reg[$i]['precioventa']*$Descuento;
    //$CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $CalculoDescuento = number_format($reg[$i]['totaldescuentov'], 2, '.', '');
    $PrecioFinal      = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg              = $reg[$i]['ivaproducto']/100;
    $CalculoImpuesto  = number_format($reg[$i]['subtotalimpuestos'], 2, '.', '');

    $TotalDescuento += $CalculoDescuento; 
    $TotalImpuesto  += $CalculoImpuesto; 
    $TotalGeneral   += $PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($reg[$i]["nomcategoria"]),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(150,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalGeneral, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR PRODUCTOS VENDIDOS ########################

########################## FUNCION LISTAR MENU ##############################
function TablaListarMenu()
{
    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");

    // Inserta un logo en la esquina superior izquierda a 300 ppp
    //$this->Image($logo,50,80,120,0,'PNG');

    $tra = new Login();
    $reg = $tra->ListarProductosMenu();

    if($reg==""){

    } else {

    $this->SetFont('Courier','BI',24);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,8,portales(utf8_decode($_SESSION['nomsucursal'])),0,0,'C');
    $this->Ln();

    $this->SetFont('Courier','BI',18);  
    $this->SetTextColor(12,41,157);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,5,'CARTA DE MENÚ (PRODUCTOS)',0,1,'C');
    $this->Ln();

    $a=1;
    for($cont = 0, $s = sizeof($reg); $cont < $s; $cont++):
    $simbolo = ($reg[$cont]['simbolo'] == "" ? "" : $reg[$cont]['simbolo']);

    $this->SetFont('Courier','B',18);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(190,8,utf8_decode($reg[$cont]["nomcategoria"]),0,0,'C', True);
    $this->Ln();

    $a=1;
    $explode = explode("<br>",$reg[$cont]['menu_productos']);

    for($aum = 0, $r = sizeof($explode); $aum < $r; $aum++):
    $producto_info = explode("|",$explode[$aum]);
    if (count($producto_info) >= 3) {
        list($producto,$precioventa,$existencia) = $producto_info;

    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('courier','',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(150,5,portales(utf8_decode($producto)),0,0,'L');
    $this->SetFont('courier','B',12); 
    $this->Cell(40,5,utf8_decode($simbolo.number_format($precioventa, 0, '.', '.')),0,0,'R');
    $this->Ln();
    } else {
      // Opcional: Puedes agregar un manejo para las líneas con formato incorrecto
      // Por ejemplo, podrías omitirlas o loggear un error.
      // echo "";
    } 
    endfor; ##fin de for

    endfor; ##fin de for

    $this->AddPage();//HACEMOS SALTO DE LINEA
    }

    $tra2 = new Login();
    $combo = $tra2->ListarCombosMenu();

    if($combo==""){

    } else {

    $this->SetFont('Courier','BI',24);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,8,portales(utf8_decode($_SESSION['nomsucursal'])),0,0,'C');
    $this->Ln();

    $this->SetFont('Courier','BI',18);  
    $this->SetTextColor(12,41,157);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,5,'CARTA DE MENÚ (COMBOS)',0,1,'C');
    $this->Ln();

    $this->SetFont('Courier','B',14);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(60,6,"Nombre",0,0,'C', True);
    $this->Cell(50,6,"Precio Venta",0,0,'C', True);
    $this->Cell(90,6,"Detalles de Combo",0,0,'C', True);
    $this->Ln();

    $a=1;
    for($contt = 0, $ss = sizeof($combo); $contt < $ss; $contt++):
    $simbolo = ($combo[$contt]['simbolo'] == "" ? "" : $combo[$contt]['simbolo']);
    $detalles = str_replace("<br>","\n", $combo[$contt]['detalles_productos']);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('courier','',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->CellFitSpace(60,5,portales(utf8_decode($combo[$contt]["nomcombo"])),0,0,'L');
    $this->SetFont('courier','B',12); 
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($combo[$contt]["precioventa"], 0, '.', '.')),0,0,'R');
    $this->MultiCell(90,3.5,$this->SetFont('Courier','B',9).portales(utf8_decode($detalles)),0,'R');
    $this->Ln();

    endfor; ##fin de for

    $this->AddPage();//HACEMOS SALTO DE LINEA
    }


    $extras = new Login();
    $extras = $extras->ListarIngredientesMenu();

    if($extras==""){

    } else {

    $this->SetFont('Courier','BI',24);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,8,portales(utf8_decode($_SESSION['nomsucursal'])),0,0,'C');
    $this->Ln();

    $this->SetFont('Courier','BI',18);  
    $this->SetTextColor(12,41,157);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,5,'CARTA DE MENÚ (EXTRAS)',0,1,'C');
    $this->Ln();

    $a=1;
    for($cont = 0, $s = sizeof($extras); $cont < $s; $cont++):
    $simbolo = ($extras[$cont]['simbolo'] == "" ? "" : $extras[$cont]['simbolo']);

    $this->SetFont('Courier','B',18);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(190,8,utf8_decode($extras[$cont]["nommedida"]),0,0,'C', True);
    $this->Ln();

    $a=1;
    $explode = explode("<br>",$extras[$cont]['menu_extras']);

    for($aum = 0, $r = sizeof($explode); $aum < $r; $aum++):
    $ingrediente_info = explode("|",$explode[$aum]);
    if (count($ingrediente_info) >= 3) {
        list($nomingrediente,$precioingrediente,$existencia) = $ingrediente_info;

    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('courier','',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(150,5,portales(utf8_decode($nomingrediente)),0,0,'L');
    $this->SetFont('courier','B',12); 
    $this->Cell(40,5,utf8_decode($simbolo.number_format($precioingrediente, 0, '.', '.')),0,0,'R');
    $this->Ln();
    } else {
      // Opcional: Puedes agregar un manejo para las líneas con formato incorrecto
      // Por ejemplo, podrías omitirlas o loggear un error.
      // echo "";
    }
    endfor; ##fin de for

    endfor; ##fin de for
    }
}
########################## FUNCION LISTAR MENU ##############################















########################## FUNCION LISTAR COMBOS ##############################
function TablaListarCombos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarCombos();  
   
    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE COMBOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(40,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(110,8,'DETALLES DE PRODUCTOS',1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,40,20,20,110,30,35,35));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalMoneda=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    $simbolo2 = ($reg[$i]['simbolo2'] == "" ? "" : $reg[$i]['simbolo2']);
    $moneda = (empty($reg[$i]['montocambio']) ? "0" : number_format($reg[$i]['precioventa'] / $reg[$i]['montocambio'], 0, '.', '.'));

    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+=$reg[$i]['existencia'];
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles_productos']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codcombo']),
        portales(utf8_decode($reg[$i]["nomcombo"])),
        utf8_decode($reg[$i]['ivacombo'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['desccombo'], 0, '.', '.')),
        portales(utf8_decode($detalles)),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalCompra, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalVenta, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMBOS ##############################

####################### FUNCION LISTAR COMBOS EN STOCK MINIMO ##############################
function TablaListarCombosMinimo()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarCombosMinimo(); 
   
    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE COMBOS EN STOCK MINIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(40,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(80,8,'DETALLES DE PRODUCTOS',1,0,'C', True);
    $this->Cell(30,8,'STOCK MINIMO',1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,40,20,20,80,30,30,35,35));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+=$reg[$i]['existencia'];
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles_productos']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codcombo']),
        portales(utf8_decode($reg[$i]["nomcombo"])),
        utf8_decode($reg[$i]['ivacombo'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['desccombo'], 0, '.', '.')),
        portales(utf8_decode($detalles)),
        utf8_decode(number_format($reg[$i]['stockminimo'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 2, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalCompra, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalVenta, 2, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMBOS EN STOCK MINIMO ##############################

####################### FUNCION LISTAR COMBOS EN STOCK MAXIMO ##############################
function TablaListarCombosMaximo()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarCombosMaximo(); 
   
    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE COMBOS EN STOCK MAXIMO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(40,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(80,8,'DETALLES DE PRODUCTOS',1,0,'C', True);
    $this->Cell(30,8,'STOCK MAXIMO',1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO COMPRA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,40,20,20,80,30,30,35,35));

    $a=1;
    $TotalCompra=0;
    $TotalVenta=0;
    $TotalArticulos=0;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $TotalCompra+=$reg[$i]['preciocompra'];
    $TotalVenta+=$reg[$i]['precioventa'];
    $TotalArticulos+=$reg[$i]['existencia'];
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles_productos']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['codcombo']),
        portales(utf8_decode($reg[$i]["nomcombo"])),
        utf8_decode($reg[$i]['ivacombo'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['desccombo'], 0, '.', '.')),
        portales(utf8_decode($detalles)),
        utf8_decode(number_format($reg[$i]['stockmaximo'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($reg[$i]['preciocompra'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 2, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalCompra, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalVenta, 2, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMBOS EN STOCK MAXIMO ##############################

################### FUNCION LISTAR COMBOS SEGUN MODENA ###################
function TablaListarCombosxMoneda()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $cambio = new Login();
    $cambio = $cambio->BuscarTiposCambios();

    $tra = new Login();
    $reg = $tra->ListarCombos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE COMBOS EN ALMACEN POR MONEDA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }
    
    $this->Ln();
    $this->Cell(335,6,"MONEDA: ".portales(utf8_decode($cambio[0]["moneda"])),0,0,'L'); 
    
    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(45,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->CellFitSpace(20,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(125,8,'DETALLES DE PRODUCTOS',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(35,8,'PRECIO VENTA',1,0,'C', True);
    $this->Cell(30,8,'PRECIO '.$cambio[0]['siglas'],1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,45,20,20,125,25,35,30));

    $a=1;
    $TotalArticulos=0;
    $TotalPrecioVenta=0;
    $TotalPrecioVentaDescuento=0;
    $TotalMoneda=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    $simbolo2 = $cambio[0]['simbolo'];
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles_productos']);
    
    $Descuento       = $reg[$i]['desccombo']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal     = $reg[$i]['precioventa']-$PrecioDescuento;

    $TotalArticulos += $reg[$i]['existencia'];
    $TotalPrecioVenta     += $reg[$i]['precioventa'];
    $TotalPrecioVentaDescuento  += $PrecioFinal;
    $TotalMoneda    += ($cambio == 0 ? "0" : $reg[$i]['precioventa']/$cambio[0]['montocambio']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codcombo"]),portales(utf8_decode($reg[$i]["nomcombo"])),utf8_decode($reg[$i]['ivacombo'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),utf8_decode(number_format($reg[$i]['desccombo'], 0, '.', '.')."%"),portales(utf8_decode($detalles)),utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),utf8_decode($simbolo.number_format($reg[$i]['precioventa'], 0, '.', '.')),$tipo = ($cambio[0]['moneda'] == "EURO" ? chr(128) : $cambio[0]['simbolo']).utf8_decode(number_format($reg[$i]['precioventa']/$cambio[0]['montocambio'], 0, '.', '.'))));
    }
   
    $this->Cell(245,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalPrecioVenta, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo2.number_format($TotalMoneda, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
################## FUNCION LISTAR COMBOS SEGUN MODENA ###################

########################## FUNCION LISTAR KARDEX POR COMBO ########################
function TablaListarKardexCombos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $kardex = new Login();
    $kardex = $kardex->BuscarKardexCombo(); 

    $detalle = new Login();
    $detalle = $detalle->DetalleKardexCombo(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'MOVIMIENTO GENERAL POR COMBO',0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $detalle != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($detalle[0]['documento'])." SUCURSAL: ".utf8_decode($detalle[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($detalle[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($detalle[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'MOVIMIENTO',1,0,'C', True);
    $this->Cell(25,8,'ENTRADAS',1,0,'C', True);
    $this->Cell(25,8,'SALIDAS',1,0,'C', True);
    $this->Cell(25,8,'DEVOLUCIÓN',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(30,8,'PRECIO',1,0,'C', True);
    $this->Cell(70,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(30,8,'FECHA KARDEX',1,1,'C', True);

    if($kardex==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,35,25,25,25,25,20,30,30,70,30));

    $TotalEntradas=0;
    $TotalSalidas=0;
    $TotalDevolucion=0;
    $a=1;
    for($i=0;$i<sizeof($kardex);$i++){ 
    $simbolo = ($detalle[0]['simbolo'] == "" ? "" : $detalle[0]['simbolo']);
    $TotalEntradas+=$kardex[$i]['entradas'];
    $TotalSalidas+=$kardex[$i]['salidas'];
    $TotalDevolucion+=$kardex[$i]['devolucion'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($kardex[$i]["movimiento"]),
        utf8_decode(number_format($kardex[$i]["entradas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["salidas"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["devolucion"], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]['stockactual'], 2, '.', ',')),
        utf8_decode(number_format($kardex[$i]["ivacombo"], 0, '.', '.')),
        utf8_decode(number_format($kardex[$i]['desccombo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($kardex[$i]['precio'], 0, '.', '.')),
        utf8_decode($kardex[$i]['documento']." ".$num = ($kardex[$i]['documento'] == 'VENTA' || $kardex[$i]['documento'] == 'DEVOLUCION' ? $kardex[$i]['codproceso'] : "")),
        utf8_decode(date("d-m-Y",strtotime($kardex[$i]['fechakardex'])))));
        }
    }
   
    $this->Cell(325,5,'',0,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(120,5,'DETALLES DEL COMBO',1,0,'C', True);
    $this->Ln();
    
    $this->Cell(35,5,'CÓDIGO',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($detalle[0]['codcombo']),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DESCRIPCIÓN',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,portales(utf8_decode($detalle[0]['nomcombo'])),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'ENTRADAS',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalEntradas, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'SALIDAS',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($TotalSalidas, 2, '.', ',')),1,0,'C');
    $this->Ln();

    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'DEVOLUCIÓN',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(85,5,utf8_decode(number_format($TotalDevolucion, 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'EXISTENCIA',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode(number_format($detalle[0]['existencia'], 2, '.', ',')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO COMPRA',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['preciocompra'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(35,5,'PRECIO VENTA',1,0,'C', True);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(85,5,utf8_decode($simbolo.number_format($detalle[0]['precioventa'], 0, '.', '.')),1,0,'C');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR KARDEX POR COMBO ########################

####################### FUNCION LISTAR KARDEX VALORIZADO DE COMBOS ###########################
function TablaListarKardexValorizadoCombos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarCombos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX VALORIZADO DE COMBOS",0,1,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE COMBO',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(20,8,$impuesto,1,0,'C', True);
    $this->Cell(15,8,'DESC %',1,0,'C', True);
    $this->Cell(25,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(42,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(42,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(46,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,25,70,30,20,15,25,42,42,46));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['existencia'];

    $Descuento = $reg[$i]['desccombo']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['existencia'];
    $SubtotalimpuestosC    = ($reg[$i]['ivacombo'] == 'SI' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['existencia'];
    $SubtotalimpuestosV    = ($reg[$i]['ivacombo'] == 'SI' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['existencia'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['existencia'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codcombo"]),
        portales(utf8_decode($reg[$i]["nomcombo"])),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode($reg[$i]['ivacombo'] == 'SI' ? number_format($valor, 0, '.', '.')."%" : "(E)"),
        utf8_decode(number_format($reg[$i]['desccombo'], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
        
    }
   
    $this->Cell(175,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(42,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(42,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(46,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX VALORIZADO DE COMBOS ##########################

####################### FUNCION LISTAR KARDEX COMBOS VALORIZADO POR FECHAS ###########################
function TablaListarKardexValorizadoCombosxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarKardexCombosValorizadoxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE KARDEX COMBOS VALORIZADO POR FECHAS",0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE COMBO',1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(25,8,'VENDIDO',1,0,'C', True);
    $this->Cell(40,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(40,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,20,70,25,35,30,25,40,40,30));

    $a=1;
    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $ImpuestosCompraTotal=0;
    $ImpuestosVentaTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $ExisteTotal+=$reg[$i]['existencia'];
    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //VALOR DE IMPUESTO
    $ValorImpuesto = 1 + ($valor/100);

    //CALCULO SUBTOTAL IMPUESTOS PRECIO COMPRA
    $DiscriminadoC         = $reg[$i]['preciocompra']/$ValorImpuesto;
    $SubtotalDiscriminadoC = $reg[$i]['preciocompra'] - $DiscriminadoC;
    $BaseDiscriminadoC     = $SubtotalDiscriminadoC * $reg[$i]['cantidad'];
    $SubtotalimpuestosC    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoC, 2, '.', '') : "0");

    //CALCULO SUBTOTAL IMPUESTOS PRECIO VENTA
    $DiscriminadoV         = $PrecioFinal/$ValorImpuesto;
    $SubtotalDiscriminadoV = $PrecioFinal - $DiscriminadoV;
    $BaseDiscriminadoV     = $SubtotalDiscriminadoV * $reg[$i]['cantidad'];
    $SubtotalimpuestosV    = ($reg[$i]['ivaproducto'] != '0' ? number_format($BaseDiscriminadoV, 2, '.', '') : "0");

    $SumCompra = ($reg[$i]['preciocompra']*$reg[$i]['cantidad'])-$SubtotalimpuestosC;
    $SumVenta  = ($PrecioFinal*$reg[$i]['cantidad'])-$SubtotalimpuestosV; 

    $CompraTotal          += $SumCompra;
    $ImpuestosCompraTotal += $SubtotalimpuestosC;
    $VentaTotal           += $SumVenta;
    $ImpuestosVentaTotal  += $SubtotalimpuestosV;
    $TotalGanancia        += $SumVenta-$SumCompra; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
       }
    }
   
    $this->Cell(165,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode(number_format($VendidosTotal, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR KARDEX COMBOS VALORIZADO POR FECHAS ##########################

######################## FUNCION LISTAR COMBOS VENDIDOS #########################
function TablaListarCombosVendidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarCombosVendidos(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE COMBOS VENDIDOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(15,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(90,8,'DESCRIPCIÓN DE COMBO',1,0,'C', True);
    $this->Cell(45,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(30,8,'VENDIDO',1,0,'C', True);
    $this->Cell(35,8,$impuesto,1,0,'C', True);
    $this->Cell(35,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,15,90,45,30,30,35,35,40));

    $a=1;
    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $TotalGeneral=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal   += $reg[$i]['precioventa'];
    $ExisteTotal   += $reg[$i]['existencia'];
    $VendidosTotal += $reg[$i]['cantidad'];

    $Descuento        = $reg[$i]['descproducto']/100;
    $PrecioDescuento  = $reg[$i]['precioventa']*$Descuento;
    //$CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $CalculoDescuento = number_format($reg[$i]['totaldescuentov'], 2, '.', '');
    $PrecioFinal      = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg              = $reg[$i]['ivaproducto']/100;
    $CalculoImpuesto  = number_format($reg[$i]['subtotalimpuestos'], 2, '.', '');

    $TotalDescuento += $CalculoDescuento; 
    $TotalImpuesto  += $CalculoImpuesto; 
    $TotalGeneral   += $PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(120,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalGeneral, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR COMBOS VENDIDOS ########################

############################### REPORTES DE MANTENIMIENTO ##############################





























############################### REPORTES DE COMPRAS ##################################

########################## FUNCION FACTURA COMPRA ##############################
function FacturaCompra()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ComprasPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);

    //Logo
    if (isset($reg[0]['cuitsucursal'])) {
        if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

        $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
        $this->Image($logo, 15, 11, 66, 18, "PNG");

        } else {

        $logo = "fotos/logo_principal.png";                         
        $this->Image($logo, 15, 10, 64, 20, "PNG");  
        }                                      
    }
                                   
    ######################### BLOQUE N° 1 ######################### 
    //BLOQUE DE DATOS DE PRINCIPAL
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 10, 260, 20, '1.5', '');
    
    //Bloque de membrete principal
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(127, 13, 13, 13, '1.5', 'F');

    //Bloque de membrete principal
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(127, 13, 13, 13, '1.5', '');

    $this->SetFont('Courier','B',16);
    $this->SetXY(130, 14);
    $this->Cell(20, 5, 'C', 0, 0);
    $this->SetFont('Courier','B',9);
    $this->SetXY(126.5, 19);
    $this->Cell(20, 5, 'Compra', 0, 0);
    
    $this->SetFont('Courier','B',12);
    $this->SetXY(190, 11);
    $this->Cell(42, 4, 'N° DE COMPRA ', 0, 0);
    $this->SetFont('Courier','B',12);
    $this->SetXY(232, 11);
    $this->CellFitSpace(35, 4,utf8_decode($reg[0]['codfactura']), 0, 0, "R");
    
    $this->SetFont('Courier','B',10);
    $this->SetXY(190, 15);
    $this->Cell(42, 4, 'FECHA DE EMISIÓN ', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(232, 15);
    $this->CellFitSpace(35, 4,utf8_decode(date("d-m-Y",strtotime($reg[0]['fechaemision']))), 0, 0, "R");
    
    $this->SetFont('Courier','B',10);
    $this->SetXY(190, 20);
    $this->Cell(42, 4, 'FECHA DE RECEPCIÓN ', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(232, 20);
    $this->CellFitSpace(35, 4,utf8_decode(date("d-m-Y",strtotime($reg[0]['fecharecepcion']))), 0, 0, "R");
    
    $this->SetFont('Courier','B',10);
    $this->SetXY(190, 25);
    $this->Cell(42, 4, 'ESTADO DE COMPRA', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(232, 25);
    
    if($reg[0]['fechavencecredito']== '0000-00-00') { 
    $this->Cell(35, 4,utf8_decode($reg[0]['statuscompra']), 0, 0, "R");
    } elseif($reg[0]['fechavencecredito'] >= date("Y-m-d")) { 
    $this->Cell(35, 4,utf8_decode($reg[0]['statuscompra']), 0, 0, "R");
    } elseif($reg[0]['fechavencecredito'] < date("Y-m-d")) { 
    $this->Cell(35, 4,utf8_decode("VENCIDA"), 0, 0, "R");
    }
    ######################### BLOQUE N° 1 ######################### 

    ############################## BLOQUE N° 2 #####################################   
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 32, 260, 16, '1.5', '');

    //DATOS DE SUCURSAL LINEA 1
    $this->SetFont('Courier','B',11);
    $this->SetXY(12, 33);
    $this->Cell(256, 5, 'DATOS DE SUCURSAL ', 0, 0);
    //DATOS DE SUCURSAL LINEA 1

    //DATOS DE SUCURSAL LINEA 2
    $this->SetFont('Courier','B',10);
    $this->SetXY(12, 38);
    $this->CellFitSpace(22, 5, 'Nº DE '.$documento = ($reg[0]['documsucursal'] == '0' ? "REG.:" : $reg[0]['documento'].":"), 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(34, 38);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['cuitsucursal']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(66, 38);
    $this->Cell(30, 5, 'RAZÓN SOCIAL:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(96, 38);
    $this->CellFitSpace(54, 5,utf8_decode($reg[0]['nomsucursal']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(150, 38);
    $this->Cell(16, 5, 'EMAIL:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(166, 38);
    $this->CellFitSpace(58, 5,utf8_decode($reg[0]['correosucursal']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(224, 38);
    $this->Cell(12, 5, 'TLF:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(236, 38);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['tlfsucursal']), 0, 0);
    //DATOS DE SUCURSAL LINEA 2

    //DATOS DE SUCURSAL LINEA 3
    $this->SetFont('Courier','B',10);
    $this->SetXY(12, 43);
    $this->Cell(22, 5, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(34, 43);
    $this->CellFitSpace(86, 5,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])." ".$reg[0]['direcsucursal']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(120, 43);
    $this->Cell(28, 5, 'RESPONSABLE:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(148, 43);
    $this->CellFitSpace(76, 5,utf8_decode($reg[0]['nomencargado']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(224, 43);
    $this->CellFitSpace(12, 5,$documento = ($reg[0]['documencargado'] == '0' ? "DOC:" : $reg[0]['documento2'].":"), 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(236, 43);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['dniencargado']), 0, 0);
    //DATOS DE SUCURSAL LINEA 3
    ################################# BLOQUE N° 2 #######################################   

    ################################# BLOQUE N° 3 #######################################     
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 50, 260, 16, '1.5', '');

    //DATOS DE SUCURSAL LINEA 4
    $this->SetFont('Courier','B',11);
    $this->SetXY(12, 50);
    $this->Cell(256, 5, 'DATOS DE PROVEEDOR', 0, 0);
    //DATOS DE SUCURSAL LINEA 4

    //DATOS DE SUCURSAL LINEA 5
    $this->SetFont('Courier','B',10);
    $this->SetXY(12, 55);
    $this->CellFitSpace(22, 5, 'Nº DE '.$documento = ($reg[0]['documproveedor'] == '0' ? "DOC:" : $reg[0]['documento3'].":"), 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(34, 55);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['cuitproveedor']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(66, 55);
    $this->Cell(30, 5, 'RAZÓN SOCIAL:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(96, 55);
    $this->CellFitSpace(54, 5,utf8_decode($reg[0]['nomproveedor']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(150, 55);
    $this->Cell(16, 5, 'EMAIL:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(166, 55);
    $this->CellFitSpace(58, 5,utf8_decode($reg[0]['emailproveedor']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(224, 55);
    $this->Cell(12, 5, 'TLF:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(236, 55);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['tlfproveedor']), 0, 0);
    //DATOS DE SUCURSAL LINEA 5

    //DATOS DE SUCURSAL LINEA 6
    $this->SetFont('Courier','B',10);
    $this->SetXY(12, 60);
    $this->Cell(22, 5, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(34, 60);
    $this->CellFitSpace(86, 5,utf8_decode($ciudad = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])." ".$comuna = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])." ".$reg[0]['direcproveedor']), 0, 0);
    

    $this->SetFont('Courier','B',10);
    $this->SetXY(120, 60);
    $this->Cell(28, 5, 'VENDEDOR:', 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(148, 60);
    $this->CellFitSpace(76, 5,utf8_decode($reg[0]['vendedor']), 0, 0);

    $this->SetFont('Courier','B',10);
    $this->SetXY(224, 60);
    $this->CellFitSpace(12, 5,"TLF", 0, 0);
    $this->SetFont('Courier','',10);
    $this->SetXY(236, 60);
    $this->CellFitSpace(32, 5,utf8_decode($reg[0]['tlfvendedor']), 0, 0);
    //DATOS DE SUCURSAL LINEA 6
    ################################# BLOQUE N° 3 #######################################   

    ################################# BLOQUE N° 4 #######################################   
    //Bloque Cuadro de Detalles de Productos
    $this->SetFont('Courier','B',9);
    $this->SetXY(10, 68);
    $this->SetTextColor(3, 3, 3); // Establece el color del texto (en este caso es Negro)
    $this->SetFillColor(229, 229, 229); // establece el color del fondo de la celda (en este caso es GRIS 229)
    $this->Cell(10,6,'N°',1,0,'C', True);
    $this->Cell(20,6,'CÓDIGO',1,0,'C', True);
    $this->Cell(15,6,'LOTE',1,0,'C', True);
    $this->Cell(60,6,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(27,6,'CATEGORIA',1,0,'C', True);
    $this->Cell(15,6,'CANT',1,0,'C', True);
    $this->Cell(14,6,"IMP.",1,0,'C', True);
    $this->Cell(25,6,'PRECIO UNIT',1,0,'C', True);
    $this->Cell(28,6,'VALOR TOTAL',1,0,'C', True);
    $this->Cell(15,6,'DESC %',1,0,'C', True);
    $this->Cell(31,6,'VALOR NETO',1,1,'C', True);
    ################################# BLOQUE N° 4 ####################################### 

    ################################# BLOQUE N° 5 ####################################### 
    $tra = new Login();
    $detalle = $tra->VerDetallesCompras();
    $cantidad = 0;
    $SubTotal = 0;

     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,20,15,60,27,15,14,25,28,15,31));
    //verifica

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++){ 
    $cantidad += $detalle[$i]['cantcompra'];
    $valortotal = $detalle[$i]["preciocomprac"]*$detalle[$i]["cantcompra"];
    $SubTotal += $detalle[$i]['valorneto'];

    $this->SetX(10);
    $this->SetFont('Courier','',9);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->SetFillColor(255, 255, 255); // establece el color del fondo de la celda (en este caso es BLANCO)
    $this->RowFactureCompra(array($a++,
        utf8_decode($detalle[$i]["codproducto"]),
        utf8_decode($detalle[$i]["lotec"]),
        portales(utf8_decode($detalle[$i]["producto"])),
        utf8_decode($detalle[$i]['tipo'] == 1 ? $detalle[$i]['nomcategoria'] : $detalle[$i]['nommedida']),
        utf8_decode(number_format($detalle[$i]["cantcompra"], 2, '.', '.')),
        utf8_decode($detalle[$i]["ivaproductoc"] != '0' ? number_format($detalle[$i]["ivaproductoc"], 0, '.', '.')."%" : "(E)"),
        utf8_decode($simbolo.number_format($detalle[$i]['preciocomprac'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($detalle[$i]['valortotal'], 0, '.', '.')),
        utf8_decode(number_format($detalle[$i]['descfactura'], 0, '.', '.')."%"),
        utf8_decode($simbolo.number_format($detalle[$i]['valorneto'], 0, '.', '.'))));
    }
    ################################# BLOQUE N° 5 ####################################### 

    ########################### BLOQUE N° 6 #############################
    $this->Ln();
    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',14);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(170,5,'INFORMACIÓN ADICIONAL',1,0,'C', True);
    $this->Cell(5,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(40,5,'SUBTOTAL ',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["subtotalivasic"]+$reg[0]["subtotalivanoc"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(170,5,'CANTIDAD DE PRODUCTOS: '.number_format($cantidad, 2, '.', '.'),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'GRAVADO ('.number_format($reg[0]["ivac"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["subtotalivasic"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(170,5,'TIPO DE DOCUMENTO: FACTURA',1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'EXENTO (0%):',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["subtotalivanoc"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    if($reg[0]['fechavencecredito'] == '0000-00-00' || $reg[0]['fechavencecredito'] >= date("Y-m-d")) {
    $estado = $reg[0]['statuscompra'];
    $dias_vencidos = "0";
    } elseif($reg[0]['fechavencecredito'] < date("Y-m-d")) { 
    $estado = "VENCIDA";
    $dias_vencidos = Dias_Transcurridos(date("Y-m-d"),$reg[0]['fechavencecredito']);
    }

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(170,5,'TIPO DE PAGO: '.utf8_decode($reg[0]['tipocompra'])." ".$vencimiento = ($reg[0]['tipocompra'] == "CREDITO" ? " | FECHA VENCIMIENTO: ".date("d-m-Y",strtotime($reg[0]['fechavencecredito'])) : "")." ".$dias = ($reg[0]['tipocompra'] == "CREDITO" ? " | DIAS VENCIDOS: ".$dias_vencidos : ""),1,0,'L');

    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(40,5,$impuesto == '' ? "IMPUESTO" : "".$impuesto." (".number_format($reg[0]["ivac"], 0, '.', '.')."%):",1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["totalivac"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(170,5,'FORMA DE PAGO: '.utf8_decode($variable = ($reg[0]['tipocompra'] == 'CONTADO' ? $reg[0]['formacompra'] : $reg[0]['formacompra'])),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'DESCONTADO %:',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["descontadoc"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)

    $this->CellFitSpace(170,5,'ESTADO: '.utf8_decode($estado),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'DESC % ('.number_format($reg[0]["descuentoc"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["totaldescuentoc"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(170,5,'HORA DE EMISIÓN: '.date("H:i:s"),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->Cell(40,5,'IMPORTE TOTAL:',1,0,'L', True);
    $this->CellFitSpace(45,5,$simbolo.number_format($reg[0]["totalpagoc"], 0, '.', '.'),1,0,'R');
    $this->Ln(6);

    if($reg[0]['observaciones'] != ''){
    //Linea de membrete Nro 4
    $this->SetFont('courier','B',10);
    $this->MultiCell(330,5,$this->SetFont('Courier','B',10).'OBSERVACIONES: '.utf8_decode($reg[0]['observaciones'] == '' ? "**********" : $reg[0]['observaciones']),0,'J');
    }
    ################################# BLOQUE N° 6 ####################################### 
}
########################## FUNCION FACTURA COMPRA ##############################

########################## FUNCION LISTAR COMPRAS ##############################
function TablaListarCompras()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarCompras();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE COMPRAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COMPRA',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN DE PROVEEDOR',1,0,'C', True);
    $this->Cell(35,8,'EMISIÓN',1,0,'C', True);
    $this->Cell(35,8,'Nº ARTIC.',1,0,'C', True);
    $this->Cell(40,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESC %',1,0,'C', True);
    $this->Cell(45,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,70,35,35,40,30,30,45));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 

    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'];
    $TotalIva+=$reg[$i]['totalivac'];
    $TotalDescuento+=$reg[$i]['totaldescuentoc'];
    $TotalImporte+=$reg[$i]['totalpagoc'];
 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomproveedor"])),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaemision']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalivac'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuentoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpagoc'], 0, '.', '.'))));
   }
   
    $this->Cell(155,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();

    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMPRAS ##############################

########################## FUNCION LISTAR CUENTAS POR PAGAR #########################
function TablaListarCuentasxPagar()
{
    $tra = new Login();
    $reg = $tra->ListarCuentasxPagar();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE CUENTAS POR PAGAR',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    } 

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COMPRA',1,0,'C', True);
    $this->Cell(85,8,'DESCRIPCIÓN DE PROVEEDOR',1,0,'C', True);
    $this->Cell(35,8,'ESTADO',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCE',1,0,'C', True);
    $this->Cell(40,8,'EMISIÓN',1,0,'C', True);
    $this->Cell(35,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(50,8,'TOTAL IMPORTE',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,85,35,40,40,35,50));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalImporte+=$reg[$i]['totalpagoc'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomproveedor"])),utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statuscompra'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statuscompra"]),utf8_decode($reg[$i]['fechavencecredito'] == '0000-00-00' ? "*********" : date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaemision']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpagoc'], 0, '.', '.'))));
   }
   
    $this->Cell(250,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(50,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CUENTAS POR PAGAR #########################

########################## FUNCION LISTAR CUENTAS POR PAGAR VENCIDAS #########################
function TablaListarCuentasxPagarVencidas()
{
    $tra = new Login();
    $reg = $tra->ListarCuentasxPagarVencidas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE CUENTAS POR PAGAR VENCIDAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    } 

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COMPRA',1,0,'C', True);
    $this->Cell(85,8,'DESCRIPCIÓN DE PROVEEDOR',1,0,'C', True);
    $this->Cell(35,8,'ESTADO',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCE',1,0,'C', True);
    $this->Cell(40,8,'EMISIÓN',1,0,'C', True);
    $this->Cell(35,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(50,8,'TOTAL IMPORTE',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,85,35,40,40,35,50));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalImporte+=$reg[$i]['totalpagoc'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomproveedor"])),utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statuscompra'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statuscompra"]),utf8_decode($reg[$i]['fechavencecredito'] == '0000-00-00' ? "*********" : date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaemision']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpagoc'], 0, '.', '.'))));
   }
   
    $this->Cell(250,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(50,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CUENTAS POR PAGAR VENCIDAS #########################

####################### FUNCION LISTAR COMPRAS POR FECHAS #########################
function TablaListarComprasxFechas()
   {

    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarComprasxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE COMPRAS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(13,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE COMPRA',1,0,'C', True);
    $this->Cell(60,8,'DESCRIPCIÓN DE PROVEEDOR',1,0,'C', True);
    $this->Cell(24,8,'ESTADO',1,0,'C', True);
    $this->Cell(30,8,'FECHA VENCE',1,0,'C', True);
    $this->Cell(24,8,'EMISIÓN',1,0,'C', True);
    $this->Cell(30,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(13,30,60,24,30,24,30,35,25,30,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 

    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'];
    $TotalIva+=$reg[$i]['totalivac'];
    $TotalDescuento+=$reg[$i]['totaldescuentoc'];
    $TotalImporte+=$reg[$i]['totalpagoc'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomproveedor"])),utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statuscompra'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statuscompra"]),utf8_decode($reg[$i]['fechavencecredito'] == '0000-00-00' ? "*********" : date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaemision']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalivac'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuentoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpagoc'], 0, '.', '.'))));
   }
   
    $this->Cell(180,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COMPRAS POR FECHAS #########################

####################### FUNCION LISTAR COMPRAS POR PROVEEDORES ########################
function TablaListarComprasxProveedor()
   {
    
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarComprasxProveedor();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL ################################# 

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE COMPRAS POR PROVEEDOR',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"Nº DE ".utf8_decode($documento = ($reg[0]['documproveedor'] == '0' ? "DOCUMENTO" : $reg[0]['documento']).": ".$reg[0]["cuitproveedor"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"PROVEEDOR: ".portales(utf8_decode($reg[0]["nomproveedor"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"Nº DE TELÉFONO: ".utf8_decode($reg[0]["tlfproveedor"]),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(13,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COMPRA',1,0,'C', True);
    $this->Cell(35,8,'ESTADO',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCE',1,0,'C', True);
    $this->Cell(30,8,'EMISIÓN',1,0,'C', True);
    $this->Cell(30,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(45,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESC %',1,0,'C', True);
    $this->Cell(45,8,'TOTAL IMPORTE',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(13,35,35,40,30,30,45,30,30,45));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 

    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'];
    $TotalIva+=$reg[$i]['totalivac'];
    $TotalDescuento+=$reg[$i]['totaldescuentoc'];
    $TotalImporte+=$reg[$i]['totalpagoc'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statuscompra'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statuscompra"]),utf8_decode($reg[$i]['fechavencecredito'] == '0000-00-00' ? "*********" : date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaemision']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasic']+$reg[$i]['subtotalivanoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalivac'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuentoc'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpagoc'], 0, '.', '.'))));
   }
   
    $this->Cell(153,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
####################### FUNCION LISTAR COMPRAS POR PROVEEDORES #########################

############################### REPORTES DE COMPRAS #################################


































############################### REPORTES DE TRASPASOS ################################

########################## FUNCION FACTURA TRASPASOS ##############################
function FacturaTraspaso()
{     
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->TraspasosPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);

    //Logo
    if (isset($reg[0]['cuitsucursal'])) {
        if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

        $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
        $this->Image($logo, 15, 11, 60, 18, "PNG");

        } else {

        $logo = "fotos/logo_principal.png";                         
        $this->Image($logo, 15, 10, 60, 18, "PNG");  
        }                                      
    }

    ######################### BLOQUE N° 1 ######################### 
    //BLOQUE DE DATOS DE PRINCIPAL
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 10, 335, 20, '1.5', '');
    
    //Bloque de membrete principal
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(161, 13, 13, 13, '1.5', 'F');

    //Bloque de membrete principal
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(161, 13, 13, 13, '1.5', '');

    $this->SetFont('courier','B',16);
    $this->SetXY(164.5, 14);
    $this->Cell(20, 5, 'T', 0 , 0);
    $this->SetFont('courier','B',9);
    $this->SetXY(161, 19);
    $this->Cell(20, 5, 'Trasp.', 0, 0);
    
    $this->SetFont('courier','B',14);
    $this->SetXY(250, 14);
    $this->Cell(50, 5, 'N° DE TRASPASO ', 0, 0);
    $this->SetFont('courier','B',14);
    $this->SetXY(300, 14);
    $this->CellFitSpace(42, 5,utf8_decode($reg[0]['codfactura']), 0, 0, "R");
    
    $this->SetFont('courier','B',10);
    $this->SetXY(250, 19);
    $this->Cell(50, 5, 'FECHA DE EMISIÓN ', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(300, 19);
    $this->CellFitSpace(42, 5,utf8_decode(date("d-m-Y H:i:s",strtotime($reg[0]['fechatraspaso']))), 0, 0, "R");
    
    $this->SetFont('courier','B',10);
    $this->SetXY(250, 24);
    $this->Cell(50, 5, 'FECHA DE RECEPCIÓN ', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(300, 24);
    $this->CellFitSpace(42, 5,utf8_decode(date("d-m-Y H:i:s")), 0, 0, "R");
    ######################### BLOQUE N° 1 ######################### 

    ############################## BLOQUE N° 2 #####################################   
    //BLOQUE DE DATOS DE SUCURSAL QUE ENVIA
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 32, 335, 32, '1.5', '');

    //DATOS DE SUCURSAL LINEA 1
    $this->SetFont('courier','B',12);
    $this->SetXY(12, 33);
    $this->Cell(330, 5, 'DATOS DE SUCURSAL QUE ENVIA', 0, 0);
    //DATOS DE SUCURSAL LINEA 1

    //DATOS DE SUCURSAL LINEA 2
    $this->SetFont('courier','B',10);
    $this->SetXY(12, 38);
    $this->CellFitSpace(28, 5, 'Nº DE '.$documento = ($reg[0]['documsucursal'] == '0' ? "REG.:" : $reg[0]['documento'].":"), 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(40, 38);
    $this->CellFitSpace(30, 5,utf8_decode($reg[0]['cuitsucursal']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(70, 38);
    $this->Cell(30, 5, 'RAZÓN SOCIAL:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(100, 38);
    $this->CellFitSpace(60, 5,utf8_decode($reg[0]['nomsucursal']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(160, 38);
    $this->Cell(24, 5, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(184, 38);
    $this->CellFitSpace(106, 5,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])." ".$reg[0]['direcsucursal']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(290, 38);
    $this->Cell(22, 5, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(312, 38);
    $this->CellFitSpace(30, 5,utf8_decode($reg[0]['tlfsucursal']), 0, 0);
    //DATOS DE SUCURSAL LINEA 2

    //DATOS DE SUCURSAL LINEA 3
    $this->SetFont('courier','B',10);
    $this->SetXY(12, 43);
    $this->Cell(18, 5, 'EMAIL:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(30, 43);
    $this->CellFitSpace(80, 5,utf8_decode($reg[0]['correosucursal']), 0, 0);
    //DATOS DE SUCURSAL LINEA 3

    //DATOS DE SUCURSAL LINEA 4
    $this->SetFont('courier','B',10);
    $this->SetXY(110, 43);
    $this->Cell(30, 5, 'RESPONSABLE:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(140, 43);
    $this->CellFitSpace(90, 5,utf8_decode($reg[0]['nomencargado']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(230, 43);
    $this->CellFitSpace(26, 5,'Nº DE '.$documento = ($reg[0]['documencargado'] == '0' ? "DOC.:" : $reg[0]['documento2'].":"), 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(256, 43);
    $this->CellFitSpace(34, 5,utf8_decode($reg[0]['dniencargado']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(290, 43);
    $this->Cell(22, 5, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(312, 43);
    $this->CellFitSpace(30, 5,utf8_decode($tlf = ($reg[0]['tlfencargado'] == '' ? "******" : $reg[0]['tlfencargado'])), 0, 0);
    //DATOS DE SUCURSAL LINEA 4
    ################################# BLOQUE N° 2 #######################################  

    ################################# BLOQUE N° 3 #######################################   
    //BLOQUE DE DATOS DE SUCURSAL QUE RECIBE

    //DATOS DE SUCURSAL LINEA 5
    $this->SetFont('courier','B',12);
    $this->SetXY(12, 50);
    $this->Cell(330, 4, 'DATOS DE SUCURSAL QUE RECIBE', 0, 0);
    //DATOS DE SUCURSAL LINEA 5

    //DATOS DE SUCURSAL LINEA 6
    $this->SetFont('courier','B',10);
    $this->SetXY(12, 54);
    $this->CellFitSpace(28, 5, 'Nº DE '.$documento = ($reg[0]['documsucursal2'] == '0' ? "REG.:" : $reg[0]['documento3'].":"), 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(40, 54);
    $this->CellFitSpace(30, 5,utf8_decode($reg[0]['cuitsucursal2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(70, 54);
    $this->Cell(30, 5, 'RAZÓN SOCIAL:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(100, 54);
    $this->CellFitSpace(50, 5,utf8_decode($reg[0]['nomsucursal2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(150, 54);
    $this->Cell(24, 5, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(174, 54);
    $this->CellFitSpace(116, 5,utf8_decode($ciudad = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])." ".$comuna = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])." ".$reg[0]['direcsucursal2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(290, 54);
    $this->Cell(22, 5, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(312, 54);
    $this->CellFitSpace(30, 5,utf8_decode($reg[0]['tlfsucursal2']), 0, 0);
    //DATOS DE SUCURSAL LINEA 6

    //DATOS DE SUCURSAL LINEA 7
    $this->SetFont('courier','B',10);
    $this->SetXY(12, 59);
    $this->Cell(28, 5, 'EMAIL:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(30, 59);
    $this->CellFitSpace(80, 5,utf8_decode($reg[0]['correosucursal2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(110, 59);
    $this->Cell(30, 5, 'RESPONSABLE:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(140, 59);
    $this->CellFitSpace(90, 5,utf8_decode($reg[0]['nomencargado2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(230, 59);
    $this->CellFitSpace(26, 5,'Nº DE '.$documento = ($reg[0]['documencargado2'] == '0' ? "DOC.:" : $reg[0]['documento4'].":"), 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(256, 59);
    $this->CellFitSpace(34, 5,utf8_decode($reg[0]['dniencargado2']), 0, 0);

    $this->SetFont('courier','B',10);
    $this->SetXY(290, 59);
    $this->Cell(22, 5, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',10);
    $this->SetXY(312, 59);
    $this->CellFitSpace(30, 5,utf8_decode($tlf = ($reg[0]['tlfencargado2'] == '' ? "******" : $reg[0]['tlfencargado2'])), 0, 0);
    //DATOS DE SUCURSAL LINEA 7
    ################################# BLOQUE N° 3 #######################################   

    ################################# BLOQUE N° 4 #######################################   
    //Bloque Cuadro de Detalles de Productos
    $this->SetFont('courier','B',9);
    $this->SetXY(10, 66);
    $this->SetTextColor(3, 3, 3); // Establece el color del texto (en este caso es Negro)
    $this->SetFillColor(229, 229, 229); // establece el color del fondo de la celda (en este caso es GRIS)
    $this->Cell(10,8,'N°',1,0,'C', True);
    $this->Cell(30,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(25,8,'F.VCTO',1,0,'C', True);
    $this->Cell(76,8,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(45,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(15,8,'CANT',1,0,'C', True);
    $this->Cell(15,8,"IMP.",1,0,'C', True);
    $this->Cell(30,8,'PRECIO UNIT',1,0,'C', True);
    $this->Cell(34,8,'VALOR TOTAL',1,0,'C', True);
    $this->Cell(18,8,'DESC %',1,0,'C', True);
    $this->Cell(37,8,'VALOR NETO',1,1,'C', True);
    ################################# BLOQUE N° 4 ####################################### 

    ################################# BLOQUE N° 5 ####################################### 
    $new = new Login();
    $detalle = $new->VerDetallesTraspasos();
    $cantidad = 0;
    $SubTotal = 0;

    $this->SetWidths(array(10,30,25,76,45,15,15,30,34,18,37));

    $a=1;
    for($i=0;$i<sizeof($detalle);$i++){ 
    $cantidad += $detalle[$i]['cantidad'];
    $valortotal = $detalle[$i]["precioventa"]*$detalle[$i]["cantidad"];
    $SubTotal += $detalle[$i]['valorneto'];

    $this->SetX(10);
    $this->SetFont('Courier','',9);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->SetFillColor(255, 255, 255); // establece el color del fondo de la celda (en este caso es GRIS)
    $this->RowFacture(array($a++,
        utf8_decode($detalle[$i]["codproducto"]),
        utf8_decode($detalle[$i]["fechaexpiracion"] == '0000-00-00' ? "******" : $detalle[$i]["fechaexpiracion"]),
        portales(utf8_decode($detalle[$i]["producto"])),
        utf8_decode($detalle[$i]['tipo'] == 1 ? $detalle[$i]['nomcategoria'] : $detalle[$i]['nommedida']),
        utf8_decode($detalle[$i]["cantidad"]),
        utf8_decode($detalle[$i]["ivaproducto"] != '0' ? number_format($detalle[$i]["ivaproducto"], 0, '.', '.')."%" : "(E)"),
        utf8_decode($simbolo.number_format($detalle[$i]['precioventa'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($detalle[$i]['valortotal'], 0, '.', '.')),
        utf8_decode(number_format($detalle[$i]['descproducto'], 0, '.', '.')."%"),
        utf8_decode($simbolo.number_format($detalle[$i]['valorneto'], 0, '.', '.'))));
    }
    ################################# BLOQUE N° 5 ####################################### 

    ########################### BLOQUE N° 6 #############################
    $this->Ln();
    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',14);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(220,5,'INFORMACIÓN ADICIONAL',1,0,'C', True);
    $this->Cell(5,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(50,5,'SUBTOTAL ',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(220,5,'CANTIDAD DE PRODUCTOS: '.number_format($cantidad, 2, '.', '.'),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(50,5,'GRAVADO ('.number_format($reg[0]["iva"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["subtotalivasi"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(220,5,'TIPO DE DOCUMENTO: FACTURA',1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(50,5,'EXENTO (0%):',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["subtotalivano"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(220,5,'FECHA DE EMISIÓN: '.date("d-m-Y"),1,0,'L');

    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(50,5,$impuesto == '' ? "IMPUESTO" : "".$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%):",1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(220,5,'HORA DE EMISIÓN: '.date("H:i:s"),1,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(50,5,'DESCONTADO %:',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["descontado"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)

    $this->CellFitSpace(220,5,' ',0,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->CellFitSpace(50,5,'DESC % ('.number_format($reg[0]["descuento"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["totaldescuento"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(220,5,' ',0,0,'L');
    $this->Cell(5,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->Cell(50,5,'IMPORTE TOTAL:',1,0,'L', True);
    $this->CellFitSpace(60,5,$simbolo.number_format($reg[0]["totalpago"], 0, '.', '.'),1,0,'R');
    $this->Ln(6);

    if($reg[0]['observaciones'] != ''){
    //Linea de membrete Nro 4
    $this->SetFont('courier','B',10);
    $this->MultiCell(330,5,$this->SetFont('Courier','B',10).'OBSERVACIONES: '.utf8_decode($reg[0]['observaciones'] == '' ? "**********" : $reg[0]['observaciones']),0,'J');
    }
    ################################# BLOQUE N° 6 #######################################    
}
########################## FUNCION FACTURA TRASPASOS ##############################

########################## FUNCION LISTAR TRASPASOS ##############################
function TablaListarTraspasos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ListarTraspasos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE TRASPASOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TRASPASO',1,0,'C', True);
    $this->Cell(45,8,'SUCURSAL REMITENTE',1,0,'C', True);
    $this->Cell(45,8,'SUCURSAL DESTINATARIO',1,0,'C', True);
    $this->Cell(40,8,'FECHA DE EMISIÓN',1,0,'C', True);
    $this->Cell(30,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC%',1,0,'C', True);
    $this->Cell(40,8,'IMPORTE TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,45,45,40,30,35,25,25,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalImpuesto=0;
    $TotalDescuento=0;
    $TotalImporte=0;


    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);  
    
    $TotalArticulos+=$reg[$i]['sumarticulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalImpuesto+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago'];
 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomsucursal"])),portales(utf8_decode($reg[$i]["nomsucursal2"])),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechatraspaso']))),utf8_decode($reg[$i]["sumarticulos"]),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(180,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR TRASPASOS ##############################

########################## FUNCION LISTAR TRASPASOS POR FECHAS ##############################
function TablaListarTraspasosxFechas()
   {
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarTraspasosxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE TRASPASOS POR FECHAS',0,0,'C');

    $this->Ln();
    $this->Cell(335,6,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,0,'L');

    $this->Ln(10);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE TRASPASO',1,0,'C', True);
    $this->Cell(45,8,'SUCURSAL REMITENTE',1,0,'C', True);
    $this->Cell(45,8,'SUCURSAL DESTINATARIO',1,0,'C', True);
    $this->Cell(40,8,'FECHA DE EMISIÓN',1,0,'C', True);
    $this->Cell(30,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC%',1,0,'C', True);
    $this->Cell(40,8,'IMPORTE TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,45,45,40,30,35,25,25,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalImpuesto=0;
    $TotalDescuento=0;
    $TotalImporte=0;


    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    
    $TotalArticulos+=$reg[$i]['sumarticulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalImpuesto+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago'];
 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),portales(utf8_decode($reg[$i]["nomsucursal"])),portales(utf8_decode($reg[$i]["nomsucursal2"])),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechatraspaso']))),utf8_decode($reg[$i]["sumarticulos"]),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(180,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR TRASPASOS POR FECHAS ##############################

####################### FUNCION LISTAR DETALLES TRASPASOS POR FECHAS ###########################
function TablaListarDetallesTraspasosxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesTraspasosxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE DETALLES TRASPASOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(60,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(40,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'TRASPASO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,60,40,30,30,40,30,20,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } else {

        $Tipo="INGREDIENTE";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($reg[$i]['ivaproducto'] != '0' ? number_format($reg[$i]['ivaproducto'], 0, '.', '.')."%" : "(E)"),
        utf8_decode($simbolo.number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(205,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();  

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR DETALLES TRASPASOS POR FECHAS ##########################

####################### FUNCION LISTAR PRODUCTOS TRASPASOS POR SUCURSAL ###########################
function TablaListarDetallesTraspasosxSucursal()
   {
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesTraspasosxSucursal(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE DETALLES TRASPASOS POR SUCURSAL',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->SetFont('Courier','B',14);
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    ########################################## DATOS DE SUCURSAL ENVIA ##########################################
    $this->SetXY(10,62);
    $this->SetFont('Courier','B',14);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['nomsucursal'])." (ENVIA)", 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','B',14);
    $this->CellFitSpace(167,4,utf8_decode($reg[0]['nomsucursal2'])." (RECIBE)", 0, 1, 'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['nomencargado']), 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(167,4,utf8_decode($reg[0]['nomencargado2']), 0, 1, 'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['direcsucursal']), 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(167,4,utf8_decode($reg[0]['direcsucursal2']), 0, 1, 'R');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(10);
    $this->CellFitSpace(167,4,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])),0,0,'J');

    }

    if($reg[0]['id_ciudad2']!='0'){

    $this->SetX(176);
    $this->CellFitSpace(167,4,utf8_decode($ciudad = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])." ".$comuna = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])),0,1,'R');

    }

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['tlfsucursal']),0,0,'J');
    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(167,4,utf8_decode($reg[0]['tlfsucursal2']),0,1,'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,$reg[0]['documsucursal'] == '0' ? "" : $reg[0]['documento'].": ".utf8_decode($reg[0]['cuitsucursal']),0,0,'J');

    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(167,4,$reg[0]['documsucursal2'] == '0' ? "" : $reg[0]['documento3'].": ".utf8_decode($reg[0]['cuitsucursal2']),0,1,'R');
    ########################################## DATOS DE SUCURSAL ENVIA ##########################################

    } else {

    ########################################## DATOS DE SUCURSAL ENVIA ##########################################
    $this->SetXY(10,52);
    $this->SetFont('Courier','B',14);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['nomsucursal2'])." (RECIBE)", 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','B',14);
    $this->CellFitSpace(167,4,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])), 0, 1, 'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['nomencargado2']), 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','B',14);
    $this->CellFitSpace(167,4,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])), 0, 1, 'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['direcsucursal2']), 0, 0, 'J');

    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->Cell(167,4,"", 0, 1, 'R');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(10);
    $this->CellFitSpace(167,4,utf8_decode($ciudad = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])." ".$comuna = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])),0,0,'J');

    }

    if($reg[0]['id_ciudad2']!='0'){

    $this->SetX(176);
    $this->Cell(167,4,"",0,1,'R');

    }

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,utf8_decode($reg[0]['tlfsucursal2']),0,0,'J');
    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->Cell(167,4,"",0,1,'R');

    $this->SetX(10);
    $this->SetFont('Courier','',12);
    $this->CellFitSpace(168,4,$reg[0]['documsucursal2'] == '0' ? "" : $reg[0]['documento3'].": ".utf8_decode($reg[0]['cuitsucursal2']),0,0,'J');

    $this->SetX(176);
    $this->SetFont('Courier','',12);
    $this->Cell(167,4,"",0,1,'R');
    ########################################## DATOS DE SUCURSAL ENVIA ##########################################    

    }

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(60,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(40,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'TRASPASO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,60,40,30,30,40,30,20,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } else {

        $Tipo="INGREDIENTE";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($reg[$i]['ivaproducto'] != '0' ? number_format($reg[$i]['ivaproducto'], 0, '.', '.')."%" : "(E)"),
        utf8_decode($simbolo.number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
       }
    }
   
    $this->Cell(205,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();  
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR PRODUCTOS TRASPASOS POR SUCURSAL ##########################

############################### REPORTES DE TRASPASOS ##################################









































############################### REPORTES DE COTIZACIONES #############################

########################## FUNCION TICKET COTIZACION ##############################
function TicketCotizacion()
{       
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    
    $tra = new Login();
    $reg = $tra->CotizacionesPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);

    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE COTIZACIÓN", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direcsucursal'])),0,'C');

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['girosucursal'])),0,'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);
    
    if($reg[0]['codcliente'] == '0'){

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');   

    } else {

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direccliente'].$comuna = ($reg[0]['id_comuna'] == '0' ? "" : " ".$reg[0]['comuna'])."".$ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : " ".$reg[0]['ciudad']))),0,'L');

    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"Nro Ticket:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(18,4,"VENDEDOR:", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(52,4,portales(utf8_decode($reg[0]['nombres'])), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"FECHA: ".utf8_decode(date("d/m/Y",strtotime($reg[0]['fechacotizacion']))), 0, 0, 'J');
    $this->CellFitSpace(35,4,"HORA: ".utf8_decode(date("H:i:s",strtotime($reg[0]['fechacotizacion']))), 0, 0, 'R');
    $this->Ln();

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesCotizaciones();
    $cantidad = 0;
    $SubTotal = 0;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantcotizacion'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($detalle[$i]['cantcotizacion'], 2, '.', '.'))." X ".$simbolo.number_format($detalle[$i]["precioventa"], 0, '.', '.'),0,0,'J');

    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($detalle[$i]["valorneto"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','',8);
    $this->MultiCell(70,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['detallesobservaciones'] != ""){ 
    $this->SetX(2);
    $this->SetFont('Courier','B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesobservaciones'] == '' ? "" : "(".$detalle[$i]['detallesobservaciones'].")")),0,'J');
    }

    if($detalle[$i]['detallesalsas'] != ""){ 
    $this->SetX(2);
    $this->SetFont('Courier','B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesalsas'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['detallesalsas']).")")),0,'J');
    }

    endfor;

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(22,3,"DESCONTADO %",0,0,'L');
    $this->Cell(48,3,$simbolo.number_format($reg[0]['descontado'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(22,4,"SUBTOTAL",0,0,'L');
    $this->Cell(48,4,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(22,4,"DESC (".number_format($reg[0]["descuento"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(48,4,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(22,4,"TOTAL",0,0,'L');
    $this->Cell(48,4,$simbolo.number_format($reg[0]['totalpago'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetDrawColor(3,3,3);
    $this->SetFont('Courier','',7);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->MultiCell(70,4,utf8_decode(numtoletras(number_format($reg[0]['totalpago'], 2, '.', ''))),0,1,'');

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(2);  
    $this->SetX(2);
    $this->SetFont('courier','B',8);
    $this->MultiCell(70,4,utf8_decode($reg[0]['observaciones']),0,1,'');
    $this->Ln(2);
    ########################### OBSERVACIONES #############################    
    }

    $this->Ln();
    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(30,3,"CANTIDAD TOTAL:",0,0,'L');
    $this->CellFitSpace(40,3,utf8_decode(number_format($Articulos, 0, '.', '.')),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['correosucursal'])),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(10,3,"TEL:",0,0,'L');
    $this->CellFitSpace(60,3,utf8_decode($reg[0]['tlfsucursal']),0,1,'L');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','BI',10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(70,3,"GRACIAS POR PREFERIRNOS",0,1,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET COTIZACION ##############################

########################## FUNCION FACTURA COTIZACION ##############################
function FacturaCotizacion()
{     
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->CotizacionesPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);

    //Logo
    if (isset($reg[0]['cuitsucursal'])) {
        if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

            $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
            $this->Image($logo, 15, 11, 40, 14, "PNG");

        } else {

            $logo = "fotos/logo_principal.png";                         
            $this->Image($logo, 15, 10, 4, 20, "PNG");  
       }                                      
    } 

    ############################# BLOQUE N° 1 FACTURA ###############################   
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 10, 190, 16, '1.5', '');
    
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(98, 12, 12, 12, '1.5', 'F');

    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(98, 12, 12, 12, '1.5', '');

    $this->SetFont('courier','B',16);
    $this->SetXY(101, 14);
    $this->Cell(20, 5, 'C', 0 , 0);
    $this->SetFont('courier','B',8);
    $this->SetXY(98, 19);
    $this->Cell(20, 5, 'Cotiz.', 0, 0);
    
    $this->SetFont('courier','B',11);
    $this->SetXY(120, 12);
    $this->Cell(40, 4, 'N° DE COTIZACIÓN ', 0, 0);
    $this->SetFont('courier','B',11);
    $this->SetXY(160, 12);
    $this->CellFitSpace(38, 4,utf8_decode($reg[0]['codfactura']), 0, 0, "R");

    $this->SetFont('courier','B',9);
    $this->SetXY(120, 16);
    $this->Cell(40, 4, 'FECHA DE COTIZACIÓN ', 0, 0);
    $this->SetFont('courier','',9);
    $this->SetXY(160, 16);
    $this->CellFitSpace(38, 4,utf8_decode(date("d-m-Y",strtotime($reg[0]['fechacotizacion']))), 0, 0, "R");

    $this->SetFont('courier','B',9);
    $this->SetXY(120, 20);
    $this->Cell(40, 4, 'FECHA DE EMISIÓN', 0, 0);
    $this->SetFont('courier','',9);
    $this->SetXY(160, 20);
    $this->CellFitSpace(38, 4,utf8_decode(date("d-m-Y H:i:s")), 0, 0, "R");
    ################################# BLOQUE N° 1 FACTURA ################################ 

    ############################# BLOQUE N° 2 SUCURSAL ###############################   
   //Bloque de datos de empresa
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 27, 190, 18, '1.5', '');
    //DATOS DE SUCURSAL LINEA 1
    $this->SetFont('courier','B',9);
    $this->SetXY(12, 28);
    $this->Cell(186, 4, 'DATOS DE SUCURSAL ', 0, 0);
    //DATOS DE SUCURSAL LINEA 1

    //DATOS DE SUCURSAL LINEA 2
    $this->SetFont('courier','B',8);
    $this->SetXY(12, 32);
    $this->Cell(24, 4, 'RAZÓN SOCIAL:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(36, 32);
    $this->CellFitSpace(66, 4,utf8_decode($reg[0]['nomsucursal']), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(102, 32);
    $this->CellFitSpace(22, 4, 'Nº DE '.$documento = ($reg[0]['documsucursal'] == '0' ? "REG.:" : $reg[0]['documento'].":"), 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(124, 32);
    $this->CellFitSpace(28, 4,utf8_decode($reg[0]['cuitsucursal']), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(152, 32);
    $this->Cell(18, 4, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(170, 32);
    $this->Cell(28, 4,utf8_decode($reg[0]['tlfsucursal']), 0, 0);
    //DATOS DE SUCURSAL LINEA 2

    //DATOS DE SUCURSAL LINEA 3
    $this->SetFont('courier','B',8);
    $this->SetXY(12, 36);
    $this->Cell(24, 4, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(36, 36);
    $this->CellFitSpace(96, 4,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])." ".$reg[0]['direcsucursal']), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(132, 36);
    $this->Cell(12, 4, 'EMAIL:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(144, 36);
    $this->Cell(54, 4,utf8_decode($reg[0]['correosucursal']), 0, 0);
    //DATOS DE SUCURSAL LINEA 3

    //DATOS DE SUCURSAL LINEA 4
    $this->SetFont('courier','B',8);
    $this->SetXY(12, 40);
    $this->Cell(24, 4, 'RESPONSABLE:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(36, 40);
    $this->CellFitSpace(66, 4,utf8_decode($reg[0]['nomencargado']), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(102, 40);
    $this->CellFitSpace(22, 4, 'Nº DE '.$documento = ($reg[0]['documencargado'] == '0' ? "DOC.:" : $reg[0]['documento2'].":"), 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(124, 40);
    $this->CellFitSpace(28, 4,utf8_decode($reg[0]['dniencargado']), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(152, 40);
    $this->Cell(18, 4, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(170, 40);
    $this->Cell(28, 4,utf8_decode($tlf = ($reg[0]['tlfencargado'] == '' ? "" : $reg[0]['tlfencargado'])), 0, 0);
    //DATOS DE SUCURSAL LINEA 4
    ############################ BLOQUE N° 2 SUCURSAL ###############################   


    ############################## BLOQUE N° 3 CLIENTE #################################  
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.1);
    $this->RoundedRect(10, 46, 190, 14, '1.5', '');

    $this->SetFont('courier','B',9);
    $this->SetXY(12, 47);
    $this->Cell(186, 4, 'DATOS DE CLIENTE ', 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(12, 51);
    $this->Cell(20, 4, 'NOMBRES:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(32, 51);
    $this->CellFitSpace(58, 4,utf8_decode($nombre = ($reg[0]['nomcliente'] == '' ? "CONSUMIDOR FINAL" : $reg[0]['nomcliente'])), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(90, 51);
    $this->CellFitSpace(20, 4, 'Nº DE '.$documento = ($reg[0]['documcliente'] == '0' ? "DOC.:" : $reg[0]['documento3'].":"), 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(110, 51);
    $this->CellFitSpace(24, 4,utf8_decode($nombre = ($reg[0]['dnicliente'] == '' ? "*********" : $reg[0]['dnicliente'])), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(134, 51);
    $this->Cell(12, 4, 'EMAIL:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(146, 51);
    $this->CellFitSpace(52, 4,utf8_decode($email = ($reg[0]['emailcliente'] == '' ? "*********" : $reg[0]['emailcliente'])), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(12, 55);
    $this->Cell(20, 4, 'DIRECCIÓN:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(32, 55);
    $this->CellFitSpace(124, 4,getSubString(utf8_decode($ciudad = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])." ".$comuna = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])." ".$reg[0]['direccliente']), 70), 0, 0);

    $this->SetFont('courier','B',8);
    $this->SetXY(156, 55);
    $this->Cell(20, 4, 'N° DE TLF:', 0, 0);
    $this->SetFont('courier','',8);
    $this->SetXY(176, 55);
    $this->CellFitSpace(22, 4,utf8_decode($tlf = ($reg[0]['tlfcliente'] == '' ? "*********" : $reg[0]['tlfcliente'])), 0, 0); 
    ############################## BLOQUE N° 3 CLIENTE ################################# 

    ################################# BLOQUE N° 4 #######################################   
    $this->SetFont('courier','B',9);
    $this->SetXY(10, 61);
    $this->SetTextColor(3,3,3);
    $this->SetFillColor(229, 229, 229); // establece el color del fondo de la celda (en este caso es GRIS)
    $this->Cell(8, 8,"Nº", 1, 0, 'C', True);
    $this->Cell(66, 8,"DESCRIPCIÓN DE PRODUCTO", 1, 0, 'C', True);
    $this->Cell(10, 8,"CANT", 1, 0, 'C', True);
    $this->Cell(25, 8,"P/UNIT", 1, 0, 'C', True);
    $this->Cell(25, 8,"V/TOTAL", 1, 0, 'C', True);
    $this->Cell(15, 8,"DESC %", 1, 0, 'C', True);
    $this->Cell(16, 8,$impuesto, 1, 0, 'C', True);
    $this->Cell(25, 8,"V/NETO", 1, 1, 'C', True);
    ################################# BLOQUE N° 4 #######################################  

    ################################# BLOQUE N° 5 ####################################### 
    $tra = new Login();
    $detalle = $tra->VerDetallesCotizaciones();
    $cantidad = 0;
    $SubTotal = 0;

     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(8,66,10,25,25,15,16,25));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++){ 
    $cantidad += $detalle[$i]['cantcotizacion'];
    $valortotal = $detalle[$i]["precioventa"]*$detalle[$i]["cantcotizacion"];
    $SubTotal += $detalle[$i]['valorneto'];

    $this->SetX(10);
    $this->SetFont('Courier','',7);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->SetFillColor(255, 255, 255); // establece el color del fondo de la celda (en este caso es GRIS)
    $this->RowFacture2(array($a++,
        portales(utf8_decode($detalle[$i]["producto"].$observacion = ($detalle[$i]['detallesobservaciones'] == '' ? "" : "(".$detalle[$i]['detallesobservaciones'].")").$salsas = ($detalle[$i]['detallesalsas'] == '' ? "" : "(".$detalle[$i]['detallesalsas'].")"))),
        utf8_decode($detalle[$i]["cantcotizacion"]),
        utf8_decode($simbolo.number_format($detalle[$i]['precioventa'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($detalle[$i]['valortotal'], 0, '.', '.')),
        utf8_decode(number_format($detalle[$i]['descproducto'], 0, '.', '.')),
        utf8_decode($detalle[$i]["ivaproducto"] != "0" ? number_format($detalle[$i]["ivaproducto"], 0, '.', '.') : "(E)"),
        utf8_decode($simbolo.number_format($detalle[$i]['valorneto'], 0, '.', '.'))));
    }
    ################################# BLOQUE N° 5 #######################################  

    ########################### BLOQUE N° 6 #############################
    $this->Ln();
    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'INFORMACIÓN ADICIONAL',1,0,'C', True);
    $this->Cell(2,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(40,5,'DESCONTADO %:',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["descontado"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'CANTIDAD DE PRODUCTOS: '.number_format($cantidad, 2, '.', '.'),1,0,'L');
    $this->Cell(2,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(40,5,'SUBTOTAL ',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'TIPO DE DOCUMENTO: FACTURA',1,0,'L');
    $this->Cell(2,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'GRAVADO ('.number_format($reg[0]["iva"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["subtotalivasi"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'REALIZADO: '.utf8_decode($reg[0]['nombres']),1,0,'L');

    $this->Cell(2,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'EXENTO (0%):',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["subtotalivano"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'FECHA DE EMISIÓN: '.date("d-m-Y"),1,0,'L');
    $this->Cell(2,5,"",0,0,'C');
    $this->CellFitSpace(40,5,$impuesto == '' ? "IMPUESTO" : "".$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%):",1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(108,5,'HORA DE EMISIÓN: '.date("H:i:s"),1,0,'L');
    $this->Cell(2,5,"",0,0,'C');
    $this->CellFitSpace(40,5,'DESC % ('.number_format($reg[0]["descuento"], 0, '.', '.').'%):',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["totaldescuento"], 0, '.', '.'),1,0,'R');
    $this->Ln();

    $this->SetFillColor(245,245,245); // establece el color del fondo de la celda (en este caso es AZUL
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->Cell(108,5,'',0,0,'L');
    $this->Cell(2,5,"",0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->Cell(40,5,'IMPORTE TOTAL:',1,0,'L', True);
    $this->CellFitSpace(40,5,$simbolo.number_format($reg[0]["totalpago"], 0, '.', '.'),1,0,'R');
    $this->Ln(6);

    if($reg[0]['observaciones'] != ''){
    //Linea de membrete Nro 4
    $this->SetFont('courier','B',10);
    $this->MultiCell(190,5,$this->SetFont('Courier','',10).'OBSERVACIONES ENVIA: '.utf8_decode($reg[0]['observaciones'] == '' ? "**********" : $reg[0]['observaciones']),1,'J');
    }
    ########################### BLOQUE N° 6 #############################
}
########################## FUNCION FACTURA COTIZACION ##############################

########################## FUNCION LISTAR COTIZACIONES ##############################
function TablaListarCotizaciones()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarCotizaciones();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE COTIZACIONES',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    } 

    $this->Ln(10);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COTIZACIÓN',1,0,'C', True);
    $this->Cell(55,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(40,8,'OBSERVACIONES',1,0,'C', True);
    $this->Cell(45,8,'FECHA DE EMISIÓN',1,0,'C', True);
    $this->Cell(25,8,'Nº ARTIC.',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'IMPORTE TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,55,40,45,25,35,30,20,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]['observaciones'] == '' ? "***********" : $reg[$i]['observaciones']),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechacotizacion']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(190,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COTIZACIONES ##############################

####################### FUNCION LISTAR COTIZACIONES POR FECHAS ########################
function TablaListarCotizacionesxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarCotizacionesxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE COTIZACIONES POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L'); 

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE COTIZACIÓN',1,0,'C', True);
    $this->Cell(50,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(40,8,'OBSERVACIONES',1,0,'C', True);
    $this->Cell(45,8,'FECHA DE EMISIÓN',1,0,'C', True);
    $this->Cell(25,8,'Nº ARTIC.',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'IMPORTE TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,50,40,45,25,35,30,20,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]['observaciones'] == '' ? "***********" : $reg[$i]['observaciones']),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechacotizacion']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(185,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR COTIZACIONES POR FECHAS ######################

####################### FUNCION LISTAR DETALLES COTIZACIONES POR FECHAS ###########################
function TablaListarDetallesCotizacionesxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesCotizacionesxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE DETALLES COTIZACIONES POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'COTIZADO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,70,30,40,30,20,30,30,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";
        $Existencia=$reg[$i]['cantcombo'];
        $ExisteTotal+=$reg[$i]['cantcombo'];

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
  }
   }
   
    $this->Cell(145,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR DETALLES COTIZACIONES POR FECHAS ##########################

####################### FUNCION LISTAR PRODUCTOS COTIZADOS POR VENDEDOR ###########################
function TablaListarDetallesCotizacionesxVendedor()
   {
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesCotizacionesxVendedor(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE DETALLES COTIZACIONES POR VENDEDOR',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"VENDEDOR: ".portales(utf8_decode($reg[0]['nombres'])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'COTIZADO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,70,30,40,30,20,30,30,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";
        $Existencia=$reg[$i]['cantcombo'];
        $ExisteTotal+=$reg[$i]['cantcombo'];

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
  }
   }
   
    $this->Cell(145,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR PRODUCTOS COTIZADOS POR VENDEDOR ##########################

########################### REPORTES DE COTIZACIONES ############################







































########################### REPORTES DE CAJAS DE VENTAS ##############################

########################## FUNCION LISTAR CAJAS ASIGNADAS ##############################
function TablaListarCajas()
{
    $tra = new Login();
    $reg = $tra->ListarCajas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE CAJAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE CAJA',1,0,'C', True);
    $this->Cell(55,8,'NOMBRE DE CAJA',1,0,'C', True);
    $this->Cell(90,8,'RESPONSABLE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,35,55,90));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){ 
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["nrocaja"]),utf8_decode($reg[$i]['nomcaja']),utf8_decode($reg[$i]["nombres"])));

      }
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CAJAS ASIGNADAS ##############################

########################## FUNCION TICKET CIERRE ARQUEO ##############################
function TicketCierre()
{  
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->ArqueoCajaPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }
  
    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE CIERRE", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,utf8_decode($reg[0]['nomsucursal']), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])),0,1,'C');

    }

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direcsucursal'])),0,'C');

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['girosucursal'])),0,'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(20,3,"CAJA Nº:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(50,3,utf8_decode($reg[0]['nrocaja']."-".$reg[0]['nomcaja']),0,1,'L');
    
    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(20,3,"CAJERO:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(50,3,utf8_decode($reg[0]['nombres']),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"FECHA EMISIÓN:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,date("d-m-Y H:i:s"),0,1,'L');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"HORA APERTURA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode(date("d-m-Y H:i:s",strtotime($reg[0]['fechaapertura']))),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"HORA CIERRE:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode(date("d-m-Y H:i:s",strtotime($reg[0]['fechacierre']))),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"MONTO APERTURA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode($simbolo.number_format($reg[0]["montoinicial"], 0, '.', '.')),0,1,'L');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,3,"TIPOS DOCUMENTOS",0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"CANT. TICKET:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode($reg[0]['nroticket']),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"CANT. BOLETA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode($reg[0]['nroboleta']),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"CANT. FACTURA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode($reg[0]['nrofactura']),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"CANT. N. CRÉDITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode($reg[0]["nronota"]),0,1,'R');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,3,"DESGLOSE EN VENTAS",0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["efectivo"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"CHEQUE:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["cheque"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TARJ. CRÉDITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["tcredito"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TARJ. DÉBITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["tdebito"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TARJ. PREPAGO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["tprepago"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TRANSFERENCIA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["transferencia"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"DIN. ELECTRÓNICO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["electronico"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"CUPÓN:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["cupon"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["otros"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"CRÉDITOS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["creditos"], 0, '.', '.')),0,1,'R');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,3,"PROPINAS",0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinasefectivo"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS CHEQUE:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinascheque"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS TARJ. CRÉDITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinastcredito"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS TARJ. DÉBITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinastdebito"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS TARJ. PREPAGO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinastprepago"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS TRANSFERENCIA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinastransferencia"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS DIN. ELECTRÓNICO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinaselectronico"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS CUPÓN:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinascupon"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"PROPINAS OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["propinasotros"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"ABONO EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["abonosefectivo"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"ABONO OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["abonosotros"], 0, '.', '.')),0,1,'R');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,3,"MOVIMIENTOS EN CAJA",0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"INGRESO EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["ingresosefectivo"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"INGRESOS OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["ingresosotros"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"EGRESOS EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["egresos"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"NOTAS DE CRÉDITO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["egresonotas"], 0, '.', '.')),0,1,'R');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,3,"BALANCE EN CAJA",0,1,'L');

    $TotalVentas = $reg[0]['efectivo']+$reg[0]['cheque']+$reg[0]['tcredito']+$reg[0]['tdebito']+$reg[0]['tprepago']+$reg[0]['transferencia']+$reg[0]['electronico']+$reg[0]['cupon']+$reg[0]['otros']+$reg[0]['creditos']+$reg[0]['propinasefectivo']+$reg[0]['propinascheque']+$reg[0]['propinastcredito']+$reg[0]['propinastdebito']+$reg[0]['propinastprepago']+$reg[0]['propinastransferencia']+$reg[0]['propinaselectronico']+$reg[0]['propinascupon']+$reg[0]['propinasotros'];

    $VentaOtros = $reg[0]['cheque']+$reg[0]['tcredito']+$reg[0]['tdebito']+$reg[0]['tprepago']+$reg[0]['transferencia']+$reg[0]['electronico']+$reg[0]['cupon']+$reg[0]['otros']+$reg[0]['creditos']+$reg[0]['propinascheque']+$reg[0]['propinastcredito']+$reg[0]['propinastdebito']+$reg[0]['propinastprepago']+$reg[0]['propinastransferencia']+$reg[0]['propinaselectronico']+$reg[0]['propinascupon']+$reg[0]['propinasotros'];

    $TotalEfectivo = $reg[0]['montoinicial']+$reg[0]['efectivo']+$reg[0]['propinasefectivo']+$reg[0]['ingresosefectivo']+$reg[0]['abonosefectivo']-$reg[0]['egresos'];


    $TotalOtros = $reg[0]['cheque']+$reg[0]['tcredito']+$reg[0]['tdebito']+$reg[0]['tprepago']+$reg[0]['transferencia']+$reg[0]['electronico']+$reg[0]['cupon']+$reg[0]['otros']+$reg[0]['creditos']+$reg[0]['abonosotros']+$reg[0]['propinascheque']+$reg[0]['propinastcredito']+$reg[0]['propinastdebito']+$reg[0]['propinastprepago']+$reg[0]['propinastransferencia']+$reg[0]['propinaselectronico']+$reg[0]['propinascupon']+$reg[0]['propinasotros']+$reg[0]['ingresosotros'];

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TOTAL EN VENTAS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($TotalVentas, 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"VENTAS EN EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]['efectivo']+$reg[0]['propinasefectivo'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"VENTAS OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($VentaOtros, 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TOTAL EN EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($TotalEfectivo, 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"TOTAL OTROS:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($TotalOtros, 0, '.', '.')),0,1,'R');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"EFECTIVO EN CAJA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["dineroefectivo"], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,"DIF. EFECTIVO:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(30,3,utf8_decode($simbolo.number_format($reg[0]["diferencia"], 0, '.', '.')),0,1,'R');


    if($reg[0]["comentarios"]==""){

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

   } else { 

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->MultiCell(70,4,$this->SetFont('Courier',"",7).utf8_decode($reg[0]["comentarios"]),0,'L');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

    }
 
    $this->SetFont('Courier','BI',9);
    $this->SetX(2);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(70,3,"GRACIAS POR SU ATENCIÓN",0,1,'C');
    $this->Ln(3);

    $this->AddPage();

    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }
  
    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "PRODUCTOS VENDIDOS", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,utf8_decode($reg[0]['nomsucursal']), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])),0,1,'C');

    }

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['direcsucursal']),0,1,'C');

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['correosucursal']),0,1,'C');

    $this->SetX(2);
    $this->CellFitSpace(70,3,"OBLIGADO A LLEVAR CONTABILIDAD: ".utf8_decode($reg[0]['llevacontabilidad']),0,1,'C');

    $this->SetX(2);
    $this->CellFitSpace(70,3,"AMBIENTE: PRODUCCIÓN",0,1,'C');
    
    $this->SetX(2);
    $this->CellFitSpace(70,3,"EMISIÓN: NORMAL",0,1,'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(20,3,"CAJA Nº:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(50,3,utf8_decode($reg[0]['nrocaja']."-".$reg[0]['nomcaja']),0,1,'L');
    
    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(20,3,"CAJERO:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(50,3,utf8_decode($reg[0]['nombres']),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN:",0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(40,3,date("d-m-Y H:i:s"),0,1,'L');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"HORA APERTURA:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode(date("d-m-Y H:i:s",strtotime($reg[0]['fechaapertura']))),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(30,3,"HORA CIERRE:",0,0,'L');
    $this->SetFont('Courier',"B",8);
    $this->CellFitSpace(40,3,utf8_decode(date("d-m-Y H:i:s",strtotime($reg[0]['fechacierre']))),0,1,'L');

    $this->SetFont('Courier','B',12);
    $this->SetX(2);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(6);

    $a=1;
    $cantidad = 0;
    $SubTotal = 0;
    $Articulos = 0;

    $tra = new Login();
    $detalle = $tra->DetallesProductosVendidosxCaja();
    if($detalle==""){
        echo "";      
    } else {
    
    for($i=0;$i<sizeof($detalle);$i++):
    $Descuento        = $detalle[$i]['descproducto']/100;
    $PrecioDescuento  = $detalle[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$detalle[$i]['cantidad'];
    $PrecioFinal      = $detalle[$i]['precioventa']-$PrecioDescuento;
    
    $SubTotal  += $detalle[$i]['cantidad']*$PrecioFinal;
    $Articulos += $detalle[$i]['cantidad'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','',9);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode(number_format($detalle[$i]['cantidad'], 2, '.', '.'))." X ".$simbolo.number_format($PrecioFinal, 0, '.', '.'),0,0,'J');

    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,$simbolo.number_format($detalle[$i]['cantidad']*$PrecioFinal, 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','',10);
    $this->MultiCell(70,4,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    endfor;
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','BI',10);
    $this->CellFitSpace(24,3,"SUBTOTAL",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($SubTotal, 0, '.', '.'),0,1,'R');    
}
########################## FUNCION TICKET CIERRE ARQUEO ##############################

########################## FUNCION LISTAR ARQUEOS DE CAJAS ##############################
function TablaListarArqueos()
{
    $tra = new Login();
    $reg = $tra->ListarArqueoCaja();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE ARQUEOS EN CAJAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(24,8,'Nº DE CAJA',1,0,'C', True);
    $this->Cell(24,8,'INICIO',1,0,'C', True);
    $this->Cell(23,8,'CIERRE',1,0,'C', True);
    $this->Cell(23,8,'INICIAL',1,0,'C', True);
    $this->Cell(34,8,'TOTAL VENTAS',1,0,'C', True);
    $this->Cell(28,8,'TOTAL EFECT.',1,0,'C', True);
    $this->Cell(28,8,'TOTAL OTROS',1,0,'C', True);
    $this->Cell(28,8,'OTROS EFECT.',1,0,'C', True);
    $this->Cell(22,8,'EGRESOS',1,0,'C', True);
    $this->Cell(33,8,'EFECT. ESTIMADO',1,0,'C', True);
    $this->Cell(33,8,'EFECT. EN CAJA',1,0,'C', True);
    $this->Cell(25,8,'DIFERENCIA',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,24,24,23,23,34,28,28,28,22,33,33,25));

    $TotalVentas = 0;
    $VentasEfectivo = 0;
    $VentasOtros = 0;
    $OtrosEfectivo = 0;
    $TotalCreditos = 0;
    $AbonosEfectivo = 0;
    $AbonosOtros = 0;
    $IngresosEfectivo = 0;
    $IngresosOtros = 0;
    $TotalEgresos = 0;
    $PropinasEfectivo = 0;
    $PropinasOtros = 0;
    $TotalEfectivo = 0;
    $TotalCaja = 0;
    $TotalDiferencia = 0;

    $a=1; 
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $TotalVentas += $reg[$i]['efectivo']+$reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinasefectivo']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];

    $VentasEfectivo += $reg[$i]['efectivo']+$reg[$i]['propinasefectivo'];

    $VentasOtros += $reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];

    $OtrosEfectivo += $reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo'];

    $TotalEfectivo += $reg[$i]['montoinicial']+$reg[$i]['efectivo']+$reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo']-$reg[$i]['egresos'];

    $TotalOtros = $reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['abonosotros']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros']+$reg[$i]['ingresosotros'];

    $TotalCreditos += $reg[$i]['creditos'];
    $AbonosEfectivo += $reg[$i]['abonosefectivo'];
    $AbonosOtros += $reg[$i]['abonosotros'];
    $IngresosEfectivo += $reg[$i]['ingresosefectivo'];
    $IngresosOtros += $reg[$i]['ingresosotros'];
    $TotalEgresos += $reg[$i]['egresos'];
    $PropinasEfectivo += $reg[$i]['propinasefectivo'];
    $PropinasOtros += $reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];
    $TotalCaja += $reg[$i]['dineroefectivo'];
    $TotalDiferencia += $reg[$i]['diferencia'];
        
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]['nrocaja'].": ".$reg[$i]['nomcaja']),
        utf8_decode( date("d-m-Y H:i:s",strtotime($reg[$i]['fechaapertura']))),
    utf8_decode($reg[$i]['fechacierre'] == '0000-00-00 00:00:00' ? "*********" : date("d-m-Y H:i:s",strtotime($reg[$i]['fechacierre']))),
        utf8_decode($simbolo.number_format($reg[$i]['montoinicial'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['efectivo']+$reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinasefectivo']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['efectivo']+$reg[$i]['propinasefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['egresos'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['montoinicial']+$reg[$i]['efectivo']+$reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo']-$reg[$i]['egresos'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['dineroefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['diferencia'], 0, '.', '.'))));
   }
   
    $this->Cell(104,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(34,5,utf8_decode($simbolo.number_format($TotalVentas, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($VentasEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($VentasOtros, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($OtrosEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(22,5,utf8_decode($simbolo.number_format($TotalEgresos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(33,5,utf8_decode($simbolo.number_format($TotalEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(33,5,utf8_decode($simbolo.number_format($TotalCaja, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDiferencia, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR ARQUEOS DE CAJAS ##############################

####################### FUNCION LISTAR ARQUEOS DE CAJAS POR FECHAS ######################
function TablaListarArqueosxFechas()
{
    $tra = new Login();
    $reg = $tra->BuscarArqueosxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE ARQUEOS POR CAJA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(24,8,'INICIO',1,0,'C', True);
    $this->Cell(24,8,'CIERRE',1,0,'C', True);
    $this->Cell(26,8,'INICIAL',1,0,'C', True);
    $this->Cell(36,8,'TOTAL VENTAS',1,0,'C', True);
    $this->Cell(28,8,'TOTAL EFECT.',1,0,'C', True);
    $this->Cell(28,8,'TOTAL OTROS',1,0,'C', True);
    $this->Cell(28,8,'OTROS EFECT.',1,0,'C', True);
    $this->Cell(26,8,'EGRESOS',1,0,'C', True);
    $this->Cell(36,8,'EFECT. ESTIMADO',1,0,'C', True);
    $this->Cell(36,8,'EFECT. EN CAJA',1,0,'C', True);
    $this->Cell(28,8,'DIFERENCIA',1,1,'C', True);
    
    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,24,24,26,36,28,28,28,26,36,36,28));

$TotalVentas = 0;
$VentasEfectivo = 0;
$VentasOtros = 0;
$OtrosEfectivo = 0;
$TotalCreditos = 0;
$AbonosEfectivo = 0;
$AbonosOtros = 0;
$IngresosEfectivo = 0;
$IngresosOtros = 0;
$TotalEgresos = 0;
$PropinasEfectivo = 0;
$PropinasOtros = 0;
$TotalEfectivo = 0;
$TotalCaja = 0;
$TotalDiferencia = 0;

$a=1; 
for($i=0;$i<sizeof($reg);$i++){
$simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

$TotalVentas += $reg[$i]['efectivo']+$reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinasefectivo']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];

$VentasEfectivo += $reg[$i]['efectivo']+$reg[$i]['propinasefectivo'];

$VentasOtros += $reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];

$OtrosEfectivo += $reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo'];

$TotalEfectivo += $reg[$i]['montoinicial']+$reg[$i]['efectivo']+$reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo']-$reg[$i]['egresos'];

$TotalOtros = $reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['abonosotros']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros']+$reg[$i]['ingresosotros'];

$TotalCreditos += $reg[$i]['creditos'];
$AbonosEfectivo += $reg[$i]['abonosefectivo'];
$AbonosOtros += $reg[$i]['abonosotros'];
$IngresosEfectivo += $reg[$i]['ingresosefectivo'];
$IngresosOtros += $reg[$i]['ingresosotros'];
$TotalEgresos += $reg[$i]['egresos'];
$PropinasEfectivo += $reg[$i]['propinasefectivo'];
$PropinasOtros += $reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'];
$TotalCaja += $reg[$i]['dineroefectivo'];
$TotalDiferencia += $reg[$i]['diferencia'];
        
    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode( date("d-m-Y H:i:s",strtotime($reg[$i]['fechaapertura']))),
    utf8_decode($reg[$i]['fechacierre'] == '0000-00-00 00:00:00' ? "*********" : date("d-m-Y H:i:s",strtotime($reg[$i]['fechacierre']))),
        utf8_decode($simbolo.number_format($reg[$i]['montoinicial'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['efectivo']+$reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinasefectivo']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['efectivo']+$reg[$i]['propinasefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['cheque']+$reg[$i]['tcredito']+$reg[$i]['tdebito']+$reg[$i]['tprepago']+$reg[$i]['transferencia']+$reg[$i]['electronico']+$reg[$i]['cupon']+$reg[$i]['otros']+$reg[$i]['creditos']+$reg[$i]['propinascheque']+$reg[$i]['propinastcredito']+$reg[$i]['propinastdebito']+$reg[$i]['propinastprepago']+$reg[$i]['propinastransferencia']+$reg[$i]['propinaselectronico']+$reg[$i]['propinascupon']+$reg[$i]['propinasotros'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['egresos'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['montoinicial']+$reg[$i]['efectivo']+$reg[$i]['ingresosefectivo']+$reg[$i]['abonosefectivo']+$reg[$i]['propinasefectivo']-$reg[$i]['egresos'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['dineroefectivo'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['diferencia'], 0, '.', '.'))));
   }
   
    $this->Cell(84,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(36,5,utf8_decode($simbolo.number_format($TotalVentas, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($VentasEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($VentasOtros, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($OtrosEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(26,5,utf8_decode($simbolo.number_format($TotalEgresos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(36,5,utf8_decode($simbolo.number_format($TotalEfectivo, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(36,5,utf8_decode($simbolo.number_format($TotalCaja, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($TotalDiferencia, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR ARQUEOS DE CAJAS POR FECHAS ######################

########################## FUNCION TICKET MOVIMIENTOS EN CAJA ##############################
function TicketMovimiento()
{  
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->MovimientosPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);

    //Logo
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {
       $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
       //$this->Image($logo , 20, 3, 35, 15, "PNG");
       $this->Image($logo , 14, 4, 50, 12, "PNG");
       $this->Ln(8);
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE MOVIMIENTO", 0, 0, 'C');
    $this->Ln(5);
  
    //######################### BLOQUE DATOS DE SUCURSAL #############################
    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_comuna']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($comuna = ($reg[0]['id_comuna'] == '0' ? " " : $reg[0]['comuna'])." ".$ciudad = ($reg[0]['id_ciudad'] == '0' ? " " : $reg[0]['ciudad'])),0,1,'C');
    }

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direcsucursal'])),0,'C');

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['girosucursal'])),0,'C');
    //######################### BLOQUE DATOS DE SUCURSAL #############################

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"Nro Ticket:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['numero']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(18,4,"CAJA:", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(52,4,portales(utf8_decode($reg[0]['nrocaja']."-".$reg[0]['nomcaja'])), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(18,4,"CAJERO:", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(52,4,portales(utf8_decode($reg[0]['nombres'])), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"FECHA: ".utf8_decode(date("d/m/Y",strtotime($reg[0]['fechamovimiento']))), 0, 0, 'J');
    $this->CellFitSpace(35,4,"HORA: ".utf8_decode(date("H:i:s",strtotime($reg[0]['fechamovimiento']))), 0, 0, 'R');
    $this->Ln();

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"TIPO:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['tipomovimiento']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"MONTO:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode($simbolo.number_format($reg[0]["montomovimiento"], 0, '.', '.')), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"MEDIO:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['mediomovimiento']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DESCRIPCIÓN DE MOVIMIENTO", 0, 0, 'L');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->MultiCell(70,3,$this->SetFont('Courier','',8).utf8_decode($reg[0]['descripcionmovimiento'] == "") ? "SIN OBSERVACIONES" : $reg[0]['descripcionmovimiento'],0,'J');
    $this->Ln();

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln();

    $this->SetFont('Courier','BI',9);
    $this->SetX(2);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(70,3,"MUCHAS GRACIAS",0,1,'C');
    $this->Ln(3);   
}
########################## FUNCION TICKET MOVIMIENTOS EN CAJA ##############################

####################### FUNCION LISTAR MOVIMIENTOS EN CAJA ##########################
function TablaListarMovimientos()
{
    $tra = new Login();
    $reg = $tra->ListarMovimientos();
    
    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'LISTADO GENERAL DE MOVIMIENTOS EN CAJA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(190,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(190,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(40,8,'Nº DE CAJA',1,0,'C', True);
    $this->Cell(20,8,'TIPO',1,0,'C', True);
    $this->Cell(55,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(35,8,'MEDIO',1,0,'C', True);
    $this->Cell(30,8,'MONTO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,40,20,55,35,30));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    $TotalImporte+=$reg[$i]['montomovimiento'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]['nrocaja'].": ".$reg[$i]['nomcaja']),utf8_decode($reg[$i]["tipomovimiento"]),utf8_decode($reg[$i]['descripcionmovimiento']),utf8_decode($reg[$i]["mediomovimiento"]),utf8_decode($simbolo.number_format($reg[$i]['montomovimiento'], 0, '.', '.'))));
   }

    $this->Cell(160,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR MOVIMIENTOS EN CAJAS #########################

##################### FUNCION LISTAR MOVIMIENTOS EN CAJA POR FECHAS #####################
function TablaListarMovimientosxFechas()
{
    $tra = new Login();
    $reg = $tra->BuscarMovimientosxFechas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,7,'LISTADO DE MOVIMIENTOS POR CAJA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(190,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(20,8,'TIPO',1,0,'C', True);
    $this->Cell(75,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(45,8,'MEDIO',1,0,'C', True);
    $this->Cell(40,8,'MONTO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,20,75,45,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    $TotalImporte+=$reg[$i]['montomovimiento'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipomovimiento"]),utf8_decode($reg[$i]['descripcionmovimiento']),utf8_decode($reg[$i]["mediomovimiento"]),utf8_decode($simbolo.number_format($reg[$i]['montomovimiento'], 0, '.', '.'))));
   }
}

    $this->Cell(150,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
##################### FUNCION LISTAR MOVIMIENTOS EN CAJAS POR FECHAS ###################

########################## FUNCION INFORME DE CAJAS POR FECHAS ##############################
function InformeCajasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $caja = new Login();
    $caja = $caja->CajasPorId();
    $simbolo = ($caja[0]['simbolo'] == "" ? "" : $caja[0]['simbolo']);

    $venta = new Login();
    $venta = $venta->SumarVentasCajasxFechas();

    $arqueo = new Login();
    $arqueo = $arqueo->SumarArqueosCajasxFechas();

    $balance = $venta[0]['totalventa']-$venta[0]['totaliva']+$arqueo[0]['totalingresos']+$arqueo[0]['totalabonos'];
    $ganancias = $balance-$arqueo[0]['totalegresos'];

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'INFORME DE CAJAS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($caja[0]['documento'])." SUCURSAL: ".utf8_decode($caja[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($caja[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($caja[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($caja[0]["nrocaja"].": ".$caja[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($caja[0]["nombres"]),0,1,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE VENTAS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($venta[0]['totalventa'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE INGRESOS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalingresos'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'ABONOS A CRÉDITOS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalabonos'], 0, '.', '.')),0,0,'R');
    $this->Ln();
   

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE GASTOS (EGRESOS)',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalegresos'], 0, '.', '.')),0,0,'R');
    $this->Ln();
  
    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE IMPUESTOS VENTAS '.$impuesto.' ('.$valor.'%)',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($venta[0]['totaliva'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'EFECTIVO EN CAJA SIN IVA ',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($ganancias, 0, '.', '.')),0,0,'R');
    $this->Ln();


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION INFORME DE CAJAS POR FECHAS ##############################

####################### FUNCION LISTAR GANANCIAS POR FECHAS ###########################
function TablaListarGananciasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);
    
    $ingresos = new Login();
    $detalle_ingreso = $ingresos->BuscarIngresosxFechas();
    
    $gastos = new Login();
    $detalle_gasto = $gastos->BuscarGastosxFechas(); 

    $ganancias = new Login();
    $reg = $ganancias->BuscarGananciasxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,"LISTADO DE DE GANANCIAS POR FECHAS",0,0,'C'); 

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    } 

    $this->Ln();
    $this->Cell(335,6,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,0,'L'); 

    $this->Ln(10);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'CÓDIGO',1,0,'C', True);
    $this->Cell(90,8,'DESCRIPCIÓN DE PRODUCTO',1,0,'C', True);
    $this->Cell(35,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(20,8,'DCTO %',1,0,'C', True);
    $this->Cell(30,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,'TOTAL VENTA',1,0,'C', True);
    $this->Cell(30,8,'TOTAL COMPRA',1,0,'C', True);
    $this->Cell(30,8,'GANANCIAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,90,35,20,30,20,30,30,30));

    $PrecioCompraTotal=0;
    $PrecioVentaTotal=0;
    $VendidosTotal=0;
    $CompraTotal=0;
    $VentaTotal=0;
    $TotalGanancia=0;
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioCompraTotal+=$reg[$i]['preciocompra'];
    $PrecioVentaTotal+=$reg[$i]['precioventa'];
    $VendidosTotal+=$reg[$i]['cantidad']; 

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    //CALCULO SUBTOTAL IMPUESTOS
    $ValorImpuesto = 1 + ($reg[$i]['ivaproducto']/100);
    $Discriminado = $reg[$i]['precioventa']/$ValorImpuesto;
    $SubtotalDiscriminado = $reg[$i]['precioventa'] - $Discriminado;
    $BaseDiscriminado = $SubtotalDiscriminado * $reg[$i]['cantidad'];
    $Subtotalimpuestos = number_format($BaseDiscriminado, 2, '.', '');

    $SumVenta = $PrecioFinal*$reg[$i]['cantidad']; 
    $SumCompra = $reg[$i]['preciocompra']*$reg[$i]['cantidad'];

    $CompraTotal+=$reg[$i]['preciocompra']*$reg[$i]['cantidad'];
    $VentaTotal+=$PrecioFinal*$reg[$i]['cantidad'];
    $TotalGanancia+=$SumVenta-$SumCompra;

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["codproducto"]),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode(number_format($reg[$i]['descproducto'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['cantidad'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumCompra, 0, '.', '.')),
        utf8_decode($simbolo.number_format($SumVenta-$SumCompra, 0, '.', '.'))));
        }
    }
   
    $this->Cell(220,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($VentaTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($CompraTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Cell(240,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(60,5,"INGRESOS ADICIONALES",0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($detalle_ingreso[0]['ingresos'], 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Cell(240,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(60,5,"GASTOS",0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($detalle_gasto[0]['gastos'], 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Cell(240,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(60,5,"TOTAL",0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalGanancia+$detalle_ingreso[0]['ingresos']-$detalle_gasto[0]['gastos'], 0, '.', '.')),0,0,'L');
    $this->Ln();
   
    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR GANANCIAS POR FECHAS ##########################

############################## REPORTES DE CAJAS DE VENTAS ##############################































################################### REPORTES DE PEDIDOS ##################################

########################## FUNCION LISTAR PEDIDOS ##############################
function TablaListarPedidos()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarPedidos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE PEDIDOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,75,25,20,45,20,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
   }
   
    $this->Cell(210,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS ##############################

########################## FUNCION LISTAR PEDIDOS POR BUSQUEDA ##############################
function TablaListarPedidosxBusqueda()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BusquedaPedidos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if($_GET['tipobusqueda'] == 1){
    $this->Cell(335,10,'LISTADO GENERAL DE PEDIDOS A CLIENTES',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 2){
    $this->Cell(335,10,'LISTADO DE PEDIDOS A CLIENTES POR BÚSQUEDA',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Cell(335,10,'LISTADO DE PEDIDOS A CLIENTES POR FECHAS',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){
        $this->Ln();
        $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
        $this->Ln();
        $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
        $this->Ln();
        $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 
    }

    if($_GET['tipobusqueda'] == 2){
    $this->Ln();
    $this->Cell(335,6,"BÚSQUEDA: ".mb_convert_encoding($_GET["search_criterio"], 'ISO-8859-1', 'UTF-8'),0,0,'L');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Ln();
    $this->Cell(335,6,"DESDE: ".date("d/m/Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"HASTA: ".date("d/m/Y", strtotime($_GET["hasta"])),0,0,'L');
    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,75,25,20,45,20,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
   }
   
    $this->Cell(210,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS POR BUSQUEDA ##############################

########################## FUNCION LISTAR PEDIDOS DIARIAS ##############################
function TablaListarPedidosDiarias()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarPedidosDiarias();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE PEDIDOS DIARIAS DEL (DIA '.date("d-m-Y").")",0,0,'C');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,75,25,20,45,20,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
   }
   
    $this->Cell(210,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS DIARIAS ##############################

########################## FUNCION LISTAR PEDIDOS POR CAJAS ##############################
function TablaListarPedidosxCajas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarPedidosxCajas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE PEDIDOS POR CAJA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,75,25,20,45,20,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(210,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS POR CAJAS ##############################

########################## FUNCION LISTAR PEDIDOS POR FECHAS ##############################
function TablaListarPedidosxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarPedidosxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE PEDIDOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,75,25,20,45,20,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(210,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS POR FECHAS ##############################

########################## FUNCION LISTAR PEDIDOS POR FECHAS DE ENTREGA ##############################
function TablaListarPedidosxFechasEntrega()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarPedidosxFechasEntrega(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################


    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE PEDIDOS POR FECHAS DE ENTREGA',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(55,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(30,8,'FECHA ENTREGA',1,0,'C', True);
    $this->Cell(30,8,'HORA EMISIÓN',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,25,55,25,20,30,30,30,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+= $reg[$i]['articulos'];
    $TotalImporte+= $reg[$i]['totalpago'];
    $TotalAbono+= $reg[$i]['creditopagado'];
    $TotalDebe+= ($reg[$i]['tipopago'] == 'CONTADO' ? "0" : $reg[$i]['totalpago']-$reg[$i]['creditopagado']);

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]["statuspedido"] == 0 ? "ENTREGADA" : "PENDIENTE"),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaentrega']))),
        utf8_decode(date("H:i:s",strtotime($reg[$i]['fechaentrega']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($reg[$i]['tipopago'] == 'CONTADO' ? $simbolo."0" : $simbolo.number_format($reg[$i]['totalpago']-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR PEDIDOS POR FECHAS DE ENTREGA ##############################

################################### REPORTES DE PEDIDOS ##################################






























########################## CLASE VENTAS DE PRODUCTOS ########################

########################## FUNCION TICKET GENERAL ##############################
function TicketGeneral()
{  
    $tra = new Login();
    $reg = $tra->PedidoPorId();
    $TipoLetra = "Courier";
  
    if(!empty($reg[0]['suma_cocina'])){
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }    
  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE COCINA", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoComanda();

    if (!empty($detalle)) {

        for($i=0;$i<sizeof($detalle);$i++){

        $this->SetX(2); 
        $this->SetFillColor(192);
        $this->SetDrawColor(3,3,3);
        $this->SetLineWidth(.2);
        $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

        $this->SetFont($TipoLetra,'B',8);
        $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
        $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

        if($detalle[$i]['observacionespedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
        }

        if($detalle[$i]['salsaspedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
        }

        }//fin de for
    }//fin de empty

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
    }

    $bar = new Login();
    $bar = $bar->PedidoPorId();

    //AQUI RELAIZO EL SALTO DE PAGINA
    if(!empty($reg[0]['suma_cocina']) && !empty($bar[0]['suma_bar'])){
    $this->AddPage();
    } 

    if(!empty($bar[0]['suma_bar'])){

    if (file_exists("fotos/sucursales/".$bar[0]['cuitsucursal'].".png")) {

    $logo = "./fotos/sucursales/".$bar[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }    
  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE BAR", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($bar[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($bar[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($bar[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($bar[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($bar[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($bar[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($bar[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($bar[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($bar[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($bar[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($bar[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoBar();

    if (!empty($detalle)) {

        for($i=0;$i<sizeof($detalle);$i++){

        $this->SetX(2); 
        $this->SetFillColor(192);
        $this->SetDrawColor(3,3,3);
        $this->SetLineWidth(.2);
        $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

        $this->SetFont($TipoLetra,'B',8);
        $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
        $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

        if($detalle[$i]['observacionespedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
        }

        if($detalle[$i]['salsaspedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
        }

        }//fin de for
    }//fin de empty

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
       
    }

    $reposteria = new Login();
    $reposteria = $reposteria->PedidoPorId();

    //AQUI RELAIZO EL SALTO DE PAGINA
    if(!empty($reg[0]['suma_cocina']) && !empty($bar[0]['suma_bar']) && !empty($reposteria[0]['suma_reposteria']) || !empty($bar[0]['suma_bar']) && !empty($reposteria[0]['suma_reposteria']) || !empty($reg[0]['suma_cocina']) && !empty($reposteria[0]['suma_reposteria'])){
    $this->AddPage();
    } 

    if(!empty($reposteria[0]['suma_reposteria'])){

    if (file_exists("fotos/sucursales/".$reposteria[0]['cuitsucursal'].".png")) {

    $logo = "./fotos/sucursales/".$reposteria[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }    
  

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE REPOSTERIA", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reposteria[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reposteria[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reposteria[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reposteria[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reposteria[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reposteria[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reposteria[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reposteria[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reposteria[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reposteria[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($reposteria[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoReposteria();

    if (!empty($detalle)) {

        for($i=0;$i<sizeof($detalle);$i++){

        $this->SetX(2); 
        $this->SetFillColor(192);
        $this->SetDrawColor(3,3,3);
        $this->SetLineWidth(.2);
        $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

        $this->SetFont($TipoLetra,'B',8);
        $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
        $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

        if($detalle[$i]['observacionespedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
        }

        if($detalle[$i]['salsaspedido'] != ""){ 
        $this->SetX(12);
        $this->SetFont($TipoLetra,'B',6);
        $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
        }

        }//fin de for
    }//fin de empty

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
       
    }
}
########################## FUNCION TICKET GENERAL ##############################

########################## FUNCION TICKET COMANDA ##############################
function TicketComanda()
{  
    $tra = new Login();
    $reg = $tra->PedidoPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier";
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE COCINA", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoComanda();
    for($i=0;$i<sizeof($detalle);$i++){

    $this->SetX(2); 
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
    $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['observacionespedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
    }

    if($detalle[$i]['salsaspedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
    }

    }//fin de for

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET COMANDA ##############################

########################## FUNCION TICKET BAR ##############################
function TicketBar()
{  
    $tra = new Login();
    $reg = $tra->PedidoPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier";
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE BAR", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoBar();
    for($i=0;$i<sizeof($detalle);$i++){

    $this->SetX(2); 
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
    $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['observacionespedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
    }

    if($detalle[$i]['salsaspedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
    }

    }//fin de for

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET BAR ##############################

########################## FUNCION TICKET REPOSTERIA ##############################
function TicketReposteria()
{  
    $tra = new Login();
    $reg = $tra->PedidoPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier";
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE REPOSTERIA", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['tipopedido'] == 1){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(24,3,"Nº COMANDA",0,0,'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(46,3,utf8_decode($reg[0]['numpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"CAJERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombres'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"TIPO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,$tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO"),0,1,'R');
  
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $a=1;
    $detalle = new Login();
    $detalle = $detalle->DetallesPedidoReposteria();
    for($i=0;$i<sizeof($detalle);$i++){

    $this->SetX(2); 
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(10,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'L');
    $this->MultiCell(60,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['observacionespedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['observacionespedido'] == '' ? "" : "(".$detalle[$i]['observacionespedido'].")")),0,'J');
    }

    if($detalle[$i]['salsaspedido'] != ""){ 
    $this->SetX(12);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(60,2,portales(utf8_decode($detalle[$i]['salsaspedido'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['salsaspedido']).")")),0,'J');
    }

    }//fin de for

    if($reg[0]['descripciones'] != ""){ 
    $this->Ln();
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,'J');
    }

    $this->Ln(1);
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET REPOSTERIA ##############################

########################## FUNCION TICKET PREGUENTA ##############################
function TicketPrecuenta()
{ 
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->DetallesPedido();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier";
  
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE PRECUENTA", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"SALA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nomsala'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"Nº MESA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode($reg[0]['nommesa'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"MESERO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,portales(utf8_decode(getSubString($reg[0]['nombre_mesero'], 50))),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(20,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(50,3,date("d-m-Y H:i:s",time()),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);
 
    /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(70));

    $cantidad = 0;
    $SubTotal = 0;
    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $SubTotal += $reg[$i]['suma'];
    
    $this->SetDrawColor(255, 255, 255);
    $this->SetLineWidth(.1);
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles']);
    $explode = explode("<br>",$reg[$i]['detalles']);

    for($cont=0; $cont<COUNT($explode); $cont++):
    list($cantidad,$producto,$precioventa,$valorneto,$observaciones,$salsas) = explode("|",$explode[$cont]);
        
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($cantidad, 2, '.', '.'))." X ".$simbolo.number_format($precioventa, 0, '.', '.'),0,0,'J');

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($valorneto, 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->MultiCell(70,3,portales(utf8_decode($producto)),0,'J');
    
    if($observaciones != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($observaciones == '' ? "" : "(".$observaciones.")")),0,'J');
    }

    if($salsas != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($salsas == '' ? "" : "(".str_replace("_", " ", $salsas).")")),0,'J');
    }

    $this->Ln(1);

    endfor;
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(36,4,"SUBTOTAL: ",1,0,'R');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(34,3,utf8_decode($simbolo.number_format($reg[$i]['suma'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);
    
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESCONTADO %",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['descontado'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"SUBTOTAL",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESC (".number_format($reg[0]["descuento"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', '.'),0,1,'R');

    $porcentaje = $reg[0]["porcentajepropina"]/100;
    $total_propina = number_format($SubTotal*$porcentaje, 2, '.', '');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(36,3,"PROP. SUGER. (".number_format($reg[0]["porcentajepropina"], 0, '.', '.')."%):",0,0,'L');
    $this->CellFitSpace(34,3,utf8_decode($simbolo.number_format($total_propina, 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(26,3,"TOTAL",0,0,'L');
    $this->Cell(44,3,$simbolo.number_format($reg[0]['totalpago']+$total_propina, 0, '.', '.'),0,1,'R');
    $this->Ln(1);

    if($reg[0]['descripciones']!=""){
    ########################### DESCRIPCIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,1,'');
    $this->Ln(1);
    ########################### DESCRIPCIONES #############################    
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'BI',10).portales(utf8_decode($reg[0]['membrete'])),0,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET PRECUENTA ##############################

########################## FUNCION TICKET DELIVERY ##############################
function TicketDelivery()
{ 
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->VentasPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier"; 
    
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE DELIVERY", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['direcsucursal'])),0,1,'C');

    if($reg[0]['codgiro'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,"N° GIRO: ".utf8_decode($reg[0]['codgiro']),0,1,'C');
    }
    
    if($reg[0]['girosucursal'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['girosucursal']),0,1,'C');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(24,4,"Nº PEDIDO",0,0,'L');
    $this->SetFont('Courier','B',13);
    $this->CellFitSpace(46,4,utf8_decode($reg[0]['codpedido']),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(35,4,"Nº TICKET", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"DELIVERY", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,portales(utf8_decode($reg[0]['nombres2'])), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA VENTA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s",strtotime($reg[0]['fechaventa'])),0,1,'R');
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s"),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['nomcliente']==""){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['direccion_delivery'])),0,'L');

    if($reg[0]['tlfcliente'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['tlfcliente'] == "" ? "**********" : $reg[0]['tlfcliente']),0,1,'L');
    }
   
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesVentas();
    $cantidad = 0;
    $SubTotal = 0;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantventa'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont($TipoLetra,'',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ','))." X ".$simbolo.number_format($detalle[$i]["precioventa"], 0, '.', '.'),0,0,'J');

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($detalle[$i]["valorneto"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->MultiCell(70,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['detallesobservaciones'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesobservaciones'] == '' ? "" : "(".$detalle[$i]['detallesobservaciones'].")")),0,'J');
    }

    if($detalle[$i]['detallesalsas'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesalsas'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['detallesalsas']).")")),0,'J');
    }

    endfor;

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESCONTADO %",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['descontado'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"SUBTOTAL",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESC (".number_format($reg[0]["descuento"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', '.'),0,1,'R');

    if($reg[0]["repartidor"] != 0){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DELIVERY",0,0,'L');
    $this->CellFitSpace(46,3,utf8_decode($simbolo.number_format($reg[0]["montodelivery"], 0, '.', '.')),0,1,'R');

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(26,4,"TOTAL",0,0,'L');
    $this->Cell(44,4,$simbolo.number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(24,3,"TIPO PAGO",0,0,'L');
    $this->Cell(46,3,utf8_decode($reg[0]['tipopago']),0,1,'R');

    if($reg[0]['tipopago'] == "CONTADO"){

        if($reg[0]["formapago2"]=="0"){

            $this->SetX(2);
            $this->SetFont('Courier','B',9);
            $this->CellFitSpace(20,3,"PAGO",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont('Courier','',9);
            $this->CellFitSpace(30,3,"SUMA DE SUS PAGOS",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont('Courier','',9);
            $this->CellFitSpace(30,3,"SU VUELTO",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montodevuelto"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);

        } else {

            $this->SetX(2);
            $this->SetFont('Courier','B',9);
            $this->CellFitSpace(20,3,"PAGO #1",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont('Courier','',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #1",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont('Courier','B',9);
            $this->CellFitSpace(20,3,"PAGO #2",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago2"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont('Courier','',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #2",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado2"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);
        }

    }

    ############# MUESTRO ABONOS Y PENDIENTE #############
    if($reg[0]['tipopago']=="CREDITO"){

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(30,3,"ABONADO",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format($reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(30,3,"PENDIENTE",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format(($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"])-$reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(30,3,"VENCIMIENTO",0,0,'L');
    $this->Cell(40,3,utf8_decode(date("d-m-Y",strtotime($reg[0]["fechavencecredito"]))),0,1,'R');
    }
    ############# MUESTRO ABONOS Y PENDIENTE #############

    if($reg[0]['descripciones']!=""){
    ########################### DESCRIPCIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont('courier','B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,1,'');
    $this->Ln(1);
    ########################### DESCRIPCIONES #############################    
    }

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont('courier','B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['observaciones'] == '' ? "" : $reg[0]['observaciones'])),0,1,'');
    $this->Ln(1);
    ########################### OBSERVACIONES #############################    
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7).'MONTO EN LETRAS: '.utf8_decode(numtoletras(number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 2, '.', ''))),0,'J');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(25,4,"FIRMA CLIENTE:",0,0,'L');
    $this->Cell(40,5,utf8_decode("_________________"),0,1,'L');
    $this->Ln(3);

    $timbre = './fotos/timbres/'.substr($reg[0]['tipodocumento'],0,1).$reg[0]['codfactura'].'.jpg';

    if (file_exists($timbre)) {

    $this->SetX(2);
    $this->Cell(70,25, $this->Image($timbre, $this->GetX(), $this->GetY(),66,25),0,1);     

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(70,6,"TIMBRE ELECTRÓNICO SII",0,1,'C');
    $this->Ln(2);

    } else {

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'BI',10).portales(utf8_decode($reg[0]['membrete'])),0,'C');
    $this->Ln(3);

   } 
}
########################## FUNCION TICKET DELIVERY ##############################

########################## FUNCION TICKET VENTA ##############################
function TicketVenta()
{ 
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->VentasPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier"; 
    
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE VENTA", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['direcsucursal'])),0,1,'C');

    if($reg[0]['codgiro'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,"N° GIRO: ".utf8_decode($reg[0]['codgiro']),0,1,'C');
    }
    
    if($reg[0]['girosucursal'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['girosucursal']),0,1,'C');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(35,4,"Nº BOLETA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    if($reg[0]['codmesa'] != 0){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(25,3,"SALA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(45,3,utf8_decode($reg[0]['nomsala']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(25,3,"MESA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(45,3,utf8_decode($reg[0]['nommesa']), 0, 1, 'R');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"CAJA Nº",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,utf8_decode($caja = ($reg[0]['codcaja'] == "0" ? "********" : $reg[0]['nrocaja']."-".$reg[0]['nomcaja'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"CAJERO", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,portales(utf8_decode($cajero = ($reg[0]['codcaja'] == "0" ? "********" : getSubString($reg[0]['nombres'], 46)))), 0, 1, 'R');


    if($reg[0]['delivery']=="1"){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"TIPO DE PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(46,3,utf8_decode($tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO")),0,1,'R');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA VENTA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s",strtotime($reg[0]['fechaventa'])),0,1,'R');

    if($reg[0]['tipoventa'] == 2){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA ENTREGA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s",strtotime($reg[0]['fechaentrega'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"ESTADO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,$reg[0]['statuspedido'] == 1 ? "PENDIENTE" : "ENTREGADO",0,1,'R');

    }
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s"),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['nomcliente']==""){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    if($reg[0]['direccliente'] != "" || $reg[0]['direccion_delivery'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($direccion = ($reg[0]['repartidor'] == 0 ? $reg[0]['direccliente'].$comuna = ($reg[0]['id_comuna2'] == '0' ? "" : " ".$reg[0]['comuna2'])."".$ciudad = ($reg[0]['id_ciudad2'] == '0' ? "" : " ".$reg[0]['ciudad2']) : $reg[0]['direccion_delivery']))),0,'L');
    }

    if($reg[0]['tlfcliente'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['tlfcliente'] == "" ? "**********" : $reg[0]['tlfcliente']),0,1,'L');
    }
   
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesVentas();
    $cantidad = 0;
    $SubTotal = 0;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantventa'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont($TipoLetra,'',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ','))." X ".$simbolo.number_format($detalle[$i]["precioventa"], 0, '.', '.'),0,0,'J');

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($detalle[$i]["valorneto"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->MultiCell(70,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['detallesobservaciones'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesobservaciones'] == '' ? "" : "(".$detalle[$i]['detallesobservaciones'].")")),0,'J');
    }

    if($detalle[$i]['detallesalsas'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesalsas'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['detallesalsas']).")")),0,'J');
    }

    endfor;

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESCONTADO %",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['descontado'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"SUBTOTAL",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESC (".number_format($reg[0]["descuento"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', '.'),0,1,'R');

    if($reg[0]["repartidor"] != 0){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DELIVERY",0,0,'L');
    $this->CellFitSpace(46,3,utf8_decode($simbolo.number_format($reg[0]["montodelivery"], 0, '.', '.')),0,1,'R');

    }

    if($reg[0]["codmesa"] != 0){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(36,3,"PROP. SUGER. (".number_format($reg[0]["propinasugerida"], 0, '.', '.')."%):",0,0,'L');
    $this->CellFitSpace(34,3,utf8_decode($simbolo.number_format($reg[0]["totalpropina"], 0, '.', '.')),0,1,'R');

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(26,3,"TOTAL",0,0,'L');
    $this->Cell(44,3,$simbolo.number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,3,"TIPO PAGO",0,0,'L');
    $this->Cell(46,3,utf8_decode($reg[0]['tipopago']),0,1,'R');

    if($reg[0]['tipopago'] == "CONTADO"){

        if($reg[0]["formapago2"]=="0"){

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE SUS PAGOS",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SU VUELTO",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montodevuelto"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);

        } else {

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO #1",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #1",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO #2",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago2"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #2",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado2"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);
        }
    }

    ############# MUESTRO ABONOS Y PENDIENTE #############
    if($reg[0]['tipopago']=="CREDITO"){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"ABONADO",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format($reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"PENDIENTE",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format(($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"])-$reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"VENCIMIENTO",0,0,'L');
    $this->Cell(40,3,utf8_decode(date("d-m-Y",strtotime($reg[0]["fechavencecredito"]))),0,1,'R');
    }
    ############# MUESTRO ABONOS Y PENDIENTE #############

    if($reg[0]['descripciones']!=""){
    ########################### DESCRIPCIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,1,'');
    $this->Ln(1);
    ########################### DESCRIPCIONES #############################    
    }

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['observaciones'] == '' ? "" : $reg[0]['observaciones'])),0,1,'');
    $this->Ln(1);
    ########################### OBSERVACIONES #############################    
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(30,3,"CANTIDAD TOTAL:",0,0,'L');
    $this->CellFitSpace(40,3,utf8_decode(number_format($Articulos, 2, '.', ',')),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['correosucursal'])),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(10,3,"TEL:",0,0,'L');
    $this->CellFitSpace(60,3,utf8_decode($reg[0]['tlfsucursal']),0,1,'L');
    $this->Ln(3);

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7).'MONTO EN LETRAS: '.utf8_decode(numtoletras(number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 2, '.', ''))),0,'J');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'BI',10);
    $this->SetFillColor(3, 3, 3);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'BI',10).portales(utf8_decode($reg[0]['membrete'])),0,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET VENTA ##############################

########################## FUNCION BOLETA VENTA ##############################
function BoletaVenta()
{ 
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->VentasPorId();
    $timbrePath = Lioren::getTimbre($reg[0]);
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier"; 
    
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "BOLETA DE VENTA", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['direcsucursal'])),0,1,'C');

    if($reg[0]['codgiro'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,"N° GIRO: ".utf8_decode($reg[0]['codgiro']),0,1,'C');
    }
    
    if($reg[0]['girosucursal'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['girosucursal']),0,1,'C');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(35,4,"Nº BOLETA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',13);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    if($reg[0]['codmesa'] != 0){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(25,3,"SALA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(45,3,utf8_decode($reg[0]['nomsala']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(25,3,"MESA", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(45,3,utf8_decode($reg[0]['nommesa']), 0, 1, 'R');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"CAJA Nº",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,utf8_decode($caja = ($reg[0]['codcaja'] == "0" ? "********" : $reg[0]['nrocaja']."-".$reg[0]['nomcaja'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"CAJERO", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,portales(utf8_decode($cajero = ($reg[0]['codcaja'] == "0" ? "********" : getSubString($reg[0]['nombres'], 46)))), 0, 1, 'R');


    if($reg[0]['delivery']=="1"){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"TIPO DE PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->Cell(46,3,utf8_decode($tipo = ($reg[0]['repartidor'] == 0 ? "EN ESTABLECIMIENTO" : "A DOMICILIO")),0,1,'R');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA VENTA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s",strtotime($reg[0]['fechaventa'])),0,1,'R');

    if($reg[0]['tipoventa'] == 2){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA ENTREGA",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s",strtotime($reg[0]['fechaentrega'])),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"ESTADO PEDIDO",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,$reg[0]['statuspedido'] == 1 ? "PENDIENTE" : "ENTREGADO",0,1,'R');

    }
    
    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,3,"FECHA EMISIÓN",0,0,'J');
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(46,3,date("d-m-Y H:i:s"),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['nomcliente']==""){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    if($reg[0]['direccliente'] != "" || $reg[0]['direccion_delivery'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($direccion = ($reg[0]['repartidor'] == 0 ? $reg[0]['direccliente'].$comuna = ($reg[0]['id_comuna2'] == '0' ? "" : " ".$reg[0]['comuna2'])."".$ciudad = ($reg[0]['id_ciudad2'] == '0' ? "" : " ".$reg[0]['ciudad2']) : $reg[0]['direccion_delivery']))),0,'L');
    }

    if($reg[0]['tlfcliente'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['tlfcliente'] == "" ? "**********" : $reg[0]['tlfcliente']),0,1,'L');
    }
   
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesVentas();
    $cantidad = 0;
    $SubTotal = 0;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantventa'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont($TipoLetra,'',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ','))." X ".$simbolo.number_format($detalle[$i]["precioventa"], 0, '.', '.'),0,0,'J');

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($detalle[$i]["valorneto"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->MultiCell(70,3,portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    if($detalle[$i]['detallesobservaciones'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesobservaciones'] == '' ? "" : "(".$detalle[$i]['detallesobservaciones'].")")),0,'J');
    }

    if($detalle[$i]['detallesalsas'] != ""){ 
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',6);
    $this->MultiCell(70,2,portales(utf8_decode($detalle[$i]['detallesalsas'] == '' ? "" : "(".str_replace("_", " ", $detalle[$i]['detallesalsas']).")")),0,'J');
    }

    endfor;

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESCONTADO %",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['descontado'], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"SUBTOTAL",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,$impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]["totaliva"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DESC (".number_format($reg[0]["descuento"], 0, '.', '.')."%)",0,0,'L');
    $this->Cell(46,3,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', '.'),0,1,'R');

    if($reg[0]["repartidor"] != 0){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,3,"DELIVERY",0,0,'L');
    $this->CellFitSpace(46,3,utf8_decode($simbolo.number_format($reg[0]["montodelivery"], 0, '.', '.')),0,1,'R');

    }

    if($reg[0]["codmesa"] != 0){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(36,3,"PROP. SUGER. (".number_format($reg[0]["propinasugerida"], 0, '.', '.')."%):",0,0,'L');
    $this->CellFitSpace(34,3,utf8_decode($simbolo.number_format($reg[0]["totalpropina"], 0, '.', '.')),0,1,'R');

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(26,3,"TOTAL",0,0,'L');
    $this->Cell(44,3,$simbolo.number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 0, '.', '.'),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(24,3,"TIPO PAGO",0,0,'L');
    $this->Cell(46,3,utf8_decode($reg[0]['tipopago']),0,1,'R');

    if($reg[0]['tipopago'] == "CONTADO"){

        if($reg[0]["formapago2"]=="0"){

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE SUS PAGOS",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SU VUELTO",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montodevuelto"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);

        } else {

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO #1",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #1",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',9);
            $this->CellFitSpace(20,3,"PAGO #2",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago2"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',9);
            $this->CellFitSpace(30,3,"SUMA DE PAGO #2",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado2"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);
        }
    }

    ############# MUESTRO ABONOS Y PENDIENTE #############
    if($reg[0]['tipopago']=="CREDITO"){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"ABONADO",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format($reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"PENDIENTE",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format(($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"])-$reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(30,3,"VENCIMIENTO",0,0,'L');
    $this->Cell(40,3,utf8_decode(date("d-m-Y",strtotime($reg[0]["fechavencecredito"]))),0,1,'R');
    }
    ############# MUESTRO ABONOS Y PENDIENTE #############

    if($reg[0]['descripciones']!=""){
    ########################### DESCRIPCIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['descripciones'] == '' ? "" : $reg[0]['descripciones'])),0,1,'');
    $this->Ln(1);
    ########################### DESCRIPCIONES #############################    
    }

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(1);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,3,portales(utf8_decode($reg[0]['observaciones'] == '' ? "" : $reg[0]['observaciones'])),0,1,'');
    $this->Ln(1);
    ########################### OBSERVACIONES #############################    
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(30,3,"CANTIDAD TOTAL:",0,0,'L');
    $this->CellFitSpace(40,3,utf8_decode(number_format($Articulos, 2, '.', ',')),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['correosucursal'])),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(10,3,"TEL:",0,0,'L');
    $this->CellFitSpace(60,3,utf8_decode($reg[0]['tlfsucursal']),0,1,'L');
    $this->Ln(3);

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7).'MONTO EN LETRAS: '.utf8_decode(numtoletras(number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 2, '.', ''))),0,'J');
    $this->Ln(3);

    if ($timbrePath) {

    $this->SetX(2);
    $this->Cell(70, 25, $this->Image($timbrePath, $this->GetX(), $this->GetY(), 70, 25), 0, 1);
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 6, "TIMBRE ELECTRONICO S.I.I", 0, 1, 'C');
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 7);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 3, "Verifique el Documento en: www.sii.cl", 0, 1, 'C');
    $this->Ln(2);

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'BI',10);
    $this->SetFillColor(3, 3, 3);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'BI',10).portales(utf8_decode($reg[0]['membrete'])),0,'C');
    $this->Ln(3);
    
    } 
}
########################## FUNCION BOLETA VENTA ##############################

########################## FUNCION FACTURA VENTA (80 mm) ##############################
function FacturaVenta()
{  
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->VentasPorId();
    $timbrePath = Lioren::getTimbre($reg[0]);
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Arial"; 

    //Bloque de membrete principal
    $this->SetFillColor(229);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.3);
    $this->RoundedRect(8, 8, 58, 18, '0', '');
  
    $this->SetXY(8,8);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->CellFitSpace(58, 6, $reg[0]['documsucursal'] == '0' ? "" : "".$reg[0]['documento'].": ".utf8_decode($reg[0]['cuitsucursal']) , 0, 1, 'C');

    $this->SetX(8);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(58, 6, "FACTURA ELECTRONICA", 0, 1, 'C');

    $this->SetX(8);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->CellFitSpace(58, 6, "Nº ".utf8_decode($reg[0]['codfactura']), 0, 1, 'C');

    $this->SetX(8);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->CellFitSpace(58, 5, "S.I.I. - ".strtoupper(utf8_decode($comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna']))), 0, 0, 'C');
    $this->Ln();

    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 20, 32, 35, 15, "PNG");
    $this->Ln(16);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->Cell(70, 3, "", 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['nomsucursal'])),0,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7).portales(utf8_decode($reg[0]['girosucursal'])),0,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7)."CASA MATRIZ: ".strtoupper(portales(utf8_decode($reg[0]['direcsucursal'].", ".$comuna = ($reg[0]['comuna'] == '' ? "" : $reg[0]['comuna'])." - ".$ciudad = ($reg[0]['ciudad'] == '' ? "" : $reg[0]['ciudad'])))),0,'L');
    $this->Ln(2);


    if($reg[0]['codcliente'] == '0'){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');   

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',8)."Receptor: ".portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "DOC:" : "".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7)."Giro: ".portales(utf8_decode($reg[0]['girocliente'])),0,'J');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'',7)."Dirección: ".portales(utf8_decode($direccion = ($reg[0]['repartidor'] == 0 ? $reg[0]['direccliente'].$comuna = ($reg[0]['id_comuna'] == '0' ? "" : " ".$reg[0]['comuna'])."".$ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : " ".$reg[0]['ciudad']) : $reg[0]['direccion_delivery']))),0,'J');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(35, 3, "Comuna: ".strtoupper(portales(utf8_decode($comuna2 = ($reg[0]['comuna2'] == '' ? "" : $reg[0]['comuna2'])))), 0, 0, 'L');
    $this->CellFitSpace(35, 3, "Ciudad: ".strtoupper(portales(utf8_decode($ciudad2 = ($reg[0]['ciudad2'] == '' ? "" : $reg[0]['ciudad2'])))), 0, 1, 'L');

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->CellFitSpace(20, 3, "Fecha Emisión:", 0, 0, 'L');
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(50, 3, utf8_decode(date("d-m-Y",strtotime($reg[0]['fechaventa']))), 0, 1, 'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->CellFitSpace(20, 3, "Vendedor:", 0, 0, 'L');
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(50, 3, portales(utf8_decode($reg[0]['nombres'])), 0, 1, 'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->CellFitSpace(30, 3, "Fecha de Vencimiento:", 0, 0, 'L');
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(40, 3, utf8_decode($vence = ($reg[0]['tipopago'] == "CONTADO" ? date("d-m-Y",strtotime($reg[0]['fechaventa'])) : date("d-m-Y",strtotime($reg[0]['fechavencecredito'])))), 0, 1, 'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',7);
    $this->CellFitSpace(20, 3, "Tipo de Pago:", 0, 0, 'L');
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(50, 3, utf8_decode($reg[0]['tipopago']), 0, 1, 'R');

    if($reg[0]['tipopago'] == "CONTADO"){

        if($reg[0]["formapago2"]=="0"){

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',7);
            $this->CellFitSpace(20,3,"Pago",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',7);
            $this->CellFitSpace(30,3,"Suma de sus Pagos",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',7);
            $this->CellFitSpace(30,3,"Su Vuelto",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montodevuelto"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);

        } else {

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',7);
            $this->CellFitSpace(20,3,"Pago #1",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',7);
            $this->CellFitSpace(30,3,"Suma de sus Pago #1",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado"], 0, '.', '.'),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'B',7);
            $this->CellFitSpace(20,3,"Pago #2",0,0,'L');
            $this->Cell(50,3,utf8_decode($reg[0]["formapago2"]),0,1,'R');

            $this->SetX(2);
            $this->SetFont($TipoLetra,'',7);
            $this->CellFitSpace(30,3,"Suma de sus Pago #2",0,0,'L');
            $this->Cell(40,3,$simbolo.number_format($reg[0]["montopagado2"], 0, '.', '.'),0,1,'R');
            $this->Ln(1);
        }
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0,'_____________________________',0,0,'C');
    $this->Ln(2);

    $this->SetX(3);
    $this->SetFont($TipoLetra,'B',7);
    $this->SetFillColor(2,157,116);
    $this->Cell(22, 5,"CODIGO/ITEM", 0, 0, 'L');
    $this->Cell(30, 5,"CANTIDAD/PRECIO", 0, 0, 'C');
    $this->Cell(16, 5,"TOTAL", 0, 0, 'R');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0,'_____________________________',0,0,'C');
    $this->Ln(3);

    $tra = new Login();
    $detalle = $tra->VerDetallesVentas();
    $cantidad = 0;
    $SubTotal = 0;
    $montoExento = 0;
    $valorIva    = $reg[0]["iva"] / 100;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantventa'];

    $this->SetX(3);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->SetFont($TipoLetra,'',7);
    $this->CellFitSpace(26,3,utf8_decode($detalle[$i]['codproducto']),0,0,'J');
    $this->CellFitSpace(13,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ',')),0,0,'J');
    $this->CellFitSpace(13,3,utf8_decode(number_format($detalle[$i]['precioventa'], 0, '.', ',')),0,0,'J');
    $this->CellFitSpace(16,3,number_format($detalle[$i]["valorneto"], 0, '.', ','),0,1,'R');

    $this->SetX(3);
    $this->SetFont($TipoLetra,'',7);
    $this->MultiCell(68,3,$this->SetFont($TipoLetra,'',7).portales(utf8_decode($detalle[$i]["producto"])),0,'J');

    endfor;

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0,'_____________________________',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(22,4,"Subtotal",0,0,'L');
    $this->Cell(48,4,number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->MultiCell(70,4,$this->SetFont($TipoLetra,'',7)."SON: ".utf8_decode(numtoletras(number_format($reg[0]['totalpago'], 0, '.', ''))),0,'J');


    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(68,4,"Referencias:",0,0,'L');
    $this->Ln();

    $this->SetX(3);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(24,4,"TIPO DOC", 1, 0, 'C');
    $this->CellFitSpace(22,4,"FOLIO", 1, 0, 'C');
    $this->CellFitSpace(22,4,"FECHA", 1, 1, 'C');

    $this->SetX(3);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(24,6," ", 1, 0, 'C');
    $this->CellFitSpace(22,6," ", 1, 0, 'C');
    $this->CellFitSpace(22,6," ", 1, 0, 'C');
    $this->Ln(8);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(22,3,"MONTO NETO",0,0,'L');
    $this->Cell(48,3,number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(22,3,"MONTO ".($impuesto == '' ? "IMPUESTO" : $impuesto),0,0,'L');
    $this->Cell(48,3,number_format($reg[0]['totaliva'], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(22,5,"MONTO TOTAL",0,0,'L');
    $this->Cell(48,5,number_format($reg[0]['totalpago'], 0, '.', ','),0,1,'R');

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(2);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,4,utf8_decode($reg[0]['observaciones']),0,1,'');
    $this->Ln(2);
    ########################### OBSERVACIONES #############################    
    }

    if ($timbrePath) {

    $this->SetX(2);
    $this->Cell(70, 25, $this->Image($timbrePath, $this->GetX(), $this->GetY(), 70, 25), 0, 1);
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 6, "Timbre Electronico S.I.I", 0, 1, 'C');
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 7);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 3, "Res. 159 de 2009 - Verifique Documento:", 0, 1, 'C');
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 7);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 3, "www.sii.cl", 0, 1, 'C');
    $this->Ln(2);
    
    }
}
########################## FUNCION FACTURA VENTA (80 mm) ##############################

########################## FUNCION LISTAR VENTAS ##############################
function TablaListarVentas()
 {
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE VENTAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }


    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,60,25,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS ##############################

########################## FUNCION LISTAR VENTAS POR BUSQUEDA ##############################
function TablaListarVentasxBusqueda()
 {
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BusquedaVentas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if($_GET['tipobusqueda'] == 1){
    $this->Cell(335,10,'LISTADO GENERAL DE VENTAS A CLIENTES',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 2){
    $this->Cell(335,10,'LISTADO DE COMPRAS A VENTAS POR BÚSQUEDA',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Cell(335,10,'LISTADO DE COMPRAS A VENTAS POR FECHAS',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){
        $this->Ln();
        $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
        $this->Ln();
        $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
        $this->Ln();
        $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 
    }

    if($_GET['tipobusqueda'] == 2){
    $this->Ln();
    $this->Cell(335,6,"BÚSQUEDA: ".mb_convert_encoding($_GET["search_criterio"], 'ISO-8859-1', 'UTF-8'),0,0,'L');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Ln();
    $this->Cell(335,6,"DESDE: ".date("d/m/Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"HASTA: ".date("d/m/Y", strtotime($_GET["hasta"])),0,0,'L');
    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,60,25,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS POR BUSQUEDA ##############################

########################## FUNCION LISTAR VENTAS DIARIAS ##############################
function TablaListarVentasDiarias()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentasDiarias();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,"LISTADO GENERAL DE VENTAS DEL DIA",0,0,'C');

    $this->Ln();
    $this->Cell(335,5,"FECHA ACTUAL: ".utf8_decode(date("d-m-Y")),0,0,'L');

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(58,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(22,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,58,22,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(190,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
 }


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS DIARIAS ##############################

########################## FUNCION LISTAR VENTAS EN DELIVERY PENDIENTES ##############################
function TablaListarVentasDeliveryPendientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentasDeliveryPendientes();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE VENTAS EN DELIVERY PENDIENTES',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,60,25,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS EN DELIVERY PENDIENTES ##############################

########################## FUNCION LISTAR VENTAS EN DELIVERY PAGADOS ##############################
function TablaListarVentasDeliveryPagados()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentasDeliveryPagadas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE VENTAS EN DELIVERY PAGADOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(190,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(190,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,60,25,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(195,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS EN DELIVERY PAGADOS ##############################

########################## FUNCION LISTAR VENTAS EN DELIVERY DIARIAS ##############################
function TablaListarVentasDeliveryDiarias()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentasDeliveryDiarias();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,"LISTADO GENERAL DE VENTAS EN DELIVERY DEL DIA",0,0,'C');

    $this->Ln();
    $this->Cell(335,5,"FECHA ACTUAL: ".utf8_decode(date("d-m-Y")),0,0,'L');

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(58,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(22,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(25,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,58,22,20,45,20,35,25,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
   }
   
    $this->Cell(190,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS EN DELIVERY DIARIAS ##############################

########################## FUNCION LISTAR VENTAS EN DELIVERY POR REPARTIDOR ##############################
function TablaListarVentasDeliveryxRepartidor()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarVentasDeliveryxRepartidor();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE VENTAS EN DELIVERY POR REPARTIDOR',0,0,'C');

    $this->Ln();
    $this->Cell(335,5,"REPARTIDOR: ".utf8_decode($nombres = ($reg == "" ? "************" : $reg[0]["nombres"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(60,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(90,8,'DIRECCIÓN DE CLIENTE',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(35,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(40,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,60,90,25,20,35,20,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        portales(utf8_decode($direccion = ($reg[$i]["direccion_delivery"] == "" ? "********" : $reg[$i]["direccion_delivery"]))),
        utf8_decode($status),
        utf8_decode($reg[$i]["tipopago"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
    }


    $this->Cell(275,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS EN DELIVERY POR REPARTIDOR ##############################

########################## FUNCION LISTAR VENTAS POR CAJAS ##############################
function TablaListarVentasxCajas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarVentasxCajas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['tipopago']) == 1){ 
    $this->Cell(335,7,'LISTADO DE VENTAS GENERALES POR CAJA',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 2){ 
    $this->Cell(335,7,'LISTADO DE VENTAS A CONTADO POR CAJA',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 3){ 
    $this->Cell(335,7,'LISTADO DE VENTAS A CRÉDITO POR CAJA',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(48,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    //$this->Cell(22,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(22,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(28,8,'ABONADO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DISPONIBLE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,48,20,30,20,35,22,20,30,28,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;
    $TotalDisponible=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];
    $TotalDisponible+=($reg[$i]["tipopago"] == "CREDITO" ? number_format($reg[$i]['creditopagado'], 2, '.', '') : number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 2, '.', ''));

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),

        $var = ($reg[$i]["tipopago"] == "CREDITO" ? utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')) : utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')))

       ));
    }
   
    $this->Cell(143,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(22,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDisponible, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS POR CAJAS ##############################

########################## FUNCION LISTAR VENTAS POR FECHAS ##############################
function TablaListarVentasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarVentasxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['tipopago']) == 1){ 
    $this->Cell(335,7,'LISTADO DE VENTAS GENERALES POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 2){ 
    $this->Cell(335,7,'LISTADO DE VENTAS A CONTADO POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 3){ 
    $this->Cell(335,7,'LISTADO DE VENTAS A CRÉDITO POR FECHAS',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(48,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    //$this->Cell(22,8,'ESTADO',1,0,'C', True);
    $this->Cell(20,8,'PAGO',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(22,8,$impuesto,1,0,'C', True);
    $this->Cell(20,8,'DESC %',1,0,'C', True);
    $this->Cell(30,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(28,8,'ABONADO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DISPONIBLE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,48,20,30,20,35,22,20,30,28,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;
    $TotalDisponible=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];
    $TotalDisponible+=($reg[$i]["tipopago"] == "CREDITO" ? number_format($reg[$i]['creditopagado'], 2, '.', '') : number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 2, '.', ''));

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]["tipopago"]),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),

        $var = ($reg[$i]["tipopago"] == "CREDITO" ? utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')) : utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')))
       ));
    }
   
    $this->Cell(143,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(22,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(28,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDisponible, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS POR FECHAS ##############################

########################## FUNCION LISTAR VENTAS POR CONDICION DE PAGO Y FECHAS ##############################
function TablaListarVentasxCondiciones()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarVentasxCondiciones(); 
    $formapago = utf8_decode($_GET["formapago"]);

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,'LISTADO DE VENTAS A CONTADO POR FORMAS DE PAGO',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"CONDICIÓN DE PAGO: ".$formapago,0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(50,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(20,8,'ESTADO',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'Nº ARTIC',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESC %',1,0,'C', True);
    $this->Cell(40,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL PAGO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,25,50,20,30,20,35,30,30,40,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;
    $TotalPagado=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']); 
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    if($reg[$i]['formapago'] == $formapago){

    $ImportePagado = $reg[$i]['montopagado']-$reg[$i]['montodevuelto'];
    $TotalPagado += $reg[$i]['montopagado']-$reg[$i]['montodevuelto'];

    } else {

    $ImportePagado = $reg[$i]['montopagado2'];
    $TotalPagado += $reg[$i]['montopagado2'];
   
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($status),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaventa']))),utf8_decode(number_format($reg[$i]['articulos'], 2, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),
        utf8_decode($simbolo.number_format($ImportePagado, 0, '.', '.'))));
    }
   
    $this->Cell(140,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 2, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalPagado, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR VENTAS POR CONDICION DE PAGO Y FECHAS ##############################

######################## FUNCION LISTAR VENTAS POR TIPOS DE CLIENTES #########################
function TablaListarVentasxTipos()
{
    $tra = new Login();
    $reg = $tra->BuscarVentasxTipos();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################
    
    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,8,"LISTADO DE VENTAS DE CLIENTES ".$tipo = ($_GET["tipocliente"] == 'NATURAL' ? "NATURALES" : "JURIDICOS"),0,0,'C');
    $this->Ln();
    
    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(260,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE DOCUMENTO',1,0,'C', True);
    $this->Cell(100,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(38,8,'Nº DE TELÉFONO',1,0,'C', True);
    $this->Cell(30,8,'CANT. COMPRAS',1,0,'C', True);
    $this->Cell(42,8,'TOTAL COMPRAS',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,100,38,30,42));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalGeneral=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $TotalArticulos+=$reg[$i]['cantidad'];
    $TotalGeneral+=$reg[$i]['totalcompras'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($documento = ($reg[$i]['documcliente'] == '0' ? "DOCUMENTO" : $reg[$i]['documento']).": ".$reg[$i]["dnicliente"]),utf8_decode($reg[$i]['nomcliente']),utf8_decode($reg[$i]['tlfcliente'] == '' ? "*********" : $reg[$i]['tlfcliente']),utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),utf8_decode($simbolo.number_format($reg[$i]['totalcompras'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(188,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(30,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(42,5,utf8_decode($simbolo.number_format($TotalGeneral, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR VENTAS POR TIPOS DE CLIENTES ########################

######################## FUNCION LISTAR VENTAS POR CLIENTES #########################
function TablaListarVentasxClientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarVentasxClientes();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE DETALLES DE VENTAS POR CLIENTE ",0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"Nº DE ".utf8_decode($documento = ($reg[0]['documcliente'] == '0' ? "DOCUMENTO" : $reg[0]['documento3']).": ".$reg[0]["dnicliente"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"NOMBRE DE CLIENTE: ".portales(utf8_decode($reg[0]["nomcliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"Nº DE TELÉFONO: ".portales(utf8_decode($reg[0]["tlfcliente"] == "" ? "********" : $reg[0]["tlfcliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"ciudad: ".portales(utf8_decode($reg[0]["id_ciudad"] == "0" ? "********" : $reg[0]["ciudad2"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"comuna: ".portales(utf8_decode($reg[0]["id_comuna"] == "0" ? "********" : $reg[0]["comuna2"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DIRECCIÓN: ".portales(utf8_decode($reg[0]["direccliente"] == "" ? "********" : $reg[0]["direccliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"CORREO ELECTRONICO: ".portales(utf8_decode($reg[0]["emailcliente"] == "" ? "********" : $reg[0]["emailcliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(30,8,'ESTADO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(35,8,'Nº ARTICULOS',1,0,'C', True);
    $this->Cell(45,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(40,8,$impuesto,1,0,'C', True);
    $this->Cell(40,8,'DESC %',1,0,'C', True);
    $this->Cell(45,8,'TOTAL IMPORTE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,30,45,35,45,40,40,45));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalImpuesto=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalImpuesto+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($status),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode($reg[$i]['articulos']),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.'))));
       }
    }
   
    $this->Cell(125,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR VENTAS POR CLIENTES #########################

######################## FUNCION LISTAR PROPINAS POR VENTAS #########################
function TablaListarPropinasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarPropinasxFechas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################
    
    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,7,"LISTADO DE PROPINAS POR FECHAS",0,0,'C');
    $this->Ln();

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(190,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Cell(190,5,"Nº DE DOCUMENTO: ".utf8_decode($reg[0]["dni2"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"MESERO(A): ".utf8_decode($reg[0]['nombres2']),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(20,8,'ESTADO',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(20,8,'ARTICULOS',1,0,'C', True);
    $this->Cell(40,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(40,8,'TOTAL PROPINA',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,30,20,30,20,40,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos = 0;
    $TotalGravado   = 0;
    $TotalExento    = 0;
    $TotalImpuesto  = 0;
    $TotalDescuento = 0;
    $TotalImporte   = 0;
    $TotalPropina   = 0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $TotalArticulos += $reg[$i]['articulos'];
    $TotalGravado   += $reg[$i]['subtotalivasi'];
    $TotalExento    += $reg[$i]['subtotalivano'];
    $TotalImpuesto  += $reg[$i]['totaliva'];
    $TotalDescuento += $reg[$i]['totaldescuento'];
    $TotalImporte   += $reg[$i]['totalpago']+$reg[$i]["totalpropina"];
    $TotalPropina   += $reg[$i]['totalpropina'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($status),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaventa']))),utf8_decode($reg[$i]['articulos']),$simbolo.utf8_decode($reg[$i]['totalpago']+$reg[$i]["totalpropina"]),utf8_decode($simbolo.number_format($reg[$i]['totalpropina'], 0, '.', '.'))));
       }
    }
   
    $this->Cell(90,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(20,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalPropina, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR PROPINAS POR VENTAS #########################

######################## FUNCION LISTAR DELIVERY POR VENTAS #########################
function TablaListarDeliveryxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarDeliveryxFechas();

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################
    
    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,7,"LISTADO DE DELIVERY POR FECHAS",0,0,'C');
    $this->Ln();

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(190,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(190,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Cell(190,5,"Nº DE DOCUMENTO: ".utf8_decode($reg[0]["dni2"]),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"REPARTIDOR: ".utf8_decode($reg[0]['nombres2']),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"PORCENTAJE COMISIÓN: ".utf8_decode($reg[0]['comision2'])."%",0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(190,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(26,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(30,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(24,8,'ARTICULOS',1,0,'C', True);
    $this->Cell(33,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(33,8,'TOTAL DELIVERY',1,0,'C', True);
    $this->Cell(33,8,'TOTAL COMISIÓN',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,26,30,24,33,33,33));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos = 0;
    $TotalGravado   = 0;
    $TotalExento    = 0;
    $TotalImpuesto  = 0;
    $TotalDescuento = 0;
    $TotalImporte   = 0;
    $TotalDelivery  = 0;
    $TotalComision  = 0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $CalculoComision = ($reg[$i]['comision2'] == "0" ? "0" : ($reg[$i]['montodelivery'])*($reg[$i]['comision2']/100));

    $TotalArticulos += $reg[$i]['articulos'];
    $TotalGravado   += $reg[$i]['subtotalivasi'];
    $TotalExento    += $reg[$i]['subtotalivano'];
    $TotalImpuesto  += $reg[$i]['totaliva'];
    $TotalDescuento += $reg[$i]['totaldescuento'];
    $TotalImporte   += $reg[$i]['totalpago']+$reg[$i]["totalpropina"];
    $TotalDelivery  += $reg[$i]['montodelivery'];
    $TotalComision  += $CalculoComision;

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechaventa']))),utf8_decode($reg[$i]['articulos']),$simbolo.utf8_decode($reg[$i]['totalpago']+$reg[$i]["totalpropina"]),utf8_decode($simbolo.number_format($reg[$i]['montodelivery'], 0, '.', '.')),utf8_decode($simbolo.number_format($CalculoComision, 0, '.', '.'))));
       }
    }
   
    $this->Cell(66,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(24,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(33,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(33,5,utf8_decode($simbolo.number_format($TotalDelivery, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(33,5,utf8_decode($simbolo.number_format($TotalComision, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR DELIVERY POR VENTAS #########################

####################### FUNCION LISTAR DETALLES VENDIDOS POR CAJAS ###########################
function TablaListarDetallesVentasxCajas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesVentasxCajas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['tipopago']) == 1){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS GENERALES POR CAJA',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 2){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CONTADO POR CAJA',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 3){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CRÉDITO POR CAJA',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,70,30,40,30,20,30,30,40));

    $PrecioTotal    = 0;
    $ExisteTotal    = 0;
    $VendidosTotal  = 0;
    $TotalDescuento = 0;
    $TotalImpuesto  = 0;
    $PagoTotal      = 0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";
        $Existencia=$reg[$i]['cantcombo'];
        $ExisteTotal+=$reg[$i]['cantcombo'];

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento        = $reg[$i]['descproducto']/100;
    $PrecioDescuento  = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal      = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg              = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto  = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento   += $CalculoDescuento; 
    $TotalImpuesto    += $CalculoImpuesto; 
    $PagoTotal        += $PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
       }
    }
   
    $this->Cell(145,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR DETALLES VENDIDOS POR CAJAS ##########################

####################### FUNCION LISTAR DETALLES VENDIDOS POR FECHAS ###########################
function TablaListarDetallesVentasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesVentasxFechas(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['tipopago']) == 1){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS GENERALES POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 2){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CONTADO POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 3){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CRÉDITO POR FECHAS',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,70,30,40,30,20,30,30,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";
        $Existencia=$reg[$i]['cantcombo'];
        $ExisteTotal+=$reg[$i]['cantcombo'];

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
       }
    }
   
    $this->Cell(145,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR DETALLES VENDIDOS POR FECHAS ##########################

####################### FUNCION LISTAR PRODUCTOS VENDIDOS POR VENDEDOR ###########################
function TablaListarDetallesVentasxVendedor()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == '' ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == '' ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->BuscarDetallesVentasxVendedor(); 

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['tipopago']) == 1){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS GENERALES POR VENDEDOR',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 2){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CONTADO POR VENDEDOR',0,0,'C');
    } elseif(decrypt($_GET['tipopago']) == 3){ 
    $this->Cell(335,7,'LISTADO DETALLES DE VENTAS A CRÉDITO POR VENDEDOR',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"VENDEDOR: ".portales(utf8_decode($reg[0]['nombres'])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es AZUL)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'TIPO',1,0,'C', True);
    $this->Cell(70,8,'DESCRIPCIÓN',1,0,'C', True);
    $this->Cell(30,8,'CATEGORIA',1,0,'C', True);
    $this->Cell(40,8,"PRECIO VENTA",1,0,'C', True);
    $this->Cell(30,8,'EXISTENCIA',1,0,'C', True);
    $this->Cell(20,8,'VENDIDO',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(30,8,'DESCUENTO',1,0,'C', True);
    $this->Cell(40,8,'MONTO TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,30,70,30,40,30,20,30,30,40));

    $PrecioTotal=0;
    $ExisteTotal=0;
    $VendidosTotal=0;
    $TotalDescuento=0;
    $TotalImpuesto=0;
    $PagoTotal=0;

    $a=1;
    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $PrecioTotal+=$reg[$i]['precioventa'];

    if($reg[$i]['tipo'] == 1){

        $Tipo="PRODUCTO";
        $Categoria=$reg[$i]['nomcategoria'];
        $Existencia=$reg[$i]['existencia'];
        $ExisteTotal+=$reg[$i]['existencia'];

    } elseif($reg[$i]['tipo'] == 2){

        $Tipo="COMBO";
        $Categoria="********";
        $Existencia=$reg[$i]['cantcombo'];
        $ExisteTotal+=$reg[$i]['cantcombo'];

    } else {

        $Tipo="EXTRA";
        $Categoria=$reg[$i]['nommedida'];
        $Existencia=$reg[$i]['cantingrediente'];
        $ExisteTotal+=$reg[$i]['cantingrediente'];
    }

    $VendidosTotal+=$reg[$i]['cantidad'];

    $Descuento = $reg[$i]['descproducto']/100;
    $PrecioDescuento = $reg[$i]['precioventa']*$Descuento;
    $CalculoDescuento = $PrecioDescuento*$reg[$i]['cantidad'];
    $PrecioFinal = $reg[$i]['precioventa']-$PrecioDescuento;

    $ivg = $reg[$i]['ivaproducto']/100;
    $SubtotalImpuesto = $PrecioFinal*$ivg;
    $CalculoImpuesto = $SubtotalImpuesto*$reg[$i]['cantidad'];

    $TotalDescuento+=$CalculoDescuento; 
    $TotalImpuesto+=$CalculoImpuesto; 
    $PagoTotal+=$PrecioFinal*$reg[$i]['cantidad']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($Tipo),
        portales(utf8_decode($reg[$i]["producto"])),
        utf8_decode($Categoria),
        utf8_decode($simbolo.number_format($reg[$i]["precioventa"], 0, '.', '.')),
        utf8_decode(number_format($reg[$i]['existencia'], 2, '.', ',')),
        utf8_decode(number_format($reg[$i]['cantidad'], 2, '.', ',')),
        utf8_decode($simbolo.number_format($CalculoImpuesto, 0, '.', '.')),
        utf8_decode($simbolo.number_format($CalculoDescuento, 0, '.', '.')),
        utf8_decode($simbolo.number_format($PrecioFinal*$reg[$i]['cantidad'], 0, '.', '.'))));
       }
    }
   
    $this->Cell(145,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PrecioTotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode(number_format($ExisteTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(20,5,utf8_decode(number_format($VendidosTotal, 2, '.', ',')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($PagoTotal, 0, '.', '.')),0,0,'L');
    $this->Ln();
   

    $this->Ln(12); 
    $this->SetFont('courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
###################### FUNCION LISTAR PRODUCTOS VENDIDOS POR VENDEDOR ##########################

######################## FUNCION LISTAR COMISION POR VENTAS #########################
function TablaListarComisionxVentas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarComisionxVentas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,7,"LISTADO DE COMISIÓN POR VENTAS",0,0,'C');
    $this->Ln();

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Cell(335,5,"Nº DE DOCUMENTO: ".utf8_decode($reg[0]["dni"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"VENDEDOR: ".utf8_decode($reg[0]['nombres']),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"PORCENTAJE COMISIÓN: ".utf8_decode($reg[0]['comision'])."%",0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(45,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(25,8,'ARTICULOS',1,0,'C', True);
    $this->Cell(40,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(35,8,$impuesto,1,0,'C', True);
    $this->Cell(35,8,'DESC %',1,0,'C', True);
    $this->Cell(40,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(40,8,'TOTAL COMISIÓN',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,25,45,25,40,35,35,40,40));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalImpuesto=0;
    $TotalDescuento=0;
    $TotalImporte=0;
    $TotalComision=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);

    $CalculoComision = ($reg[$i]['comision'] == "0" ? "0" : ($reg[$i]['totalpago'])*($reg[$i]['comision']/100));

    $TotalArticulos += $reg[$i]['articulos'];
    $TotalSubtotal  += $reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalImpuesto  += $reg[$i]['totaliva'];
    $TotalDescuento += $reg[$i]['totaldescuento'];
    $TotalImporte   += $reg[$i]['totalpago'];
    $TotalComision  += $CalculoComision;

    if($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" && $reg[$i]['codcaja'] != "0") { 
        $status = "VENCIDA"; 
    } else { 
        $status = $reg[$i]["statusventa"]; 
    }

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($status),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),utf8_decode($reg[$i]['articulos']),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.')),utf8_decode($simbolo.number_format($CalculoComision, 0, '.', '.'))));
       }
    }
   
    $this->Cell(115,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(25,5,utf8_decode(number_format($TotalArticulos, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImpuesto, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(40,5,utf8_decode($simbolo.number_format($TotalComision, 0, '.', '.')),0,0,'L');
    $this->Ln();

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR COMISION POR VENTAS #########################

########################## FUNCION INFORME DE VENTAS POR FECHAS ##############################
function InformeVentasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $sucursal = new Login();
    $sucursal = $sucursal->SucursalesPorId();
    $simbolo = ($sucursal[0]['simbolo'] == "" ? "" : $sucursal[0]['simbolo']);

    $venta = new Login();
    $venta = $venta->SumarVentasxFechas();

    $arqueo = new Login();
    $arqueo = $arqueo->SumarArqueosxFechas();

    $cartera = new Login();
    $cartera = $cartera->SumarCarteraxFechas();

    $utilidadneta   = ($venta[0]['totalventa'])-($venta[0]['totalcompra']);
    $balance        = $venta[0]['totalventa']+$arqueo[0]['totalingresos']+$arqueo[0]['totalabonos'];
    $balance2       = $venta[0]['totalcompra'];
    //$balance2       = $compra[0]['totalcomprageneral']+$arqueo[0]['totalegresos'];
    $balancegeneral = $balance - $balance2;

    ################################# MEMBRETE A4 #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',11);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_vertical_X'], $this->GetY()+$GLOBALS['logo1_vertical_Y'], $GLOBALS['logo1_vertical']),0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_vertical_X'], $this->GetY()+$GLOBALS['logo2_vertical_Y'], $GLOBALS['logo2_vertical']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(100,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE A4 #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(190,10,'INFORME DE VENTAS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG"){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($sucursal[0]['documento'])." SUCURSAL: ".utf8_decode($sucursal[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($sucursal[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($sucursal[0]["nomencargado"])),0,1,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE VENTAS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($venta[0]['totalventa'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE INGRESOS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalingresos'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'ABONOS A CRÉDITOS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalabonos'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE COMPRAS',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($venta[0]['totalcompra'], 0, '.', '.')),0,0,'R');
    $this->Ln();
   
    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE GASTOS (EGRESOS)',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($arqueo[0]['totalegresos'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'CARTERA DE CLIENTES',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($cartera[0]['totaldebe']-$cartera[0]['totalpagado'], 0, '.', '.')),0,0,'R');
    $this->Ln();
  
    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'TOTAL DE IMPUESTOS VENTAS '.$impuesto.' ('.$valor.'%)',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($venta[0]['totaliva'], 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'BALANCE GENERAL ',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($balancegeneral, 0, '.', '.')),0,0,'R');
    $this->Ln();

    $this->SetFont('courier','B',12);
    $this->Cell(120,8,'UTILIDAD NETA ',0,0,'L', false);
    $this->SetFont('courier','B',14);
    $this->Cell(70,8,utf8_decode($simbolo.number_format($utilidadneta, 0, '.', '.')),0,0,'R');
    $this->Ln();


    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(86,6,'RECIBIDO:____________________________',0,0,'');
    $this->Ln();
    $this->Cell(4,6,'',0,0,'');
    $this->Cell(100,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(86,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION INFORME DE VENTAS POR FECHAS ##############################

################################### REPORTES DE VENTAS ##################################

























############################## REPORTES DE CREDITOS ##################################

########################## FUNCION TICKET CREDITO ##############################
function TicketCredito()
{  
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->CreditosPorId();
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']); 
    
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "TICKET DE CRÉDITO", 0, 0, 'C');
    $this->Ln(5);
  
    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direcsucursal'])),0,'C');

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['girosucursal'])),0,'C');

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(35,4,"Nº TICKET:  ", 0, 0, 'J');
    $this->SetFont('Courier','B',13);
    $this->CellFitSpace(35,4,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(35,4,"FECHA: ".utf8_decode(date("d/m/Y",strtotime($reg[0]['fechaventa']))), 0, 0, 'J');
    $this->CellFitSpace(35,4,"HORA: ".utf8_decode(date("H:i:s",strtotime($reg[0]['fechaventa']))), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(33,4,"VENCE: ".utf8_decode(date("d/m/Y",strtotime($reg[0]['fechavencecredito']))), 0, 0, 'J');
    if($reg[0]['fechavencecredito'] == '0000-00-00' || $reg[0]['fechavencecredito'] >= date("Y-m-d")) {
    $this->CellFitSpace(37,4,"DIAS VENC: ".utf8_decode("0"), 0, 0, 'R');  
    } elseif($reg[0]['fechavencecredito'] < date("Y-m-d")) {
    $this->CellFitSpace(37,4,"DIAS VENC: ".utf8_decode(Dias_Transcurridos(date("Y-m-d"),$reg[0]['fechavencecredito'])), 0, 0, 'R'); 
    }
    $this->Ln();

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['nomcliente']==""){

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');

    } else {

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->MultiCell(70,3,$this->SetFont('Courier','B',9).portales(utf8_decode($reg[0]['direccliente'].$comuna = ($reg[0]['id_comuna'] == '0' ? "" : " ".$reg[0]['comuna'])."".$ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : " ".$reg[0]['ciudad']))),0,'L');

    if($reg[0]['tlfcliente'] != ""){
    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['tlfcliente'] == "" ? "**********" : $reg[0]['tlfcliente']),0,1,'L');
    }
   
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE ABONOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesAbonos();
    if($detalle==""){
        echo "";      
    } else {
    $cantidad = 0;
    $SubTotal = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont('Courier','',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetX(2);
    $this->SetFont('Courier','',8);
    $this->CellFitSpace(35,3,utf8_decode($detalle[$i]['formaabono']),0,0,'L');
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(35,3,$simbolo.utf8_decode(number_format($detalle[$i]['montoabono'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',8);
    $this->CellFitSpace(35,3,utf8_decode(date("d-m-Y H:i:s",strtotime($detalle[$i]['fechaabono']))),0,1,'L');
    $this->Ln(1);

    endfor; 
    }

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(20,3,"TOTAL",0,0,'L');
    $this->Cell(50,3,$simbolo.utf8_decode(number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"], 0, '.', '.')),0,1,'R');  

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(30,3,"ABONADO",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format($reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','B',9);
    $this->CellFitSpace(30,3,"PENDIENTE",0,0,'L');
    $this->Cell(40,3,$simbolo.utf8_decode(number_format($reg[0]['totalpago']+$reg[0]["totalpropina"]+$reg[0]["montodelivery"]-$reg[0]['creditopagado'], 0, '.', '.')),0,1,'R');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['correosucursal'])),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(10,3,"TEL:",0,0,'L');
    $this->CellFitSpace(60,3,utf8_decode($reg[0]['tlfsucursal']),0,1,'L');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont('Courier','B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->MultiCell(70,3,$this->SetFont('Courier','BI',10).portales(utf8_decode($reg[0]['membrete'])),0,'C');
    $this->Ln(3);
}
########################## FUNCION TICKET CREDITO ##############################

########################## FUNCION LISTAR CREDITOS ##############################
function TablaListarCreditos()
{
    $tra = new Login();
    $reg = $tra->ListarCreditos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE CRÉDITOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'ESTADO',1,0,'C', True);
    $this->Cell(35,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCIMIENTO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,75,30,35,40,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
    	utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
    	utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
    	utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CREDITOS ##############################

########################## FUNCION LISTAR CREDITOS POR BUSQUEDA ##############################
function TablaListarCreditosxBusqueda()
{
    $tra = new Login();
    $reg = $tra->BusquedaCreditos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if($_GET['tipobusqueda'] == 1){
    $this->Cell(335,10,'LISTADO GENERAL DE VENTAS A CRÉDITOS',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 2){
    $this->Cell(335,10,'LISTADO DE VENTAS A CRÉDITOS POR BÚSQUEDA',0,0,'C');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Cell(335,10,'LISTADO DE VENTAS A CRÉDITOS POR FECHAS',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){
        $this->Ln();
        $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
        $this->Ln();
        $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
        $this->Ln();
        $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 
    }
    
    if($_GET['tipobusqueda'] == 2){
    $this->Ln();
    $this->Cell(335,6,"BÚSQUEDA: ".mb_convert_encoding($_GET["search_criterio"], 'ISO-8859-1', 'UTF-8'),0,0,'L');
    } elseif($_GET['tipobusqueda'] == 3){
    $this->Ln();
    $this->Cell(335,6,"DESDE: ".date("d/m/Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"HASTA: ".date("d/m/Y", strtotime($_GET["hasta"])),0,0,'L');
    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'ESTADO',1,0,'C', True);
    $this->Cell(35,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCIMIENTO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,75,30,35,40,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CREDITOS POR BUSQUEDA ##############################

########################## FUNCION LISTAR CREDITOS VENCIDOS ##############################
function TablaListarCreditosVencidos()
{
    $tra = new Login();
    $reg = $tra->ListarCreditosVencidos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################
    
    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE CRÉDITOS VENCIDOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'ESTADO',1,0,'C', True);
    $this->Cell(35,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCIMIENTO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,75,30,35,40,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR CREDITOS VENCIDOS ##############################

######################## FUNCION LISTAR ABONOS CREDITOS POR CAJAS #########################
function TablaListarAbonosCreditosxCajas()
{
    $tra = new Login();
    $reg = $tra->BuscarAbonosCreditosxCajas();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(260,7,"LISTADO DE ABONOS CRÉDITOS POR CAJAS",0,0,'C');
    $this->Ln();

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(260,5,"CAJA Nº: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"RESPONSABLE: ".utf8_decode($reg[0]["nombres"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"CONDICIÓN DE PAGO: ".$_GET["formapago"],0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');
    
    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(45,8,'Nº DE DOCUMENTO',1,0,'C', True);
    $this->Cell(75,8,'DESCRIPCIÓN DE CLIENTE',1,0,'C', True);
    $this->Cell(45,8,'FECHA DE ABONO',1,0,'C', True);
    $this->Cell(45,8,'MONTO ABONO',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
    $this->SetWidths(array(15,35,45,75,45,45));

    $a=1;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['montoabono'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['documento'].": ".$reg[$i]['dnicliente']),
        portales(utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente'])),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaabono']))),
        utf8_decode($simbolo.number_format($reg[$i]['montoabono'], 0, '.', '.'))
       ));
       }
    }
   
    $this->Cell(215,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(45,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR ABONOS CREDITOS POR CAJAS #########################

######################## FUNCION LISTAR CREDITOS POR FECHAS ##########################
function TablaListarCreditosxFechas()
{
    $tra = new Login();
    $reg = $tra->BuscarCreditosxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['status']) == 1){ 
    $this->Cell(335,7,'LISTADO DE CRÉDITOS GENERALES POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['status']) == 2){ 
    $this->Cell(335,7,'LISTADO DE CRÉDITOS PAGADOS POR FECHAS',0,0,'C');
    } elseif(decrypt($_GET['status']) == 3){ 
    $this->Cell(335,7,'LISTADO DE CRÉDITOS PENDIENTES POR FECHAS',0,0,'C');
    }
    
    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(75,8,'NOMBRE DE CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'ESTADO',1,0,'C', True);
    $this->Cell(35,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCIMIENTO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,75,30,35,40,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,
        utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),
        utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }
    
    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR CREDITOS POR FECHAS ##########################

######################## FUNCION LISTAR CREDITOS POR CLIENTES #########################
function TablaListarCreditosxClientes()
{
    $tra = new Login();
    $reg = $tra->BuscarCreditosxClientes();

    ################################# MEMBRETE LETTER #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(45,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_letter_X'], $this->GetY()+$GLOBALS['logo1_letter_Y'], $GLOBALS['logo1_letter']),0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(45,5,$this->Image($logo2, $this->GetX()-$GLOBALS['logo2_letter_X'], $this->GetY()+$GLOBALS['logo2_letter_Y'], $GLOBALS['logo2_letter']),0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(45,5,"",0,0,'C');
    $this->Cell(170,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(45,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LETTER #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['status']) == 1){ 
    $this->Cell(260,7,'LISTADO DE CRÉDITOS GENERALES POR CLIENTE',0,0,'C');
    } elseif(decrypt($_GET['status']) == 2){ 
    $this->Cell(260,7,'LISTADO DE CRÉDITOS PAGADOS POR CLIENTE',0,0,'C');
    } elseif(decrypt($_GET['status']) == 3){ 
    $this->Cell(260,7,'LISTADO DE CRÉDITOS PENDIENTES POR CLIENTE',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(260,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(260,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(260,5,"Nº DE ".utf8_decode($documento = ($reg[0]['documcliente'] == '0' ? "DOCUMENTO" : $reg[0]['documento3']).": ".$reg[0]["dnicliente"]),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"CLIENTE: ".utf8_decode($reg[0]['nomcliente']),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"Nº DE TELEFONO: ".utf8_decode($reg[0]['tlfcliente'] == "" ? "********" : $reg[0]['tlfcliente']),0,0,'L');
    $this->Ln();
    $this->Cell(260,5,"DIRECCIÓN DOMICILIARIA: ".utf8_decode($reg[0]['direccliente'] == "" ? "********" : $reg[0]['direccliente']),0,1,'L');
    
    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(35,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(25,8,'ESTADO',1,0,'C', True);
    $this->Cell(40,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(40,8,'FECHA VENCIMIENTO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,35,25,40,40,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),
        utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
    	utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),
        utf8_decode(date("d-m-Y",strtotime($reg[$i]['fechavencecredito']))),
        utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(155,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(140,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(130,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR CREDITOS POR CLIENTES #########################

######################## FUNCION LISTAR DETALLES CREDITOS POR CLIENTES #########################
function TablaListarDetallesCreditosxClientes()
{
    $tra = new Login();
    $reg = $tra->BuscarDetallesCreditosxClientes();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',12);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    if(decrypt($_GET['status']) == 1){ 
    $this->Cell(335,7,'LISTADO DE DETALLES CRÉDITOS GENERALES POR CLIENTE',0,0,'C');
    } elseif(decrypt($_GET['status']) == 2){ 
    $this->Cell(335,7,'LISTADO DE DETALLES CRÉDITOS PAGADOS POR CLIENTE',0,0,'C');
    } elseif(decrypt($_GET['status']) == 3){ 
    $this->Cell(335,7,'LISTADO DE DETALLES CRÉDITOS PENDIENTES POR CLIENTE',0,0,'C');
    }

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"Nº DE ".utf8_decode($documento = ($reg[0]['documcliente'] == '0' ? "DOCUMENTO" : $reg[0]['documento3']).": ".$reg[0]["dnicliente"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"CLIENTE: ".utf8_decode($reg[0]['nomcliente']),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"Nº DE TELEFONO: ".utf8_decode($reg[0]['tlfcliente'] == "" ? "********" : $reg[0]['tlfcliente']),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DIRECCIÓN DOMICILIARIA: ".utf8_decode($reg[0]['direccliente'] == "" ? "********" : $reg[0]['direccliente']),0,1,'L');
    
    $this->Ln();
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(15,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº DE VENTA',1,0,'C', True);
    $this->Cell(40,8,'ESTADO',1,0,'C', True);
    $this->Cell(40,8,'FECHA EMISIÓN',1,0,'C', True);
    $this->Cell(105,8,'DETALLES DE PRODUCTOS',1,0,'C', True);
    $this->Cell(35,8,'TOTAL IMPORTE',1,0,'C', True);
    $this->Cell(35,8,'TOTAL ABONO',1,0,'C', True);
    $this->Cell(35,8,'TOTAL DEBE',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(15,30,40,40,105,35,35,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalImporte=0;
    $TotalAbono=0;
    $TotalDebe=0;

    for($i=0;$i<sizeof($reg);$i++){ 
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    $detalles = str_replace("<br>","\n", $reg[$i]['detalles_productos']);
    
    $TotalImporte+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"];
    $TotalAbono+=$reg[$i]['creditopagado'];
    $TotalDebe+=$reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'];

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["tipodocumento"].": ".$reg[$i]["codfactura"]),utf8_decode($reg[$i]['fechavencecredito'] < date("Y-m-d") && $reg[$i]['fechapagado'] == "0000-00-00" && $reg[$i]['statusventa'] == "PENDIENTE" ? "VENCIDA" : $reg[$i]["statusventa"]),
        utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechaventa']))),portales(utf8_decode($detalles)),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['creditopagado'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago']+$reg[$i]["totalpropina"]+$reg[$i]["montodelivery"]-$reg[$i]['creditopagado'], 0, '.', '.'))));
        }
    }
   
    $this->Cell(230,5,'',0,0,'C');
    $this->SetFont('Courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalAbono, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalDebe, 0, '.', '.')),0,0,'L');
    $this->Ln();
    

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
######################## FUNCION LISTAR DETALLES CREDITOS POR CLIENTES #########################

############################### REPORTES DE CREDITOS ###############################










































############################## REPORTES DE NOTAS DE CREDITOS ##################################

########################## FUNCION NOTA CREDITO (80mm) ##############################
function NotaCredito()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);

    $tra = new Login();
    $reg = $tra->NotasCreditoPorId();
    $timbrePath = Lioren::getTimbre($reg[0]);
    $simbolo = ($reg[0]['simbolo'] == "" ? "" : $reg[0]['simbolo']);
    $TipoLetra = "Courier";
   
    if (file_exists("fotos/sucursales/".$reg[0]['cuitsucursal'].".png")) {

    $logo = "fotos/sucursales/".$reg[0]['cuitsucursal'].".png";
    $this->Image($logo , 14, 4, 50, 12, "PNG");
    $this->Ln(6);

    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5, "NOTA DE CRÉDITO", 0, 0, 'C');
    $this->Ln(5);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,portales(utf8_decode($reg[0]['nomsucursal'])), 0, 1, 'C');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$reg[0]['documsucursal'] == '0' ? "" : "Nº ".$reg[0]['documento']." ".utf8_decode($reg[0]['cuitsucursal']),0,1,'C');

    if($reg[0]['id_ciudad']!='0'){

    $this->SetX(2);
    $this->CellFitSpace(70,3,utf8_decode($ciudad = ($reg[0]['id_ciudad'] == '0' ? "" : $reg[0]['ciudad'])." ".$comuna = ($reg[0]['id_comuna'] == '0' ? "" : $reg[0]['comuna'])),0,1,'C');
    
    }

    $this->SetX(2);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['direcsucursal'])),0,1,'C');

    if($reg[0]['codgiro'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,"N° GIRO: ".utf8_decode($reg[0]['codgiro']),0,1,'C');
    }
    
    if($reg[0]['girosucursal'] != "0"){
    $this->SetX(4);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['girosucursal']),0,1,'C');
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    if($reg[0]['nomcliente']==""){

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(70,4,utf8_decode("A CONSUMIDOR FINAL"), 0, 1, 'J');

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,$documento = ($reg[0]['documcliente'] == '0' ? "Nº DOC:" : "Nº ".$reg[0]['documento3'].": ".$reg[0]['dnicliente']),0,1,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode($reg[0]['nomcliente'])),0,'L');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->MultiCell(70,3,$this->SetFont($TipoLetra,'B',9).portales(utf8_decode(getSubString($reg[0]['direccliente'],55))),0,'L');

    if($reg[0]['tlfcliente'] != ""){
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(70,3,utf8_decode($reg[0]['tlfcliente'] == "" ? "**********" : $reg[0]['tlfcliente']),0,1,'L');
    }
   
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(35,3,"Nro NOTA:  ", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(35,3,utf8_decode($reg[0]['codfactura']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(35,3,"Nro ". $tipodocumento = ($reg[0]['tipodocumento'] == "FACTURA_A4" ? "FACTURA" : $reg[0]['tipodocumento']).": ", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(35,3,utf8_decode($reg[0]['facturaventa']), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(18,3,"CAJERO:", 0, 0, 'J');
    $this->SetFont($TipoLetra,'B',9);
    $this->CellFitSpace(52,3,portales(utf8_decode($reg[0]['nombres'])), 0, 1, 'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(35,3,"FECHA: ".utf8_decode(date("d/m/Y",strtotime($reg[0]['fechanota']))), 0, 0, 'J');
    $this->CellFitSpace(35,3,"HORA: ".utf8_decode(date("H:i:s",strtotime($reg[0]['fechanota']))), 0, 0, 'R');
    $this->Ln();

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);



    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->SetFillColor(2,157,116);
    $this->Cell(70, 5,"DETALLES DE PRODUCTOS", 0, 0, 'L');
    $this->Ln(5);

    $tra = new Login();
    $detalle = $tra->VerDetallesNotasCredito();
    $cantidad = 0;
    $SubTotal = 0;
    $montoExento = 0;
    $valorIva    = $reg[0]["iva"] / 100;
    $Articulos = 0;
    $a=1;
    for($i=0;$i<sizeof($detalle);$i++):
    $SubTotal += $detalle[$i]['valortotal'];
    $Articulos += $detalle[$i]['cantventa'];

    $this->SetX(2);
    $this->SetFillColor(192);
    $this->SetDrawColor(3,3,3);
    $this->SetLineWidth(.2);
    $this->SetFont($TipoLetra,'',8);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    
    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,utf8_decode(number_format($detalle[$i]['cantventa'], 2, '.', ','))." X ".$simbolo.number_format($detalle[$i]["precioventa"], 0, '.', ','),0,0,'J');

    $this->SetFont($TipoLetra,'B',8);
    $this->CellFitSpace(35,3,$simbolo.number_format($detalle[$i]["valorneto"], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',8);
    $this->CellFitSpace(70,3,portales(utf8_decode(getSubString($detalle[$i]["producto"], 55))),0,1,'J');

    endfor;

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,3,'---------------------------',0,0,'C');
    $this->Ln(3);

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(22,3,"SUBTOTAL",0,0,'L');
    $this->Cell(48,3,$simbolo.number_format($reg[0]["subtotalivasi"]+$reg[0]["subtotalivano"], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(22,3,$impuesto == '' ? "IMPUESTO" : $impuesto." (".number_format($reg[0]["iva"], 0, '.', '.')."%):",0,0,'L');
    $this->Cell(48,3,$simbolo.number_format($reg[0]["totaliva"], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'',9);
    $this->CellFitSpace(22,3,"DESC (".number_format($reg[0]["descuento"], 0, '.', ',')."%)",0,0,'L');
    $this->Cell(48,3,$simbolo.number_format($reg[0]['totaldescuento'], 0, '.', ','),0,1,'R');

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',10);
    $this->CellFitSpace(22,3,"TOTAL",0,0,'L');
    $this->Cell(48,3,$simbolo.number_format($reg[0]['totalpago'], 0, '.', ','),0,1,'R');

    if($reg[0]['observaciones']!=""){
    ########################### OBSERVACIONES #############################
    $this->Ln(2);  
    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',8);
    $this->MultiCell(70,4,utf8_decode($reg[0]['observaciones']),0,1,'');
    $this->Ln(2);
    ########################### OBSERVACIONES #############################    
    }

    $this->SetX(2);
    $this->SetFont($TipoLetra,'B',12);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->SetX(2);
    $this->Cell(70,0.5,'---------------------------',0,1,'C');
    $this->Ln(2);

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(30,3,"CANTIDAD TOTAL:",0,0,'L');
    $this->CellFitSpace(40,3,utf8_decode(number_format($Articulos, 2, '.', ',')),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(70,3,portales(utf8_decode($reg[0]['correosucursal'])),0,1,'L');

    $this->SetX(2);
    $this->SetFont('Courier','',9);
    $this->CellFitSpace(10,3,"TEL:",0,0,'L');
    $this->CellFitSpace(60,3,utf8_decode($reg[0]['tlfsucursal']),0,1,'L');
    $this->Ln(3); 

    if ($timbrePath) {

    $this->SetX(2);
    $this->Cell(70, 25, $this->Image($timbrePath, $this->GetX(), $this->GetY(), 70, 25), 0, 1);
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 6, "TIMBRE ELECTRONICO S.I.I", 0, 1, 'C');
    $this->SetX(4);
    $this->SetFont($TipoLetra, 'B', 7);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(66, 3, "Verifique el Documento en: www.sii.cl", 0, 1, 'C');
    $this->Ln(2);

    } else {

    $this->SetX(2);
    $this->SetFont($TipoLetra,'BI',10);
    $this->SetFillColor(3, 3, 3);
    $this->CellFitSpace(70,3,"GRACIAS POR SU COMPRA",0,1,'C');
    $this->Ln(3);
    
    }  
}  
########################## FUNCION NOTA CREDITO (80mm) ##############################     

########################## FUNCION LISTAR NOTAS DE CREDITO ##############################
function TablaListarNotas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->ListarNotasCreditos();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO GENERAL DE NOTAS DE CRÉDITOS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && !empty($reg)){

    $this->Ln();
    $this->Cell(335,6,"Nº DE SUCURSAL: ".$reg[0]["cuitsucursal"],0,0,'L');
    $this->Ln();
    $this->Cell(335,6,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,6,"ENCARGADO SUCURSAL: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln(10);
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº CAJA',1,0,'C', True);
    $this->Cell(25,8,'Nº NOTA',1,0,'C', True);
    $this->Cell(40,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(45,8,'CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'OBSERVACIÓN',1,0,'C', True);
    $this->Cell(25,8,'FECHA',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,30,25,40,45,30,25,35,30,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($caja = ($reg[$i]['codcaja'] == '0' ? "**********" : $reg[$i]["nrocaja"].": ".$reg[$i]['nomcaja'])),utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['tipodocumento'].": ".$reg[$i]["facturaventa"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]["observaciones"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechanota']))),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
   }
   
    $this->Cell(205,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR NOTAS DE CREDITO ##############################

########################## FUNCION LISTAR NOTAS DE CREDITO X CAJAS ##############################
function TablaListarNotasxCajas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarNotasxCajas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE NOTAS DE CRÉDITOS POR CAJAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"Nº CAJA: ".utf8_decode($reg[0]["nrocaja"].": ".$reg[0]["nomcaja"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"RESPONSABLE DE CAJA: ".portales(utf8_decode($reg[0]["nombres"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(25,8,'Nº NOTA',1,0,'C', True);
    $this->Cell(40,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(50,8,'CLIENTE',1,0,'C', True);
    $this->Cell(50,8,'OBSERVACIÓN',1,0,'C', True);
    $this->Cell(30,8,'FECHA',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,25,40,50,50,30,35,30,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['tipodocumento'].": ".$reg[$i]["facturaventa"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]["observaciones"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechanota']))),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(205,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR NOTAS DE CREDITO X CAJAS ##############################

########################## FUNCION LISTAR NOTAS DE CREDITO X FECHAS ##############################
function TablaListarNotasxFechas()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarNotasxFechas();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE NOTAS DE CRÉDITOS POR FECHAS',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"DESDE: ".date("d-m-Y", strtotime($_GET["desde"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"HASTA: ".date("d-m-Y", strtotime($_GET["hasta"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº CAJA',1,0,'C', True);
    $this->Cell(25,8,'Nº NOTA',1,0,'C', True);
    $this->Cell(40,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(45,8,'CLIENTE',1,0,'C', True);
    $this->Cell(30,8,'OBSERVACIÓN',1,0,'C', True);
    $this->Cell(25,8,'FECHA',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(30,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,30,25,40,45,30,25,35,30,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($caja = ($reg[$i]['codcaja'] == '0' ? "**********" : $reg[$i]["nrocaja"].": ".$reg[$i]['nomcaja'])),utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['tipodocumento'].": ".$reg[$i]["facturaventa"]),utf8_decode($reg[$i]['codcliente'] == '0' ? "CONSUMIDOR FINAL" : $reg[$i]['nomcliente']),utf8_decode($reg[$i]["observaciones"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechanota']))),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
   }
   
    $this->Cell(205,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(30,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR NOTAS DE CREDITO X FECHAS ##############################

########################## FUNCION LISTAR NOTAS DE CREDITO X CLIENTES ##############################
function TablaListarNotasxClientes()
{
    $imp = new Login();
    $imp = $imp->ImpuestosPorId();
    $impuesto = ($imp == "" ? "IMPUESTO" : $imp[0]['nomimpuesto']);
    $valor = ($imp == "" ? "0" : $imp[0]['valorimpuesto']);
    
    $tra = new Login();
    $reg = $tra->BuscarNotasxClientes();

    ################################# MEMBRETE LEGAL #################################
    if($_SESSION['acceso'] == "administradorG"){

    $logo = ( file_exists("fotos/logo_principal.png") == "" ? "assets/images/null.png" : "fotos/logo_principal.png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");
    
    $con = new Login();
    $con = $con->ConfiguracionPorId(); 

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['documsucursal'] == '0' ? "" : $con[0]['documento'])." ".utf8_decode($con[0]['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($con[0]['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($con[0]['id_ciudad'] == '0' ? "" : $con[0]['ciudad'])." ".$comuna = ($con[0]['id_comuna'] == '0' ? "" : $con[0]['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($con[0]['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($con[0]['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    } else {

    $logo = ( file_exists("fotos/sucursales/".$_SESSION['cuitsucursal'].".png") == "" ? "assets/images/null.png" : "fotos/sucursales/".$_SESSION['cuitsucursal'].".png");
    $logo2 = ( file_exists("fotos/logo_pdf.png") == "" ? "assets/images/null.png" : "fotos/logo_pdf.png");

    $this->Ln(2);
    $this->SetFont('Courier','B',12);
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->SetFillColor(5, 130, 275); // establece el color del fondo de la celda (en este caso es NARANJA
    $this->Cell(90,5,$this->Image($logo, $this->GetX()+$GLOBALS['logo1_horizontal_X'], $this->GetY()+$GLOBALS['logo1_horizontal_Y'], $GLOBALS['logo1_horizontal']),0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['nomsucursal']),0,0,'C');
    $this->Cell(90,5,$this->Image($logo2, $this->GetX()+$GLOBALS['logo2_horizontal_X'], $this->GetY()+$GLOBALS['logo2_horizontal_Y'], $GLOBALS['logo2_horizontal']),0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['documsucursal'] == '0' ? "" : $_SESSION['documento'])." ".utf8_decode($_SESSION['cuitsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    if($_SESSION['id_ciudad']!='0'){

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($ciudad = ($_SESSION['id_ciudad'] == '0' ? "" : $_SESSION['ciudad'])." ".$comuna = ($_SESSION['id_comuna'] == '0' ? "" : $_SESSION['comuna'])),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    }

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['direcsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,"Nº DE TLF: ".utf8_decode($_SESSION['tlfsucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');

    $this->Ln();
    $this->Cell(90,5,"",0,0,'C');
    $this->Cell(155,5,utf8_decode($_SESSION['correosucursal']),0,0,'C');
    $this->Cell(90,5,"",0,0,'C');
    $this->Ln(8);

    }
    ################################# MEMBRETE LEGAL #################################

    $this->SetFont('Courier','B',14);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Cell(335,10,'LISTADO DE NOTAS DE CRÉDITOS POR CLIENTE',0,0,'C');

    if($_SESSION['acceso'] == "administradorG" && $reg != ""){

    $this->Ln();
    $this->Cell(335,5,"Nº ".utf8_decode($reg[0]['documento'])." SUCURSAL: ".utf8_decode($reg[0]["cuitsucursal"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"SUCURSAL: ".portales(utf8_decode($reg[0]["nomsucursal"])),0,0,'L'); 
    $this->Ln();
    $this->Cell(335,5,"ENCARGADO: ".portales(utf8_decode($reg[0]["nomencargado"])),0,0,'L'); 

    }

    $this->Ln();
    $this->Cell(335,5,"Nº DE ".utf8_decode($documento = ($reg[0]['documcliente'] == '0' ? "DOCUMENTO" : $reg[0]['documento3']).": ".$reg[0]["dnicliente"]),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"NOMBRE DE CLIENTE: ".portales(utf8_decode($reg[0]["nomcliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"Nº DE TELÉFONO: ".portales(utf8_decode($reg[0]["tlfcliente"] == "" ? "********" : $reg[0]["tlfcliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"ciudad: ".portales(utf8_decode($reg[0]["id_ciudad"] == "0" ? "********" : $reg[0]["ciudad2"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"comuna: ".portales(utf8_decode($reg[0]["id_comuna"] == "0" ? "********" : $reg[0]["comuna2"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"DIRECCIÓN: ".portales(utf8_decode($reg[0]["direccliente"] == "" ? "********" : $reg[0]["direccliente"])),0,0,'L');
    $this->Ln();
    $this->Cell(335,5,"CORREO ELECTRONICO: ".portales(utf8_decode($reg[0]["emailcliente"] == "" ? "********" : $reg[0]["emailcliente"])),0,1,'L');

    $this->Ln();
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255, 255, 255);  // Establece el color del texto (en este caso es BLANCO)
    $this->SetFillColor(230, 126, 34); // establece el color del fondo de la celda (en este caso es NARANJA)
    $this->Cell(10,8,'Nº',1,0,'C', True);
    $this->Cell(30,8,'Nº CAJA',1,0,'C', True);
    $this->Cell(30,8,'Nº NOTA',1,0,'C', True);
    $this->Cell(35,8,'DOCUMENTO',1,0,'C', True);
    $this->Cell(50,8,'OBSERVACIÓN',1,0,'C', True);
    $this->Cell(45,8,'FECHA',1,0,'C', True);
    $this->Cell(35,8,'SUBTOTAL',1,0,'C', True);
    $this->Cell(35,8,$impuesto,1,0,'C', True);
    $this->Cell(25,8,'DESC %',1,0,'C', True);
    $this->Cell(35,8,'TOTAL',1,1,'C', True);

    if($reg==""){
    echo "";      
    } else {
 
     /* AQUI DECLARO LAS COLUMNAS */
    $this->SetWidths(array(10,30,30,35,50,45,35,35,25,35));

    /* AQUI AGREGO LOS VALORES A MOSTRAR EN COLUMNAS */
    $a=1;
    $TotalArticulos=0;
    $TotalSubtotal=0;
    $TotalIva=0;
    $TotalDescuento=0;
    $TotalImporte=0;

    for($i=0;$i<sizeof($reg);$i++){
    $simbolo = ($reg[$i]['simbolo'] == "" ? "" : $reg[$i]['simbolo']);
    
    $TotalArticulos+=$reg[$i]['articulos'];
    $TotalSubtotal+=$reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'];
    $TotalIva+=$reg[$i]['totaliva'];
    $TotalDescuento+=$reg[$i]['totaldescuento'];
    $TotalImporte+=$reg[$i]['totalpago']; 

    $this->SetFont('Courier','',10);  
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es negro)
    $this->Row(array($a++,utf8_decode($caja = ($reg[$i]['codcaja'] == '0' ? "**********" : $reg[$i]["nrocaja"].": ".$reg[$i]['nomcaja'])),utf8_decode($reg[$i]["codfactura"]),utf8_decode($reg[$i]['tipodocumento'].": ".$reg[$i]["facturaventa"]),utf8_decode($reg[$i]["observaciones"]),utf8_decode(date("d-m-Y H:i:s",strtotime($reg[$i]['fechanota']))),utf8_decode($simbolo.number_format($reg[$i]['subtotalivasi']+$reg[$i]['subtotalivano'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaliva'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totaldescuento'], 0, '.', '.')),utf8_decode($simbolo.number_format($reg[$i]['totalpago'], 0, '.', '.'))));
    }
   
    $this->Cell(200,5,'',0,0,'C');
    $this->SetFont('courier','B',10);
    $this->SetTextColor(255,255,255);  // Establece el color del texto (en este caso es blanco)
    $this->SetTextColor(3,3,3);  // Establece el color del texto (en este caso es blanco)
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalSubtotal, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalIva, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(25,5,utf8_decode($simbolo.number_format($TotalDescuento, 0, '.', '.')),0,0,'L');
    $this->CellFitSpace(35,5,utf8_decode($simbolo.number_format($TotalImporte, 0, '.', '.')),0,0,'L');
    $this->Ln();
    
    }

    $this->Ln(12); 
    $this->SetFont('Courier','B',10);
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'ELABORADO: '.utf8_decode($_SESSION["nombres"]),0,0,'');
    $this->Cell(125,6,'RECIBIDO:_____________________________________',0,0,'');
    $this->Ln();
    $this->Cell(5,6,'',0,0,'');
    $this->Cell(200,6,'FECHA/HORA: '.date('d-m-Y H:i:s'),0,0,'');
    $this->Cell(125,6,'',0,0,'');
    $this->Ln(4);
}
########################## FUNCION LISTAR NOTAS DE CREDITO X CLIENTES ##############################

############################## REPORTES DE NOTAS DE CREDITOS ##################################

 // FIN Class PDF
}
?>